<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japanese Electronics Industry Simulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4A49B7',
                    }
                }
            }
        }
    </script>
    <style>
        .chart-container {
            position: relative;
            height: 200px;
            width: 100%;
        }
        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 25px;
            transition: height 0.5s ease;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
        }
        /* Dark mode styles */
        .dark .chart-line {
            stroke: rgba(255, 255, 255, 0.7);
        }
        .dark .chart-axis {
            stroke: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-5xl">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center mb-2">Japanese Electronics Industry Simulation</h1>
            <p class="text-center text-gray-600 dark:text-gray-400">Navigate the challenges of a changing electronics market (2000-2020)</p>
        </header>

        <div id="intro-screen" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4">Welcome to the Simulation</h2>
            <p class="mb-4">You are the CEO of Nippon Electronics, once a dominant force in the global electronics market. It's the year 2000, and your company faces increasing competition from South Korean and American firms.</p>
            <p class="mb-4">Your challenge: Guide Nippon Electronics through 20 years of strategic decisions. Will you focus on traditional product lines or pivot to innovation? How will you allocate resources?</p>
            <p class="mb-4">Your decisions will affect your company's market share, revenue, profit, and innovation index.</p>
            <div class="mt-6 text-center">
                <button id="start-button" class="bg-primary hover:bg-primary-dark text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 transition">
                    Start Simulation
                </button>
            </div>
        </div>

        <div id="simulation-screen" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <!-- Dashboard -->
                <div class="col-span-1 lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <div class="flex flex-wrap justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Nippon Electronics Dashboard</h2>
                        <div class="flex items-center">
                            <span class="mr-2">Year:</span>
                            <span id="year-display" class="font-bold">2000</span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Market Share</h3>
                            <p id="market-share" class="text-2xl font-bold">25%</p>
                        </div>
                        <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Annual Revenue</h3>
                            <p id="revenue" class="text-2xl font-bold">$50B</p>
                        </div>
                        <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Annual Profit</h3>
                            <p id="profit" class="text-2xl font-bold">$5.2B</p>
                        </div>
                        <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Innovation Index</h3>
                            <p id="innovation" class="text-2xl font-bold">72</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-3">Performance Over Time</h3>
                        <div class="chart-container border border-gray-200 dark:border-gray-700 rounded p-2 relative">
                            <svg id="line-chart" width="100%" height="100%" viewBox="0 0 600 200" preserveAspectRatio="none">
                                <!-- Chart lines will be drawn by JavaScript -->
                                <line x1="0" y1="170" x2="600" y2="170" stroke="#CBD5E0" stroke-width="1" class="chart-axis"></line>
                                
                                <!-- Y-axis labels -->
                                <text x="5" y="20" class="text-xs fill-current text-gray-500 dark:text-gray-400">High</text>
                                <text x="5" y="170" class="text-xs fill-current text-gray-500 dark:text-gray-400">Low</text>
                                
                                <!-- Market share line (red) -->
                                <polyline id="market-share-line" 
                                    points="0,50" 
                                    fill="none" 
                                    stroke="#FC8181" 
                                    stroke-width="2"
                                    class="chart-line"></polyline>
                                
                                <!-- Profit line (green) -->
                                <polyline id="profit-line" 
                                    points="0,50" 
                                    fill="none" 
                                    stroke="#68D391" 
                                    stroke-width="2"
                                    class="chart-line"></polyline>
                                
                                <!-- Innovation line (blue) -->
                                <polyline id="innovation-line" 
                                    points="0,50" 
                                    fill="none" 
                                    stroke="#63B3ED" 
                                    stroke-width="2"
                                    class="chart-line"></polyline>
                            </svg>
                            
                            <div class="flex justify-center mt-2">
                                <div class="flex items-center mr-4">
                                    <div class="w-3 h-3 bg-red-300 rounded-full mr-1"></div>
                                    <span class="text-xs">Market Share</span>
                                </div>
                                <div class="flex items-center mr-4">
                                    <div class="w-3 h-3 bg-green-300 rounded-full mr-1"></div>
                                    <span class="text-xs">Profit</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-blue-300 rounded-full mr-1"></div>
                                    <span class="text-xs">Innovation</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold mb-3">Market Comparison</h3>
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Nippon</p>
                                <div class="chart-container h-32">
                                    <div id="nippon-bar" class="chart-bar mx-auto bg-primary" style="height: 50%;"></div>
                                </div>
                                <p id="nippon-profit" class="text-sm font-semibold">$5.2B</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Samsung</p>
                                <div class="chart-container h-32">
                                    <div id="samsung-bar" class="chart-bar mx-auto bg-purple-500" style="height: 60%;"></div>
                                </div>
                                <p id="samsung-profit" class="text-sm font-semibold">$6.5B</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Apple</p>
                                <div class="chart-container h-32">
                                    <div id="apple-bar" class="chart-bar mx-auto bg-gray-500" style="height: 70%;"></div>
                                </div>
                                <p id="apple-profit" class="text-sm font-semibold">$8.0B</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Decision Panel -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold mb-4">Strategic Decisions</h2>
                    
                    <div id="decision-content">
                        <div id="scenario" class="mb-6">
                            <p class="mb-4">It's the year 2000. Your traditional product lines (TVs, DVD players, stereo equipment) remain profitable but are facing increasing price competition from South Korean manufacturers. New digital technologies are emerging. How will you allocate your R&D resources?</p>
                        </div>
                        
                        <form id="decision-form" class="mb-6">
                            <div class="mb-6">
                                <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">R&D Investment Priority</label>
                                <select id="investment-priority" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg text-base">
                                    <option value="traditional">Focus on Traditional Products (80% traditional, 20% new tech)</option>
                                    <option value="balanced">Balanced Approach (50% traditional, 50% new tech)</option>
                                    <option value="innovative">Focus on Innovation (20% traditional, 80% new tech)</option>
                                </select>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Manufacturing Strategy</label>
                                <select id="manufacturing-strategy" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg text-base">
                                    <option value="inhouse">Keep Manufacturing In-House for Quality Control</option>
                                    <option value="outsource">Outsource Manufacturing to Reduce Costs</option>
                                </select>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Market Expansion</label>
                                <select id="market-expansion" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg text-base">
                                    <option value="domestic">Focus on Domestic Market</option>
                                    <option value="global">Aggressive Global Expansion</option>
                                </select>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Product Line Decision</label>
                                <select id="product-line" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg text-base">
                                    <option value="maintain">Maintain All Current Product Lines</option>
                                    <option value="exit">Exit Unprofitable Segments</option>
                                </select>
                            </div>
                        </form>
                        
                        <div class="text-center">
                            <button id="make-decision" class="bg-primary hover:bg-primary-dark text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 transition">
                                Make Decision
                            </button>
                        </div>
                    </div>
                    
                    <div id="results-content" class="hidden">
                        <div id="year-results" class="mb-6">
                            <!-- Results will be populated by JavaScript -->
                        </div>
                        
                        <div id="competitor-news" class="mb-6">
                            <!-- Competitor news will be populated by JavaScript -->
                        </div>
                        
                        <div class="text-center">
                            <button id="continue-button" class="bg-primary hover:bg-primary-dark text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 transition">
                                Continue to Next Year
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="news-feed" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-bold mb-4">Industry News</h2>
                <div id="news-content" class="border-l-4 border-primary pl-4">
                    <p class="mb-2"><strong>2000:</strong> DVD players become mainstream, replacing VCRs in many households.</p>
                    <p class="mb-2"><strong>2000:</strong> Mobile phones continue to gain popularity, with Nokia leading the market.</p>
                    <p class="mb-2"><strong>2000:</strong> Digital cameras begin to challenge film cameras in the consumer market.</p>
                </div>
            </div>
        </div>
        
        <div id="end-screen" class="hidden bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4 text-center">Simulation Complete</h2>
            <div id="final-results" class="mb-6">
                <!-- Final results will be populated by JavaScript -->
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold mb-3">Your Company's Journey</h3>
                    <div id="company-journey">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold mb-3">Key Lessons</h3>
                    <ul class="list-disc pl-5 space-y-2">
                        <li>Innovation and adaptation are crucial in fast-evolving tech markets</li>
                        <li>Exiting commodity product segments can free resources for innovation</li>
                        <li>Strong brands must be backed by continuous product improvement</li>
                        <li>Competitors' success provides valuable insights for strategic direction</li>
                    </ul>
                </div>
            </div>
            <div class="text-center">
                <button id="restart-button" class="bg-primary hover:bg-primary-dark text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 transition">
                    Restart Simulation
                </button>
            </div>
        </div>
    </div>

    <script>
        // Check for dark mode preference
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
        
        // Simulation state
        let state = {
            year: 2000,
            marketShare: 25,
            revenue: 50,  // In billions
            profit: 5.2,  // In billions
            innovation: 72,
            competitors: {
                samsung: { profit: 6.5 },
                apple: { profit: 8.0 }
            },
            history: {
                marketShare: [25],
                profit: [5.2],
                innovation: [72]
            },
            decisions: []
        };
        
        // Scenarios for different years
        const scenarios = [
            {
                year: 2000,
                text: "It's the year 2000. Your traditional product lines (TVs, DVD players, stereo equipment) remain profitable but are facing increasing price competition from South Korean manufacturers. New digital technologies are emerging. How will you allocate your R&D resources?"
            },
            {
                year: 2003,
                text: "Digital music players like Apple's iPod are gaining massive popularity. Your traditional audio equipment sales are declining. Do you enter this new market or focus on your existing strengths?"
            },
            {
                year: 2006,
                text: "Smartphones are beginning to emerge. Your feature phone division is profitable but declining. LCD and plasma TV prices are dropping rapidly, squeezing margins."
            },
            {
                year: 2009,
                text: "The global financial crisis has impacted consumer spending. Tablets are gaining popularity following Apple's iPad launch. Your TV division is now losing money despite high quality products."
            },
            {
                year: 2012,
                text: "Smart TVs are emerging. Korean manufacturers are dominating the TV market with lower prices. Your smartphone efforts have gained little traction against Apple and Samsung."
            },
            {
                year: 2015,
                text: "IoT (Internet of Things) and smart home devices are emerging as new growth areas. Your traditional consumer electronics continue to face margin pressure."
            },
            {
                year: 2018,
                text: "AI and voice assistants are becoming mainstream. 5G is on the horizon. Competition in all traditional electronics segments is fierce."
            }
        ];
        
        // News events for different years
        const newsEvents = {
            2000: [
                "DVD players become mainstream, replacing VCRs in many households.",
                "Mobile phones continue to gain popularity, with Nokia leading the market.",
                "Digital cameras begin to challenge film cameras in the consumer market."
            ],
            2003: [
                "Apple's iPod revolutionizes the music industry.",
                "LCD TVs begin to replace CRT models in high-end markets.",
                "Camera phones emerge, threatening the digital camera market."
            ],
            2006: [
                "Blu-ray and HD-DVD compete for next-generation optical disc standard.",
                "Flat panel TVs become the norm as prices continue to drop.",
                "Smartphones begin to appear with advanced features."
            ],
            2009: [
                "Global financial crisis impacts consumer electronics spending.",
                "Apple launches the iPad, creating the modern tablet market.",
                "Streaming services start to challenge traditional media consumption."
            ],
            2012: [
                "Smart TVs with internet connectivity gain popularity.",
                "Samsung becomes the world's largest smartphone manufacturer.",
                "Japanese electronics giants report record losses."
            ],
            2015: [
                "4K TVs become mainstream as prices drop dramatically.",
                "Smart home devices and IoT products enter the consumer market.",
                "Chinese manufacturers gain significant market share in TVs and smartphones."
            ],
            2018: [
                "AI and voice assistants become common in consumer electronics.",
                "5G technology is poised for rollout, promising new opportunities.",
                "Japanese electronics firms focus on B2B markets as consumer sales decline."
            ],
            2020: [
                "COVID-19 pandemic disrupts global supply chains.",
                "Work-from-home trend drives demand for certain electronics.",
                "Gaming and entertainment electronics see strong growth during lockdowns."
            ]
        };
        
        // Competitor news based on year
        const competitorNews = {
            2003: "Apple's iPod has captured 70% of the digital music player market.",
            2006: "Samsung has overtaken Japanese firms in global TV market share.",
            2009: "Apple launches the iPhone 3GS, solidifying its smartphone dominance.",
            2012: "Samsung reports record profits of $12 billion, while Sony reports a $6.4 billion loss.",
            2015: "Apple's market capitalization reaches $725 billion, becoming the world's most valuable company.",
            2018: "Samsung and Apple together capture 90% of global smartphone profits.",
            2020: "Apple becomes the first US company to reach a $2 trillion market capitalization."
        };
        
        // DOM elements
        const introScreen = document.getElementById('intro-screen');
        const simulationScreen = document.getElementById('simulation-screen');
        const endScreen = document.getElementById('end-screen');
        const startButton = document.getElementById('start-button');
        const decisionContent = document.getElementById('decision-content');
        const resultsContent = document.getElementById('results-content');
        const makeDecisionButton = document.getElementById('make-decision');
        const continueButton = document.getElementById('continue-button');
        const restartButton = document.getElementById('restart-button');
        const yearDisplay = document.getElementById('year-display');
        const marketShareDisplay = document.getElementById('market-share');
        const revenueDisplay = document.getElementById('revenue');
        const profitDisplay = document.getElementById('profit');
        const innovationDisplay = document.getElementById('innovation');
        const scenarioElement = document.getElementById('scenario');
        const yearResultsElement = document.getElementById('year-results');
        const competitorNewsElement = document.getElementById('competitor-news');
        const newsContentElement = document.getElementById('news-content');
        const finalResultsElement = document.getElementById('final-results');
        const companyJourneyElement = document.getElementById('company-journey');
        
        // Chart elements
        const marketShareLine = document.getElementById('market-share-line');
        const profitLine = document.getElementById('profit-line');
        const innovationLine = document.getElementById('innovation-line');
        const nipponBar = document.getElementById('nippon-bar');
        const samsungBar = document.getElementById('samsung-bar');
        const appleBar = document.getElementById('apple-bar');
        const nipponProfitDisplay = document.getElementById('nippon-profit');
        const samsungProfitDisplay = document.getElementById('samsung-profit');
        const appleProfitDisplay = document.getElementById('apple-profit');
        
        // Form elements
        const investmentPriority = document.getElementById('investment-priority');
        const manufacturingStrategy = document.getElementById('manufacturing-strategy');
        const marketExpansion = document.getElementById('market-expansion');
        const productLine = document.getElementById('product-line');
        
        // Event listeners
        startButton.addEventListener('click', startSimulation);
        makeDecisionButton.addEventListener('click', processDecision);
        continueButton.addEventListener('click', continueToNextYear);
        restartButton.addEventListener('click', restartSimulation);
        
        // Start the simulation
        function startSimulation() {
            introScreen.classList.add('hidden');
            simulationScreen.classList.remove('hidden');
            updateDisplay();
        }
        
        // Process the user's decision
        function processDecision() {
            // Capture the user's decisions
            const decisions = {
                investmentPriority: investmentPriority.value,
                manufacturingStrategy: manufacturingStrategy.value,
                marketExpansion: marketExpansion.value,
                productLine: productLine.value,
                year: state.year
            };
            
            state.decisions.push(decisions);
            
            // Calculate impact of decisions
            let marketShareChange = 0;
            let profitChange = 0;
            let innovationChange = 0;
            let revenueChange = 0;
            
            // Investment priority impact
            if (decisions.investmentPriority === 'traditional') {
                marketShareChange -= 2;
                profitChange += 0.3;
                innovationChange -= 5;
                revenueChange += 2;
            } else if (decisions.investmentPriority === 'balanced') {
                marketShareChange -= 1;
                profitChange += 0.1;
                innovationChange += 2;
                revenueChange += 1;
            } else if (decisions.investmentPriority === 'innovative') {
                marketShareChange += 1;
                profitChange -= 0.5;
                innovationChange += 8;
                revenueChange -= 1;
            }
            
            // Manufacturing strategy impact
            if (decisions.manufacturingStrategy === 'inhouse') {
                marketShareChange -= 0.5;
                profitChange -= 0.3;
                innovationChange += 1;
            } else if (decisions.manufacturingStrategy === 'outsource') {
                marketShareChange += 0.5;
                profitChange += 0.4;
                innovationChange -= 2;
            }
            
            // Market expansion impact
            if (decisions.marketExpansion === 'domestic') {
                marketShareChange -= 1;
                profitChange += 0.2;
                innovationChange -= 1;
                revenueChange -= 1;
            } else if (decisions.marketExpansion === 'global') {
                marketShareChange += 1;
                profitChange -= 0.3;
                innovationChange += 1;
                revenueChange += 2;
            }
            
            // Product line decision impact
            if (decisions.productLine === 'maintain') {
                marketShareChange += 0.5;
                profitChange -= 0.4;
                innovationChange -= 2;
                revenueChange += 1;
            } else if (decisions.productLine === 'exit') {
                marketShareChange -= 2;
                profitChange += 0.6;
                innovationChange += 4;
                revenueChange -= 3;
            }
            
            // Apply market trends based on year
            const yearFactor = Math.min((state.year - 2000) / 20, 1);
            
            // Japanese electronics industry decline over time
            marketShareChange -= 1 * yearFactor;
            profitChange -= 0.3 * yearFactor;
            
            // Adjust for traditional vs innovative focus as time progresses
            if (decisions.investmentPriority === 'traditional') {
                marketShareChange -= 1 * yearFactor;
                profitChange -= 0.5 * yearFactor;
            } else if (decisions.investmentPriority === 'innovative') {
                marketShareChange += 0.5 * yearFactor;
                profitChange += 0.3 * yearFactor;
            }
            
            // Apply changes to state
            state.marketShare = Math.max(1, Math.min(40, state.marketShare + marketShareChange));
            state.profit = Math.max(-10, Math.min(25, state.profit + profitChange));
            state.innovation = Math.max(10, Math.min(100, state.innovation + innovationChange));
            state.revenue = Math.max(5, Math.min(100, state.revenue + revenueChange));
            
            // Update competitor data
            const yearIndex = (state.year - 2000) / 3;
            state.competitors.samsung.profit = Math.min(25, 6.5 + yearIndex * 1.5);
            state.competitors.apple.profit = Math.min(30, 8.0 + yearIndex * 2.0);
            
            // Save history
            state.history.marketShare.push(state.marketShare);
            state.history.profit.push(state.profit);
            state.history.innovation.push(state.innovation);
            
            // Show results
            showResults(decisions);
        }
        
        // Show the results of the decision
        function showResults(decisions) {
            // Hide decision form, show results
            decisionContent.classList.add('hidden');
            resultsContent.classList.remove('hidden');
            
            // Generate results text
            let resultText = `<p class="mb-4">Year ${state.year} Results:</p>`;
            resultText += '<ul class="list-disc pl-6 mb-4">';
            
            if (state.marketShare < 15) {
                resultText += '<li class="text-red-500 dark:text-red-400">Your market share has declined significantly.</li>';
            } else if (state.marketShare < 20) {
                resultText += '<li class="text-yellow-500 dark:text-yellow-400">Your market share is declining.</li>';
            } else {
                resultText += '<li class="text-green-500 dark:text-green-400">Your market share remains strong.</li>';
            }
            
            if (state.profit < 0) {
                resultText += `<li class="text-red-500 dark:text-red-400">Your company is losing money ($${state.profit.toFixed(1)}B).</li>`;
            } else if (state.profit < 2) {
                resultText += `<li class="text-yellow-500 dark:text-yellow-400">Your profits are slim ($${state.profit.toFixed(1)}B).</li>`;
            } else {
                resultText += `<li class="text-green-500 dark:text-green-400">Your company is profitable ($${state.profit.toFixed(1)}B).</li>`;
            }
            
            if (state.innovation < 40) {
                resultText += '<li class="text-red-500 dark:text-red-400">Your innovation index is very low.</li>';
            } else if (state.innovation < 60) {
                resultText += '<li class="text-yellow-500 dark:text-yellow-400">Your innovation is below industry average.</li>';
            } else {
                resultText += '<li class="text-green-500 dark:text-green-400">Your company is seen as innovative.</li>';
            }
            
            resultText += '</ul>';
            
            // Add feedback based on decisions
            resultText += '<p class="mb-4">Analysis:</p>';
            resultText += '<ul class="list-disc pl-6">';
            
            if (decisions.investmentPriority === 'traditional') {
                resultText += '<li>Your focus on traditional products is providing short-term profits but may limit future growth.</li>';
            } else if (decisions.investmentPriority === 'innovative') {
                resultText += '<li>Your investments in innovation could position you well for future markets but are currently impacting profits.</li>';
            }
            
            if (decisions.productLine === 'maintain' && state.year >= 2009) {
                resultText += '<li>Maintaining all product lines is stretching resources thin and reducing overall competitiveness.</li>';
            } else if (decisions.productLine === 'exit') {
                resultText += '<li>Exiting unprofitable segments has improved your financial position but reduced market presence.</li>';
            }
            
            resultText += '</ul>';
            
            yearResultsElement.innerHTML = resultText;
            
            // Show competitor news if available
            if (competitorNews[state.year]) {
                competitorNewsElement.innerHTML = `<p class="mt-4 p-3 bg-gray-100 dark:bg-gray-700 rounded"><strong>Competitor News:</strong> ${competitorNews[state.year]}</p>`;
            } else {
                competitorNewsElement.innerHTML = '';
            }
            
            // Update display
            updateDisplay();
        }
        
        // Continue to the next year
        function continueToNextYear() {
            // Advance 3 years
            state.year += 3;
            
            // Update news feed
            updateNewsFeed();
            
            // Reset form visibility
            decisionContent.classList.remove('hidden');
            resultsContent.classList.add('hidden');
            
            // Update scenario text
            const scenarioObj = scenarios.find(s => s.year === state.year);
            if (scenarioObj) {
                scenarioElement.innerHTML = `<p class="mb-4">${scenarioObj.text}</p>`;
            }
            
            // Update display
            updateDisplay();
            
            // Check if simulation is complete
            if (state.year > 2020) {
                endSimulation();
            }
        }
        
        // End the simulation
        function endSimulation() {
            simulationScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            
            // Generate final results
            let finalText = '<div class="text-center mb-6">';
            finalText += `<p class="text-2xl mb-2">Final Year: 2020</p>`;
            finalText += `<p class="text-xl mb-4">Nippon Electronics Final Position</p>`;
            finalText += '</div>';
            
            finalText += '<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">';
            finalText += `<div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg text-center">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Market Share</h3>
                            <p class="text-2xl font-bold">${state.marketShare.toFixed(1)}%</p>
                          </div>`;
            finalText += `<div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg text-center">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Annual Revenue</h3>
                            <p class="text-2xl font-bold">$${state.revenue.toFixed(1)}B</p>
                          </div>`;
            finalText += `<div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg text-center">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Annual Profit</h3>
                            <p class="text-2xl font-bold">$${state.profit.toFixed(1)}B</p>
                          </div>`;
            finalText += `<div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg text-center">
                            <h3 class="text-sm text-gray-500 dark:text-gray-400 mb-1">Innovation Index</h3>
                            <p class="text-2xl font-bold">${state.innovation}</p>
                          </div>`;
            finalText += '</div>';
            
            // Add comparison to Samsung and Apple
            finalText += `<div class="mb-6 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                            <h3 class="text-center font-semibold mb-3">2020 Profit Comparison</h3>
                            <div class="flex justify-center items-end space-x-8">
                                <div class="text-center">
                                    <div class="h-24 flex items-end justify-center">
                                        <div style="height: ${(state.profit/30)*100}%" class="w-12 bg-primary rounded-t"></div>
                                    </div>
                                    <p class="mt-2">Nippon<br>$${state.profit.toFixed(1)}B</p>
                                </div>
                                <div class="text-center">
                                    <div class="h-24 flex items-end justify-center">
                                        <div style="height: ${(state.competitors.samsung.profit/30)*100}%" class="w-12 bg-purple-500 rounded-t"></div>
                                    </div>
                                    <p class="mt-2">Samsung<br>$${state.competitors.samsung.profit.toFixed(1)}B</p>
                                </div>
                                <div class="text-center">
                                    <div class="h-24 flex items-end justify-center">
                                        <div style="height: ${(state.competitors.apple.profit/30)*100}%" class="w-12 bg-gray-500 rounded-t"></div>
                                    </div>
                                    <p class="mt-2">Apple<br>$${state.competitors.apple.profit.toFixed(1)}B</p>
                                </div>
                            </div>
                          </div>`;
            
            // Add assessment
            finalText += '<div class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg mb-6">';
            finalText += '<h3 class="font-semibold mb-3 text-center">Performance Assessment</h3>';
            
            if (state.profit < 0) {
                finalText += '<p class="text-center">Your company is in serious financial trouble, with significant losses.</p>';
            } else if (state.profit < 5) {
                finalText += '<p class="text-center">Your company has survived but is underperforming compared to major competitors.</p>';
            } else if (state.profit < 15) {
                finalText += '<p class="text-center">Your company is performing adequately but still lags behind industry leaders.</p>';
            } else {
                finalText += '<p class="text-center">Your company has successfully navigated the changing electronics landscape and is thriving.</p>';
            }
            
            finalText += '</div>';
            
            finalResultsElement.innerHTML = finalText;
            
            // Generate company journey
            let journeyText = '<ul class="space-y-3">';
            
            // Show key decisions and their impact
            state.decisions.forEach((decision, index) => {
                const year = 2000 + (index * 3);
                journeyText += `<li><strong>${year}:</strong> `;
                
                if (decision.investmentPriority === 'innovative' && decision.productLine === 'exit') {
                    journeyText += 'Focused on innovation and exited unprofitable segments. ';
                } else if (decision.investmentPriority === 'traditional' && decision.productLine === 'maintain') {
                    journeyText += 'Maintained traditional product focus. ';
                } else {
                    journeyText += 'Took a balanced approach to product strategy. ';
                }
                
                if (year === 2009) {
                    journeyText += `Market share: ${state.history.marketShare[index+1].toFixed(1)}%, Profit: $${state.history.profit[index+1].toFixed(1)}B`;
                }
                
                journeyText += '</li>';
            });
            
            journeyText += '</ul>';
            companyJourneyElement.innerHTML = journeyText;
        }
        
        // Restart the simulation
        function restartSimulation() {
            // Reset state
            state = {
                year: 2000,
                marketShare: 25,
                revenue: 50,
                profit: 5.2,
                innovation: 72,
                competitors: {
                    samsung: { profit: 6.5 },
                    apple: { profit: 8.0 }
                },
                history: {
                    marketShare: [25],
                    profit: [5.2],
                    innovation: [72]
                },
                decisions: []
            };
            
            // Reset UI
            endScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            
            // Reset form to default values
            investmentPriority.value = 'traditional';
            manufacturingStrategy.value = 'inhouse';
            marketExpansion.value = 'domestic';
            productLine.value = 'maintain';
            
            // Reset scenario text
            scenarioElement.innerHTML = `<p class="mb-4">${scenarios[0].text}</p>`;
            
            // Reset news feed
            updateNewsFeed();
        }
        
        // Update the display with current state
        function updateDisplay() {
            yearDisplay.textContent = state.year;
            marketShareDisplay.textContent = `${state.marketShare.toFixed(1)}%`;
            revenueDisplay.textContent = `$${state.revenue.toFixed(1)}B`;
            profitDisplay.textContent = `$${state.profit.toFixed(1)}B`;
            innovationDisplay.textContent = state.innovation;
            
            // Update competitor display
            nipponProfitDisplay.textContent = `$${state.profit.toFixed(1)}B`;
            samsungProfitDisplay.textContent = `$${state.competitors.samsung.profit.toFixed(1)}B`;
            appleProfitDisplay.textContent = `$${state.competitors.apple.profit.toFixed(1)}B`;
            
            // Update bars
            const maxProfit = Math.max(state.profit, state.competitors.samsung.profit, state.competitors.apple.profit);
            nipponBar.style.height = `${(state.profit / maxProfit) * 100}%`;
            samsungBar.style.height = `${(state.competitors.samsung.profit / maxProfit) * 100}%`;
            appleBar.style.height = `${(state.competitors.apple.profit / maxProfit) * 100}%`;
            
            // Update charts
            updateCharts();
        }
        
        // Update line charts
        function updateCharts() {
            const chartWidth = 600;
            const chartHeight = 150;
            const points = state.history.marketShare.length;
            
            if (points > 1) {
                // Market share line
                let marketSharePoints = state.history.marketShare.map((value, index) => {
                    const x = (index / (points - 1)) * chartWidth;
                    const y = chartHeight - ((value / 40) * chartHeight);
                    return `${x},${y}`;
                }).join(' ');
                marketShareLine.setAttribute('points', marketSharePoints);
                
                // Profit line
                let profitPoints = state.history.profit.map((value, index) => {
                    const x = (index / (points - 1)) * chartWidth;
                    // Scale from -10 to 25
                    const y = chartHeight - (((value + 10) / 35) * chartHeight);
                    return `${x},${y}`;
                }).join(' ');
                profitLine.setAttribute('points', profitPoints);
                
                // Innovation line
                let innovationPoints = state.history.innovation.map((value, index) => {
                    const x = (index / (points - 1)) * chartWidth;
                    const y = chartHeight - ((value / 100) * chartHeight);
                    return `${x},${y}`;
                }).join(' ');
                innovationLine.setAttribute('points', innovationPoints);
            }
        }
        
        // Update news feed
        function updateNewsFeed() {
            if (newsEvents[state.year]) {
                let newsHtml = '';
                newsEvents[state.year].forEach(event => {
                    newsHtml += `<p class="mb-2"><strong>${state.year}:</strong> ${event}</p>`;
                });
                newsContentElement.innerHTML = newsHtml;
            }
        }
    </script>
</body>
</html>