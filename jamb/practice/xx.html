+    1 <!DOCTYPE html>
+    2 <html lang="en">
+    3 <head>
+    4     <meta charset="UTF-8">
+    5     <meta name="viewport" content="width=device-width">
+    6     <title> JAMB Tutor</title>
+    7     <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
+    8     <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
+    9     <!-- Google tag (gtag.js) -->
+   10     <script async src="https://www.googletagmanager.com/gtag/js?id=G-8LYQ579PW8"></script>
+   11     <script>
+   12     window.dataLayer = window.dataLayer || [];
+   13     function gtag(){dataLayer.push(arguments);}
+   14     gtag('js', new Date());
+   15 
+   16     gtag('config', 'G-8LYQ579PW8');
+   17     </script>
+   18     <script src="https://cdn.tailwindcss.com"></script>
+   19     <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
+   20     <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
+   21     <script>
+   22         tailwind.config = {
+   23             darkMode: 'class',
+   24             theme: {
+   25                 extend: {
+   26                     colors: {
+   27                         primary: {
+   28                             DEFAULT: "#0F2C59",
+   29                             50: "#f0f3f8",
+   30                             100: "#d6e1ee",
+   31                             500: "#0F2C59",
+   32                             600: "#0a2549",
+   33                             700: "#081e39",
+   34                         },
+   35                         accent: {
+   36                             DEFAULT: "#009F9D",
+   37                             50: "#e6f7f7",
+   38                             100: "#b3ebea",
+   39                             500: "#009F9D",
+   40                             600: "#008280",
+   41                             700: "#006663",
+   42                         },
+   43                         neutral: {
+   44                             25: "#FEFEFE",
+   45                             50: "#F8F9FA",
+   46                             100: "#F1F3F4",
+   47                             200: "#E8EAED",
+   48                             300: "#DADCE0",
+   49                             400: "#BDC1C6",
+   50                             500: "#9AA0A6",
+   51                             600: "#80868B",
+   52                             700: "#5F6368",
+   53                             800: "#2D3748",
+   54                             900: "#1F2937",
+   55                         },
+   56                         premium: {
+   57                             DEFAULT: "#D2C1A7",
+   58                             50: "#fbf9f6",
+   59                             100: "#f4efe6",
+   60                             500: "#D2C1A7",
+   61                             600: "#c4b095",
+   62                             700: "#b69f83",
+   63                         },
+   64                         data: {
+   65                             DEFAULT: "#5A7B9E",
+   66                             50: "#f2f5f9",
+   67                             100: "#e1e9f2",
+   68                             500: "#5A7B9E",
+   69                             600: "#4d6a87",
+   70                             700: "#405970",
+   71                         },
+   72                         success: "#22c55e",
+   73                         warning: "#f59e0b",
+   74                         error: "#ef4444",
+   75                     },
+   76 
+   77                     boxShadow: {
+   78                         'material-1': '0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)',
+   79                         'material-2': '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)',
+   80                         'material-3': '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',
+   81                         'material-4': '0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)',
+   82                         'material-5': '0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22)',
+   83                     },
+   84 
+   85                     fontFamily: {
+   86                         'sans': ['Roboto', 'system-ui', 'sans-serif'],
+   87                     },
+   88                 }
+   89             }
+   90         }
+   91     </script>
+   92     
+   93     <style>
+   94         
+   95         .material-card {
+   96             transition: 
+   97             box-shadow 0.28s cubic-bezier(0.4, 0.0, 0.2, 1), 
+   98             transform 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
+   99         }
+  100 
+  101         .material-card:hover {
+  102             box-shadow: 0 8px 25px rgba(0,0,0,0.15);
+  103             transform: translateY(-2px);
+  104         }
+  105         .material-button {
+  106             transition: all 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
+  107             position: relative;
+  108             overflow: hidden;
+  109         }
+  110 
+  111         .material-button:active {
+  112             transform: scale(0.98);
+  113         }
+  114 
+  115         .dark .material-card {
+  116             background-color: #1F2937;
+  117             border-color: #374151;
+  118         }
+  119         .dark .material-card:hover {
+  120             box-shadow: 0 8px 25px rgba(0,0,0,0.3);
+  121         }
+  122 
+  123 
+  124         .headline-4 { font-size: 1.75rem; font-weight: 400; line-height: 1.235; letter-spacing: 0.25px; }
+  125         .headline-6 { font-size: 1.125rem; font-weight: 500; line-height: 1.6; letter-spacing: 0.15px; }
+  126         .subtitle-1 { font-size: 1rem; font-weight: 400; line-height: 1.75; letter-spacing: 0.15px; }
+  127         .body-1 { font-size: 1rem; font-weight: 400; line-height: 1.5; letter-spacing: 0.5px; }
+  128         .button-text { font-size: 0.875rem; font-weight: 500; line-height: 1.75; letter-spacing: 1.25px; text-transform: uppercase; }
+  129         .caption { font-size: 0.75rem; font-weight: 400; line-height: 1.66; letter-spacing: 0.4px; }
+  130         @media (min-width: 768px) {
+  131             .headline-4 { font-size: 2.125rem; }
+  132             .headline-6 { font-size: 1.25rem; }
+  133         }
+  134 
+  135 
+  136       .touch-target {
+  137             min-height: 44px;
+  138             min-width: 44px;
+  139         }
+  140 
+  141 
+  142         .fade-in {
+  143             animation: fadeIn 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
+  144         }
+  145         @keyframes fadeIn {
+  146             from { opacity: 0; transform: translateY(16px); }
+  147             to { opacity: 1; transform: translateY(0); }
+  148         }
+  149 
+  150 
+  151         .stagger-animation {
+  152             animation: fadeInStagger 0.6s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
+  153             opacity: 0;
+  154         }
+  155         .stagger-animation:nth-child(1) { animation-delay: 0.1s; }
+  156         .stagger-animation:nth-child(2) { animation-delay: 0.2s; }
+  157         .stagger-animation:nth-child(3) { animation-delay: 0.3s; }
+  158         .stagger-animation:nth-child(4) { animation-delay: 0.4s; }
+  159         .stagger-animation:nth-child(5) { animation-delay: 0.5s; }
+  160         .stagger-animation:nth-child(6) { animation-delay: 0.6s; }
+  161         @keyframes fadeInStagger {
+  162             from { opacity: 0; transform: translateY(20px); }
+  163             to { opacity: 1; transform: translateY(0); }
+  164         }
+  165 
+  166   
+  167         /* Quiz specific styles */
+  168         .option-btn {
+  169             border: 2px solid transparent;
+  170             transition: all 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
+  171         }
+  172 
+  173         .option-btn:hover {
+  174             border-color: rgba(15, 44, 89, 0.3);
+  175             transform: translateY(-1px);
+  176         }
+  177 
+  178         .option-btn.selected {
+  179             border-color: #0F2C59;
+  180             background-color: rgba(15, 44, 89, 0.1);
+  181             color: #0F2C59;
+  182         }
+  183 
+  184         .option-btn.correct {
+  185             border-color: #22c55e;
+  186             background-color: rgba(34, 197, 94, 0.1);
+  187             color: #22c55e;
+  188         }
+  189 
+  190         .option-btn.incorrect {
+  191             border-color: #ef4444;
+  192             background-color: rgba(239, 68, 68, 0.1);
+  193             color: #ef4444;
+  194         }
+  195 
+  196         .dark .option-btn.selected {
+  197             background-color: rgba(15, 44, 89, 0.3);
+  198             color: #d6e1ee;
+  199         }
+  200 
+  201         .dark .option-btn.correct {
+  202             background-color: rgba(34, 197, 94, 0.2);
+  203             color: #22c55e;
+  204         }
+  205 
+  206         .dark .option-btn.incorrect {
+  207             background-color: rgba(239, 68, 68, 0.2);
+  208             color: #ef4444;
+  209         }
+  210 
+  211 
+  212         .progress-bar {
+  213             height: 4px;
+  214             background-color: rgba(15, 44, 89, 0.1);
+  215             border-radius: 4px;
+  216             overflow: hidden;
+  217         }
+  218         .progress-fill {
+  219             background: linear-gradient(90deg, #0F2C59, #009F9D);
+  220             height: 100%;
+  221             transition: width 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
+  222         }
+  223 
+  224 
+  225         .spinner {
+  226             border: 2px solid transparent;
+  227             border-top: 2px solid #0F2C59;
+  228             border-radius: 50%;
+  229             width: 20px;
+  230             height: 20px;
+  231             animation: spin 1s linear infinite;
+  232         }
+  233         @keyframes spin {
+  234             0% { transform: rotate(0deg); }
+  235             100% { transform: rotate(360deg); }
+  236         }
+  237         
+  238 
+  239         
+  240         /* Analytics styles */
+  241         .chart-container {
+  242             position: relative;
+  243             height: 300px;
+  244             width: 100%;
+  245         }
+  246         .chart-container canvas {
+  247             max-height: 100% !important;
+  248             max-width: 100% !important;
+  249         }
+  250 
+  251 
+  252         .heatmap-grid {
+  253             display: grid;
+  254             grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
+  255             gap: 8px;
+  256         }
+  257 
+  258         .heatmap-cell {
+  259             aspect-ratio: 1;
+  260             border-radius: 8px;
+  261             display: flex;
+  262             flex-direction: column;
+  263             align-items: center;
+  264             justify-content: center;
+  265             text-align: center;
+  266             padding: 8px;
+  267             transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
+  268             cursor: pointer;
+  269         }
+  270 
+  271 
+  272         .heatmap-cell:hover {
+  273             transform: scale(1.05);
+  274         }
+  275 
+  276         .status-excellent { background: linear-gradient(135deg, #10B981, #059669); }
+  277         .status-good { background: linear-gradient(135deg, #3B82F6, #1D4ED8); }
+  278         .status-average { background: linear-gradient(135deg, #F59E0B, #D97706); }
+  279         .status-weak { background: linear-gradient(135deg, #EF4444, #DC2626); }
+  280         .status-unstarted { background: linear-gradient(135deg, #6B7280, #4B5563); }
+  281         
+  282         
+  283         .progress-ring {
+  284             transform: rotate(-90deg);
+  285         }
+  286         .progress-ring-circle {
+  287             stroke-dasharray: 251.2;
+  288             stroke-dashoffset: 251.2;
+  289             transition: stroke-dashoffset 0.5s cubic-bezier(0.4, 0, 0.2, 1);
+  290         }
+  291 
+  292 
+  293         /* Mobile menu styles */
+  294         .mobile-menu {
+  295             transform: translateX(-100%);
+  296             transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
+  297         }
+  298         .mobile-menu.open {
+  299             transform: translateX(0);
+  300         }
+  301         .mobile-menu-overlay {
+  302             opacity: 0;
+  303             visibility: hidden;
+  304             transition: opacity 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), visibility 0.3s;
+  305         }
+  306         .mobile-menu-overlay.open {
+  307             opacity: 1;
+  308             visibility: visible;
+  309         }
+  310 
+  311         .material-icons {
+  312             font-family: 'Material Icons';
+  313             font-weight: normal;
+  314             font-style: normal;
+  315             font-size: 24px;
+  316             line-height: 1;
+  317             letter-spacing: normal;
+  318             text-transform: none;
+  319             display: inline-block;
+  320             white-space: nowrap;
+  321             word-wrap: normal;
+  322             direction: ltr;
+  323             -webkit-font-feature-settings: 'liga';
+  324             -webkit-font-smoothing: antialiased;
+  325         }
+  326 
+  327         /* Swipe gesture styles */
+  328         .swipe-container {
+  329             touch-action: pan-y; /* Allow vertical scrolling but enable horizontal swipes */
+  330             user-select: none;
+  331             position: relative;
+  332         }
+  333 
+  334         .swipe-indicator {
+  335             position: fixed;
+  336             top: 50%;
+  337             transform: translateY(-50%);
+  338             opacity: 0;
+  339             transition: opacity 0.2s ease-out;
+  340             pointer-events: none;
+  341             z-index: 1000;
+  342         }
+  343 
+  344         .swipe-indicator.left {
+  345             left: 20px;
+  346         }
+  347 
+  348         .swipe-indicator.right {
+  349             right: 20px;
+  350         }
+  351 
+  352         .swipe-indicator.active {
+  353             opacity: 1;
+  354         }
+  355 
+  356         .swipe-indicator .icon-circle {
+  357             width: 60px;
+  358             height: 60px;
+  359             border-radius: 50%;
+  360             background: rgba(15, 44, 89, 0.9);
+  361             display: flex;
+  362             align-items: center;
+  363             justify-content: center;
+  364             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
+  365         }
+  366 
+  367         .swipe-indicator .material-icons {
+  368             color: white;
+  369             font-size: 32px;
+  370         }
+  371 
+  372         /* Double-tap feedback */
+  373         @keyframes pulse-ring {
+  374             0% {
+  375                 transform: scale(1);
+  376                 opacity: 0.8;
+  377             }
+  378             100% {
+  379                 transform: scale(1.5);
+  380                 opacity: 0;
+  381             }
+  382         }
+  383 
+  384         .double-tap-feedback {
+  385             position: absolute;
+  386             width: 100px;
+  387             height: 100px;
+  388             border-radius: 50%;
+  389             border: 3px solid #009F9D;
+  390             pointer-events: none;
+  391             animation: pulse-ring 0.6s ease-out;
+  392         }
+  393     </style>
+  394 
+  395 
+  396 </head>
+  397 <body class="
+  398 bg-white 
+  399 dark:bg-black
+  400 roboto 
+  401 transition-colors 
+  402 duration-200">
+  403 
+  404     <!-- Header -->
+  405     <header class="
+  406     bg-white 
+  407     dark:bg-neutral-800 
+  408     shadow-material-1 
+  409     sticky 
+  410     top-0 
+  411     z-50">
+  412         <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
+  413             <div class="flex items-center justify-between h-16">
+  414                 
+  415                 <!-- Logo & Brand -->
+  416                 <div class="flex items-center space-x-3 sm:space-x-4">
+  417                     <div class="flex items-center space-x-2 sm:space-x-3">
+  418                        
+  419                         <div class="w-8 
+  420                         h-8 
+  421                         sm:w-10 
+  422                         sm:h-10 
+  423                         bg-primary
+  424                         rounded-lg 
+  425                         flex 
+  426                         items-center 
+  427                         justify-center 
+  428                         shadow-material-1">
+  429                             <span class="
+  430                             text-white 
+  431                             font-medium 
+  432                             text-sm 
+  433                             sm:text-lg">R</span>
+  434                         </div>
+  435 
+  436                         <div>
+  437                             <h1 class="headline-6 text-neutral-800 dark:text-white">Raven</h1>
+  438                             <p class="
+  439                             caption 
+  440                             text-neutral-600 
+  441                             dark:text-neutral-400 
+  442                             hidden 
+  443                             sm:block">Adaptive Learning Platform</p>
+  444                         </div>
+  445 
+  446                     </div>
+  447                 </div>
+  448 
+  449                 <!-- Desktop Navigation -->
+  450                 <nav class="
+  451                 hidden 
+  452                 md:flex 
+  453                 items-center 
+  454                 space-x-1">
+  455                     <button id="practiceBtn" class="
+  456                     material-button 
+  457                     px-4 
+  458                     py-2 
+  459                     text-neutral-600 
+  460                     dark:text-neutral-400 
+  461                     hover:text-primary 
+  462                     button-text rounded-lg 
+  463                     hover:bg-neutral-100 
+  464                     dark:hover:bg-neutral-700 
+  465                     transition-colors">Practice</button>
+  466                     <button id="tutorBtn" class="material-button px-4 py-2 text-neutral-600 dark:text-neutral-400 hover:text-primary button-text rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors">AI Tutor</button>
+  467                     <button id="progressBtn" class="material-button px-4 py-2 text-neutral-600 dark:text-neutral-400 hover:text-primary button-text rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors">Progress</button>
+  468                     <button id="analyticsBtn" class="material-button px-4 py-2 text-neutral-600 dark:text-neutral-400 hover:text-primary button-text rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors">Analytics</button>
+  469                 </nav>
+  470 
+  471                 <!-- User Actions & Mobile Menu Button -->
+  472                 <div class="
+  473                 flex 
+  474                 items-center 
+  475                 space-x-2 
+  476                 sm:space-x-3">
+  477 
+  478                     <!-- Mobile Menu Button -->
+  479                     <button id="mobileMenuBtn" class="md:hidden material-button touch-target w-8 h-8 sm:w-10 sm:h-10 bg-neutral-100 dark:bg-neutral-700 rounded-full flex items-center justify-center text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-600 transition-colors">
+  480                         <span class="material-icons text-sm sm:text-lg" id="mobileMenuIcon">menu</span>
+  481                     </button>
+  482                     
+  483                 </div>
+  484             </div>
+  485         </div>
+  486     </header>
+  487 
+  488     <!-- Mobile Menu Overlay -->
+  489     <div id="mobileMenuOverlay" class="
+  490     mobile-menu-overlay 
+  491     fixed 
+  492     inset-0 
+  493     bg-black 
+  494     bg-opacity-50 
+  495     z-40 
+  496     md:hidden">
+  497        
+  498 
+  499 
+  500 
+  501         <!-- Mobile Navigation Menu -->
+  502         <div id="mobileMenu" class="mobile-menu fixed top-0 right-0 h-full w-80 max-w-full bg-white dark:bg-neutral-800 shadow-material-5 z-50">
+  503            
+  504             <div class="flex items-center justify-between p-4 border-b border-neutral-200 dark:border-neutral-700">
+  505                
+  506                 <h2 class="headline-6 text-neutral-800 dark:text-white">Menu</h2>
+  507                 
+  508                 <button id="closeMobileMenu" class="material-button touch-target w-10 h-10 bg-neutral-100 dark:bg-neutral-700 rounded-full flex items-center justify-center text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-600">
+  509                     <span class="material-icons">close</span>
+  510                 </button>
+  511 
+  512             </div>
+  513             
+  514 
+  515             <nav class="p-4">
+  516                 <div class="space-y-2">
+  517                     <button id="mobilePracticeBtn" class="mobile-nav-btn material-button w-full flex items-center space-x-3 p-4 text-neutral-600 dark:text-neutral-400 hover:text-primary hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors touch-target">
+  518                         <span class="material-icons">quiz</span>
+  519                         <span class="button-text">Practice</span>
+  520                     </button>
+  521                     
+  522                     <button id="mobileTutorBtn" class="mobile-nav-btn material-button w-full flex items-center space-x-3 p-4 text-neutral-600 dark:text-neutral-400 hover:text-primary hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors touch-target">
+  523                         <span class="material-icons">psychology</span>
+  524                         <span class="button-text">AI Tutor</span>
+  525                     </button>
+  526                     
+  527                     <button id="mobileProgressBtn" class="mobile-nav-btn material-button w-full flex items-center space-x-3 p-4 text-neutral-600 dark:text-neutral-400 hover:text-primary hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors touch-target">
+  528                         <span class="material-icons">trending_up</span>
+  529                         <span class="button-text">Progress</span>
+  530                     </button>
+  531                     
+  532                     <button id="mobileAnalyticsBtn" class="mobile-nav-btn material-button w-full flex items-center space-x-3 p-4 text-neutral-600 dark:text-neutral-400 hover:text-primary hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors touch-target">
+  533                         <span class="material-icons">analytics</span>
+  534                         <span class="button-text">Analytics</span>
+  535                     </button>
+  536                 </div>
+  537                 
+  538                 <div class="mt-8 pt-6 border-t border-neutral-200 dark:border-neutral-700">
+  539                     <div class="flex items-center space-x-3 p-4">
+  540                         <div class="w-12 h-12 bg-accent rounded-full flex items-center justify-center shadow-material-1">
+  541                             <span class="text-white font-medium">DM</span>
+  542                         </div>
+  543                         <div>
+  544                             <div class="subtitle-1 font-medium text-neutral-800 dark:text-white">Your Account</div>
+  545                             <div class="caption text-neutral-600 dark:text-neutral-400">Manage settings</div>
+  546                         </div>
+  547                     </div>
+  548                 </div>
+  549             </nav>
+  550         </div>
+  551     </div>
+  552 
+  553     <!-- Swipe Indicators -->
+  554     <div id="swipeIndicatorLeft" class="swipe-indicator left">
+  555         <div class="icon-circle">
+  556             <span class="material-icons">arrow_back</span>
+  557         </div>
+  558     </div>
+  559     <div id="swipeIndicatorRight" class="swipe-indicator right">
+  560         <div class="icon-circle">
+  561             <span class="material-icons">arrow_forward</span>
+  562         </div>
+  563     </div>
+  564 
+  565     <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
+  566         <!-- Subject Selection -->
+  567         <div id="subjectSelection" class="mb-6">
+  568             <!-- Hero Section -->
+  569             <div class="text-center mb-8 sm:mb-12 fade-in">
+  570                 <div class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-primary to-accent rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6 shadow-material-3">
+  571                     <span class="material-icons text-white text-2xl sm:text-3xl">school</span>
+  572                 </div>
+  573                 <h2 class="headline-4 text-neutral-800 dark:text-white mb-3 sm:mb-4">Choose Your Subject</h2>
+  574                 <p class="subtitle-1 text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto mb-2">
+  575                     Ready to dive deep into learning? Select a subject below to access interactive materials, practice questions, and comprehensive study guides.
+  576                 </p>
+  577                 <div class="flex items-center justify-center space-x-2 text-accent">
+  578                     <span class="material-icons text-sm">auto_awesome</span>
+  579                     <span class="caption font-medium">Let's make learning fun!</span>
+  580                     <span class="material-icons text-sm">auto_awesome</span>
+  581                 </div>
+  582             </div>
+  583             
+  584             <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6" id="subjectGrid">
+  585                 <!-- Subjects will be loaded here -->
+  586             </div>
+  587         </div>
+  588 
+  589         <!-- Topic Selection -->
+  590         <div id="topicSelection" class="mb-6 hidden">
+  591             <div class="
+  592             flex 
+  593             items-center 
+  594             space-x-4 
+  595             mb-6">
+  596                 <button id="backToSubjects" class="
+  597                 material-button 
+  598                 text-primary 
+  599                 hover:text-primary-600 
+  600                 flex 
+  601                 items-center 
+  602                 space-x-2 
+  603                 transition-colors
+  604                 dark:text-white
+  605                 dark:hover:text-neutral-300">
+  606                     <span class="material-icons">arrow_back</span>
+  607                     <span class="button-text">Back to Subjects</span>
+  608                 </button>
+  609             </div>
+  610             
+  611             <div class="text-center mb-8 sm:mb-12 fade-in">
+  612                 
+  613                 <div class="
+  614                 w-12 
+  615                 h-12 
+  616                 sm:w-16 
+  617                 sm:h-16 
+  618                 bg-gradient-to-br 
+  619                 from-primary to-accent 
+  620                 rounded-xl 
+  621                 flex 
+  622                 items-center 
+  623                 justify-center 
+  624                 mx-auto 
+  625                 mb-4 
+  626                 shadow-material-2">
+  627                     <span class="material-icons text-white text-lg sm:text-2xl">quiz</span>
+  628                 </div>
+  629 
+  630                 <h2 class="
+  631                 headline-4 
+  632                 text-neutral-800 
+  633                 dark:text-white 
+  634                 mb-3" 
+  635                 id="selectedSubjectTitle">
+  636                 </h2>
+  637                 
+  638                 <p class="
+  639                 subtitle-1 
+  640                 text-white 
+  641                 dark:text-neutral-400">
+  642                     Choose a topic to start practicing questions
+  643                 </p>
+  644             </div>
+  645             
+  646             <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6" id="topicGrid">
+  647                 <!-- Topics will be loaded here -->
+  648             </div>
+  649         </div>
+  650 
+  651         <!-- Quiz Interface -->
+  652         <div id="quizInterface" class="hidden">
+  653             <div class="flex items-center justify-between mb-6">
+  654                 <button id="backToTopics" class="material-button text-primary hover:text-primary-600 flex items-center space-x-2 transition-colors">
+  655                     <span class="material-icons">arrow_back</span>
+  656                     <span class="button-text">Back to Topics</span>
+  657                 </button>
+  658                 <div class="caption text-neutral-600 dark:text-neutral-400">
+  659                     Question <span id="currentQuestion">1</span> of <span id="totalQuestions">0</span>
+  660                 </div>
+  661             </div>
+  662 
+  663             <!-- Progress Bar -->
+  664             <div class="progress-bar mb-8">
+  665                 <div id="progressFill" class="progress-fill" style="width: 0%"></div>
+  666             </div>
+  667 
+  668             <div id="quizCard" class="material-card swipe-container bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-6 sm:p-8 shadow-material-2">
+  669                 <div class="mb-4">
+  670                     <span class="caption text-neutral-600 dark:text-neutral-400" id="questionMeta"></span>
+  671                 </div>
+  672                 <h3 class="subtitle-1 font-medium mb-6 text-neutral-800 dark:text-white" id="questionText"></h3>
+  673                 <div id="questionOptions" class="space-y-4"></div>
+  674                 
+  675                 <!-- Explanation box (hidden by default) -->
+  676                 <div id="explanationBox" class="material-card bg-premium-50 dark:bg-premium-900/20 border border-premium-200 dark:border-premium-700 rounded-xl p-4 mt-6 hidden">
+  677                     <div class="flex items-center space-x-2 mb-3">
+  678                         <span class="material-icons text-premium-600 dark:text-premium-400">lightbulb</span>
+  679                         <h4 class="subtitle-1 font-medium text-premium-800 dark:text-premium-200">Explanation</h4>
+  680                     </div>
+  681                     <p class="body-1 text-premium-700 dark:text-premium-300" id="explanationText"></p>
+  682                 </div>
+  683             </div>
+  684 
+  685             <div id="quizNavigation" class="flex justify-between items-center mt-8">
+  686                 <button id="explainBtn" class="material-button bg-accent hover:bg-accent-600 text-white px-6 py-3 rounded-lg button-text flex items-center space-x-2 shadow-material-1 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
+  687                     <span class="material-icons">psychology</span>
+  688                     <span>Explain This</span>
+  689                 </button>
+  690                 <div class="flex space-x-3">
+  691                     <button id="prevBtn" class="material-button bg-neutral-200 dark:bg-neutral-700 hover:bg-neutral-300 dark:hover:bg-neutral-600 text-neutral-700 dark:text-neutral-300 px-6 py-3 rounded-lg button-text shadow-material-1 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Previous</button>
+  692                     <button id="nextBtn" class="material-button bg-primary hover:bg-primary-600 text-white px-6 py-3 rounded-lg button-text shadow-material-1 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Next</button>
+  693                 </div>
+  694             </div>
+  695 
+  696             <!-- Quiz Results -->
+  697             <div id="quizResults" class="hidden mt-8">
+  698                 <div class="material-card bg-gradient-to-r from-primary-50 to-accent-50 dark:from-primary-900/20 dark:to-accent-900/20 border border-primary-200 dark:border-primary-700 rounded-xl p-8 text-center shadow-material-3">
+  699                     <div class="w-16 h-16 bg-gradient-to-br from-primary to-accent rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-material-3">
+  700                         <span class="material-icons text-white text-2xl">emoji_events</span>
+  701                     </div>
+  702                     <h3 class="headline-4 text-neutral-800 dark:text-white mb-4">Quiz Complete!</h3>
+  703                     <div class="mb-6">
+  704                         <div class="text-5xl font-bold text-primary mb-2" id="finalScore">0%</div>
+  705                         <div class="subtitle-1 text-neutral-600 dark:text-neutral-400" id="scoreDetails">0 out of 0 correct</div>
+  706                     </div>
+  707                     <div class="flex flex-col sm:flex-row justify-center gap-4">
+  708                         <button id="retakeBtn" class="material-button bg-primary hover:bg-primary-600 text-white px-8 py-3 rounded-lg button-text shadow-material-2">Retake Quiz</button>
+  709                         <button id="backToTopicsFromResults" class="material-button bg-neutral-200 dark:bg-neutral-700 hover:bg-neutral-300 dark:hover:bg-neutral-600 text-neutral-700 dark:text-neutral-300 px-8 py-3 rounded-lg button-text shadow-material-1">Choose Another Topic</button>
+  710                     </div>
+  711                 </div>
+  712             </div>
+  713         </div>
+  714 
+  715         <!-- AI Tutor Interface -->
+  716         <div id="tutorInterface" class="hidden">
+  717             <div class="text-center mb-8 sm:mb-12 fade-in">
+  718                 <div class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-accent to-primary rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6 shadow-material-3">
+  719                     <span class="material-icons text-white text-2xl sm:text-3xl">psychology</span>
+  720                 </div>
+  721                 <h2 class="headline-4 text-neutral-800 dark:text-white mb-3 sm:mb-4">AI Tutor</h2>
+  722                 <p class="subtitle-1 text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto">
+  723                     Ask me anything about your studies! I'm here to help explain concepts and answer questions.
+  724                 </p>
+  725             </div>
+  726             
+  727             <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-6 sm:p-8 shadow-material-2">
+  728                 <div id="tutorChat" class="min-h-64 max-h-96 overflow-y-auto mb-4 p-4 bg-neutral-50 dark:bg-neutral-700 rounded-lg border border-neutral-200 dark:border-neutral-600"></div>
+  729                 <div class="flex space-x-3">
+  730                     <input type="text" id="tutorInput" class="flex-1 p-3 border border-neutral-300 dark:border-neutral-600 rounded-lg bg-white dark:bg-neutral-800 text-base focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Ask your question here...">
+  731                     <button id="sendTutorBtn" class="material-button bg-primary hover:bg-primary-600 text-white px-6 py-3 rounded-lg button-text shadow-material-1">Send</button>
+  732                 </div>
+  733             </div>
+  734         </div>
+  735 
+  736         <!-- Progress Interface -->
+  737         <div id="progressInterface" class="hidden">
+  738             <div class="text-center mb-8 sm:mb-12 fade-in">
+  739                 <div class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-data to-accent rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6 shadow-material-3">
+  740                     <span class="material-icons text-white text-2xl sm:text-3xl">analytics</span>
+  741                 </div>
+  742                 <h2 class="headline-4 text-neutral-800 dark:text-white mb-3 sm:mb-4">Your Progress</h2>
+  743                 <p class="subtitle-1 text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto">
+  744                     Track your learning journey and see how you're improving across different subjects.
+  745                 </p>
+  746             </div>
+  747             
+  748             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
+  749                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-6 shadow-material-2">
+  750                     <div class="flex items-center space-x-3 mb-4">
+  751                         <span class="material-icons text-data">trending_up</span>
+  752                         <h3 class="headline-6 text-neutral-800 dark:text-white">Overall Performance</h3>
+  753                     </div>
+  754                     <div id="overallStats"></div>
+  755                 </div>
+  756                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-6 shadow-material-2">
+  757                     <div class="flex items-center space-x-3 mb-4">
+  758                         <span class="material-icons text-accent">subject</span>
+  759                         <h3 class="headline-6 text-neutral-800 dark:text-white">Subject Breakdown</h3>
+  760                     </div>
+  761                     <div id="subjectStats"></div>
+  762                 </div>
+  763             </div>
+  764         </div>
+  765 
+  766 
+  767         <!-- Analytics Interface -->
+  768         <div id="analyticsInterface" class="hidden">
+  769             <div class="text-center mb-8 sm:mb-12 fade-in">
+  770                 <div class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-primary to-accent rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6 shadow-material-3">
+  771                     <span class="material-icons text-white text-2xl sm:text-3xl">analytics</span>
+  772                 </div>
+  773 
+  774                 <h2 class="headline-4 text-neutral-800 dark:text-white mb-3 sm:mb-4">Performance Analytics</h2>
+  775                 
+  776                 <p class="subtitle-1 text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto">
+  777                     Deep insights into your learning patterns and performance metrics.
+  778                 </p>
+  779 
+  780             </div>
+  781 
+  782             <!-- Overview Cards -->
+  783             <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8">
+  784                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  785                     <div class="flex items-center justify-between">
+  786                         <div>
+  787                             <p class="caption text-neutral-600 dark:text-neutral-400 text-xs sm:text-sm">Overall Score</p>
+  788                             <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-accent" id="analyticsOverallScore">--%</p>
+  789                         </div>
+  790                         <div class="relative w-12 h-12 sm:w-16 sm:h-16">
+  791                             <svg class="progress-ring w-12 h-12 sm:w-16 sm:h-16" viewBox="0 0 84 84">
+  792                                 <circle cx="42" cy="42" r="40" stroke="#e5e7eb" stroke-width="4" fill="none"/>
+  793                                 <circle cx="42" cy="42" r="40" stroke="#009F9D" stroke-width="4" fill="none" 
+  794                                         class="progress-ring-circle" id="analyticsProgressCircle"/>
+  795                             </svg>
+  796                             <div class="absolute inset-0 flex items-center justify-center">
+  797                                 <span class="text-xs sm:text-sm font-semibold" id="analyticsProgressText">--%</span>
+  798                             </div>
+  799                         </div>
+  800                     </div>
+  801                 </div>
+  802 
+  803                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  804                     <div class="flex items-center justify-between">
+  805                         <div>
+  806                             <p class="caption text-neutral-600 dark:text-neutral-400 text-xs sm:text-sm">Topics Mastered</p>
+  807                             <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-data" id="analyticsMasteredCount">--/--</p>
+  808                         </div>
+  809                         <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
+  810                             <span class="material-icons text-green-600 dark:text-green-400 text-lg sm:text-xl">check_circle</span>
+  811                         </div>
+  812                     </div>
+  813                 </div>
+  814 
+  815                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  816                     <div class="flex items-center justify-between">
+  817                         <div>
+  818                             <p class="caption text-neutral-600 dark:text-neutral-400 text-xs sm:text-sm">Weak Areas</p>
+  819                             <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-error" id="analyticsWeakCount">--</p>
+  820                         </div>
+  821                         <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
+  822                             <span class="material-icons text-red-600 dark:text-red-400 text-lg sm:text-xl">warning</span>
+  823                         </div>
+  824                     </div>
+  825                 </div>
+  826 
+  827                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  828                     <div class="flex items-center justify-between">
+  829                         <div>
+  830                             <p class="caption text-neutral-600 dark:text-neutral-400 text-xs sm:text-sm">Avg Time</p>
+  831                             <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-primary" id="analyticsAvgTime">--min</p>
+  832                         </div>
+  833                         <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center">
+  834                             <span class="material-icons text-orange-600 dark:text-orange-400 text-lg sm:text-xl">schedule</span>
+  835                         </div>
+  836                     </div>
+  837                 </div>
+  838             </div>
+  839 
+  840             <!-- Performance Heatmap -->
+  841             <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8 shadow-material-2">
+  842                 <h2 class="headline-6 font-semibold mb-4 sm:mb-6 text-lg sm:text-xl text-neutral-800 dark:text-white">Performance Heatmap</h2>
+  843                 <div class="mb-4">
+  844                     <div class="grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-4 text-xs sm:text-sm">
+  845                         <div class="flex items-center space-x-1 sm:space-x-2">
+  846                             <div class="w-3 h-3 sm:w-4 sm:h-4 rounded status-excellent"></div>
+  847                             <span>Excellent (80-100%)</span>
+  848                         </div>
+  849                         <div class="flex items-center space-x-1 sm:space-x-2">
+  850                             <div class="w-3 h-3 sm:w-4 sm:h-4 rounded status-good"></div>
+  851                             <span>Good (60-79%)</span>
+  852                         </div>
+  853                         <div class="flex items-center space-x-1 sm:space-x-2">
+  854                             <div class="w-3 h-3 sm:w-4 sm:h-4 rounded status-average"></div>
+  855                             <span>Average (40-59%)</span>
+  856                         </div>
+  857                         <div class="flex items-center space-x-1 sm:space-x-2">
+  858                             <div class="w-3 h-3 sm:w-4 sm:h-4 rounded status-weak"></div>
+  859                             <span>Weak (0-39%)</span>
+  860                         </div>
+  861                         <div class="flex items-center space-x-1 sm:space-x-2">
+  862                             <div class="w-3 h-3 sm:w-4 sm:h-4 rounded status-unstarted"></div>
+  863                             <span>Not Started</span>
+  864                         </div>
+  865                     </div>
+  866                 </div>
+  867                 <div id="analyticsHeatmap"></div>
+  868             </div>
+  869 
+  870             <!-- Charts -->
+  871             <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
+  872                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  873                     <h3 class="headline-6 font-semibold mb-4 text-base sm:text-lg text-neutral-800 dark:text-white">ðŸ“ˆ Progress Trend</h3>
+  874                     <div class="chart-container">
+  875                         <canvas id="analyticsTrendChart"></canvas>
+  876                     </div>
+  877                 </div>
+  878                 
+  879                 <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  880                     <h3 class="headline-6 font-semibold mb-4 text-base sm:text-lg text-neutral-800 dark:text-white">ðŸŽ¯ Subject Performance</h3>
+  881                     <div class="chart-container">
+  882                         <canvas id="analyticsSubjectChart"></canvas>
+  883                     </div>
+  884                 </div>
+  885             </div>
+  886 
+  887             <!-- Recommendations -->
+  888             <div class="material-card bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded-xl p-4 sm:p-6 shadow-material-2">
+  889                 <h2 class="headline-6 font-semibold mb-4 sm:mb-6 text-lg sm:text-xl text-neutral-800 dark:text-white">Smart Recommendations</h2>
+  890                 <div id="analyticsRecommendations" class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
+  891                     <!-- Recommendations will be populated here -->
+  892                 </div>
+  893             </div>
+  894         </div>
+  895     </main>
+  896 
+  897 
+  898 
+  899 
+  900     <!-- Loading Modal -->
+  901     <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
+  902         <div class="material-card bg-white dark:bg-neutral-800 p-6 rounded-xl shadow-material-4 max-w-sm w-full mx-4">
+  903             <div class="flex items-center justify-center space-x-3">
+  904                 <div class="spinner"></div>
+  905                 <span class="body-1 text-neutral-800 dark:text-white">Loading questions...</span>
+  906             </div>
+  907         </div>
+  908     </div>
+  909 
+  910     <script>
+  911         // Dark mode support
+  912         if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
+  913             document.documentElement.classList.add('dark');
+  914         }
+  915         window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
+  916             if (event.matches) {
+  917                 document.documentElement.classList.add('dark');
+  918             } else {
+  919                 document.documentElement.classList.remove('dark');
+  920             }
+  921         });
+  922 
+  923 
+  924         // App State
+  925         let currentView = 'subjects';
+  926         //On loading we want to view the subject page. This variable holds and tracks which page to display. We
+  927         //We also have topics, quiz and result page.
+  928         let subjects = {};
+  929         let currentSubject = null;
+  930         let currentTopic = null;
+  931         let currentQuestions = [];
+  932         let currentQuestionIndex = 0;
+  933         let userAnswers = [];
+  934         let quizStartTime = null;
+  935 
+  936         
+  937         // Analytics data
+  938         let analyticsData = {
+  939             quizResults: [],
+  940             topicProgress: {},
+  941             subjectProgress: {},
+  942             timeSpent: {}
+  943         };
+  944 
+  945         // Swipe gesture state
+  946         let touchStartX = 0;
+  947         let touchStartY = 0;
+  948         let touchEndX = 0;
+  949         let touchEndY = 0;
+  950         let lastTapTime = 0;
+  951         const DOUBLE_TAP_DELAY = 300; // milliseconds
+  952         const MIN_SWIPE_DISTANCE = 50; // minimum distance for swipe to be recognized
+  953 
+  954 
+  955         // Using Material Icons for consistency with your topic icons:
+  956         const availableSubjects = [
+  957             { id: 'mathematics',
+  958             name: 'Mathematics', 
+  959             icon: 'calculate', 
+  960             file: 'data/mathematics.json' },
+  961 
+  962             { id: 'physics', 
+  963             name: 'Physics', 
+  964             icon: 'science', 
+  965             file: 'data/physics.json' },
+  966 
+  967             { id: 'chemistry', name: 'Chemistry', icon: 'science', file: 'data/chemistry.json' },
+  968             { id: 'biology', name: 'Biology', icon: 'biotech', file: 'data/biology.json' },
+  969             { id: 'english', name: 'English', icon: 'translate', file: 'data/english.json' },
+  970             { id: 'economics', name: 'Economics', icon: 'trending_up', file: 'data/economics.json' },
+  971             { id: 'accounting', name: 'Accounting', icon: 'receipt_long', file: 'data/accounting.json' },
+  972            // { id: 'agriculture', name: 'Agriculture', icon: 'agriculture', file: 'data/agriculture.json' },
+  973         //{ id: 'art', name: 'Art', icon: 'palette', file: 'data/art.json' },
+  974             { id: 'commerce', name: 'Commerce', icon: 'store', file: 'data/commerce.json' },
+  975             { id: 'computer', name: 'Computer', icon: 'computer', file: 'data/computer.json' },
+  976             { id: 'crs', name: 'CRS', icon: 'church', file: 'data/crs.json' },
+  977         //    { id: 'geography', name: 'Geography', icon: 'map', file: 'data/geography.json' },
+  978             { id: 'government', name: 'Government', icon: 'account_balance', file: 'data/government.json' },
+  979         //  { id: 'history', name: 'History', icon: 'history', file: 'data/history.json' },
+  980         //    { id: 'home-economics', name: 'Home Economics', icon: 'restaurant_menu', file: 'data/home-economics.json' },
+  981             { id: 'islamic-studies', name: 'Islamic Studies', icon: 'mosque', file: 'data/irs.json' },
+  982             { id: 'literature', name: 'Literature', icon: 'menu_book', file: 'data/literature.json' },
+  983           //  { id: 'phe', name: 'PHE', icon: 'fitness_center', file: 'data/phe.json' },
+  984         //{ id: 'music', name: 'Music', icon: 'music_note', file: 'data/music.json' },
+  985         ];
+  986         
+  987 
+  988         // DOM Elements
+  989         const subjectSelection = document.getElementById('subjectSelection');
+  990         const topicSelection = document.getElementById('topicSelection');
+  991         const quizInterface = document.getElementById('quizInterface');
+  992         const progressInterface = document.getElementById('progressInterface');
+  993        
+  994         const tutorInterface = document.getElementById('tutorInterface');
+  995         const analyticsInterface = document.getElementById('analyticsInterface');
+  996         const loadingModal = document.getElementById('loadingModal');
+  997 
+  998 
+  999         // Mobile menu elements
+ 1000         const mobileMenuBtn = document.getElementById('mobileMenuBtn');
+ 1001         const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
+ 1002         const mobileMenu = document.getElementById('mobileMenu');
+ 1003         const closeMobileMenu = document.getElementById('closeMobileMenu');
+ 1004         const mobileMenuIcon = document.getElementById('mobileMenuIcon');
+ 1005 
+ 1006         // Mobile menu functionality
+ 1007         function toggleMobileMenu() {
+ 1008             const isOpen = mobileMenuOverlay.classList.contains('open');
+ 1009             
+ 1010             if (isOpen) {
+ 1011                 closeMobileMenuFunc();
+ 1012             } else {
+ 1013                 openMobileMenuFunc();
+ 1014             }
+ 1015         }
+ 1016 
+ 1017         function openMobileMenuFunc() {
+ 1018             mobileMenuOverlay.classList.add('open');
+ 1019             mobileMenu.classList.add('open');
+ 1020             mobileMenuIcon.textContent = 'close';
+ 1021             document.body.style.overflow = 'hidden'; // Prevent background scrolling
+ 1022         }
+ 1023 
+ 1024         function closeMobileMenuFunc() {
+ 1025             mobileMenuOverlay.classList.remove('open');
+ 1026             mobileMenu.classList.remove('open');
+ 1027             mobileMenuIcon.textContent = 'menu';
+ 1028             document.body.style.overflow = ''; // Restore scrolling
+ 1029         }
+ 1030 
+ 1031 
+ 1032         // Topic icon mapping function
+ 1033         function getTopicIcon(topicName, category) {
+ 1034                 const name = topicName.toLowerCase();
+ 1035                 const cat = category.toLowerCase();
+ 1036     
+ 1037             // Mathematics topics
+ 1038             if (cat.includes('algebra') || name.includes('algebra')) 
+ 1039                 return 'functions';
+ 1040             if (cat.includes('geometry') || name.includes('geometry')) 
+ 1041                 return 'crop_free';
+ 1042             if (cat.includes('trigonometry') || name.includes('trigonometry')) 
+ 1043                 return 'change_history';
+ 1044             if (cat.includes('calculus') || name.includes('calculus')) 
+ 1045                 return 'show_chart';
+ 1046             if (cat.includes('statistics') || name.includes('statistic')) return 
+ 1047                 'bar_chart';
+ 1048             if (cat.includes('probability') || name.includes('probability')) 
+ 1049                 return 'casino';
+ 1050             if (name.includes('number') || name.includes('arithmetic')) 
+ 1051                 return 'pin';
+ 1052             
+ 1053 
+ 1054             // Physics topics  
+ 1055             if (name.includes('motion')) return 'sports_motorsports';
+ 1056             if (name.includes('force') || name.includes('newton')) 
+ 1057             return 'fitness_center';
+ 1058             if (name.includes('energy')) 
+ 1059             return 'bolt';
+ 1060             if (name.includes('wave') || name.includes('sound')) 
+ 1061             return 'graphic_eq';
+ 1062             if (name.includes('electric') || name.includes('magnetic')) 
+ 1063             return 'electric_bolt';
+ 1064             if (name.includes('light') || name.includes('optic')) 
+ 1065             return 'highlight';
+ 1066             if (name.includes('thermal') || name.includes('heat')) 
+ 1067             return 'whatshot';
+ 1068             if (name.includes('quantum') || name.includes('atomic')) 
+ 1069             return 'scatter_plot';
+ 1070             
+ 1071             // Chemistry topics
+ 1072             if (name.includes('atom') || name.includes('periodic')) return 'blur_on';
+ 1073             if (name.includes('bond') || name.includes('molecular')) return 'link';
+ 1074             if (name.includes('reaction') || name.includes('equation')) return 'shuffle';
+ 1075             if (name.includes('acid') || name.includes('base') || name.includes('ph')) return 'science';
+ 1076             if (name.includes('organic')) return 'eco';
+ 1077             if (name.includes('solution') || name.includes('concentration')) return 'opacity';
+ 1078             if (name.includes('gas') || name.includes('pressure')) return 'air';
+ 1079             
+ 1080             // Biology topics
+ 1081             if (name.includes('cell') || name.includes('cellular')) return 'grain';
+ 1082             if (name.includes('dna') || name.includes('genetic')) return 'memory';
+ 1083             if (name.includes('evolution') || name.includes('natural selection')) return 'trending_up';
+ 1084             if (name.includes('ecosystem') || name.includes('environment')) return 'nature';
+ 1085             if (name.includes('photosynthesis') || name.includes('plant')) return 'local_florist';
+ 1086             if (name.includes('respiration') || name.includes('breathing')) return 'air';
+ 1087             if (name.includes('reproduction') || name.includes('development')) return 'child_friendly';
+ 1088             if (name.includes('anatomy') || name.includes('physiology')) return 'accessibility';
+ 1089             
+ 1090             // English topics
+ 1091             if (name.includes('grammar') || name.includes('syntax')) return 'spellcheck';
+ 1092             if (name.includes('literature') || name.includes('poem') || name.includes('poetry')) return 'auto_stories';
+ 1093             if (name.includes('writing') || name.includes('essay')) return 'edit';
+ 1094             if (name.includes('reading') || name.includes('comprehension')) return 'chrome_reader_mode';
+ 1095             if (name.includes('vocabulary') || name.includes('word')) return 'translate';
+ 1096             if (name.includes('shakespeare') || name.includes('drama')) return 'theater_comedy';
+ 1097             if (name.includes('novel') || name.includes('fiction')) return 'menu_book';
+ 1098             
+ 1099             // ECONOMICS TOPICS
+ 1100             if (name.includes('economics as a science') || name.includes('economic science')) return 'science';
+ 1101             if (name.includes('economic system')) return 'account_balance';
+ 1102             if (name.includes('economic analysis') || name.includes('methods') || name.includes('tools')) return 'analytics';
+ 1103             if (name.includes('demand')) return 'trending_down';
+ 1104             if (name.includes('consumer') || name.includes('behaviour')) return 'psychology';
+ 1105             if (name.includes('supply')) return 'trending_up';
+ 1106             if (name.includes('price') || name.includes('determination')) return 'attach_money';
+ 1107             if (name.includes('production')) return 'factory';
+ 1108             if (name.includes('cost') || name.includes('revenue')) return 'account_balance_wallet';
+ 1109             if (name.includes('market structure')) return 'store';
+ 1110             if (name.includes('national income')) return 'public';
+ 1111             if (name.includes('money') || name.includes('inflation')) return 'currency_exchange';
+ 1112             if (name.includes('financial institution')) return 'account_balance';
+ 1113             if (name.includes('public finance')) return 'receipt_long';
+ 1114             if (name.includes('economic growth') || name.includes('development')) return 'trending_up';
+ 1115             if (name.includes('agriculture') || name.includes('agricultural')) return 'agriculture';
+ 1116             if (name.includes('industry') || name.includes('industrialization')) return 'business_center';
+ 1117             if (name.includes('natural resource')) return 'landscape';
+ 1118             if (name.includes('business organization')) return 'corporate_fare';
+ 1119             if (name.includes('population')) return 'groups';
+ 1120             if (name.includes('international trade')) return 'flight';
+ 1121             if (name.includes('international economic') || name.includes('economic organization')) return 'language';
+ 1122             if (name.includes('factors of production')) return 'build';
+ 1123             
+ 1124             // ACCOUNTING TOPICS
+ 1125             if (name.includes('accounting') || name.includes('bookkeeping')) return 'receipt_long';
+ 1126             if (name.includes('balance sheet') || name.includes('financial statement')) return 'summarize';
+ 1127             if (name.includes('ledger') || name.includes('journal')) return 'library_books';
+ 1128             if (name.includes('debit') || name.includes('credit')) return 'swap_horiz';
+ 1129             if (name.includes('audit') || name.includes('auditing')) return 'search';
+ 1130             if (name.includes('tax') || name.includes('taxation')) return 'request_quote';
+ 1131             if (name.includes('budget') || name.includes('budgeting')) return 'pie_chart';
+ 1132             if (name.includes('cash flow') || name.includes('cashflow')) return 'payments';
+ 1133             if (name.includes('asset') || name.includes('liability') || name.includes('equity')) return 'account_balance';
+ 1134             
+ 1135             // AGRICULTURE TOPICS
+ 1136             if (name.includes('crop') || name.includes('farming')) return 'grass';
+ 1137             if (name.includes('soil') || name.includes('soil science')) return 'terrain';
+ 1138             if (name.includes('livestock') || name.includes('animal husbandry')) return 'pets';
+ 1139             if (name.includes('irrigation') || name.includes('water management')) return 'water_drop';
+ 1140             if (name.includes('harvest') || name.includes('yield')) return 'agriculture';
+ 1141             if (name.includes('pest') || name.includes('disease control')) return 'bug_report';
+ 1142             if (name.includes('fertilizer') || name.includes('manure')) return 'eco';
+ 1143             if (name.includes('tractor') || name.includes('farm equipment')) return 'agriculture';
+ 1144             
+ 1145             // ART TOPICS
+ 1146             if (name.includes('drawing') || name.includes('sketch')) return 'draw';
+ 1147             if (name.includes('painting') || name.includes('paint')) return 'palette';
+ 1148             if (name.includes('sculpture') || name.includes('carving')) return 'style';
+ 1149             if (name.includes('color') || name.includes('colour theory')) return 'format_paint';
+ 1150             if (name.includes('perspective') || name.includes('composition')) return 'zoom_out_map';
+ 1151             if (name.includes('art history') || name.includes('art movement')) return 'history_edu';
+ 1152             if (name.includes('digital art') || name.includes('graphic design')) return 'computer';
+ 1153             
+ 1154             // COMMERCE TOPICS
+ 1155             if (name.includes('commerce') || name.includes('trade')) return 'store';
+ 1156             if (name.includes('marketing') || name.includes('advertising')) return 'campaign';
+ 1157             if (name.includes('business') || name.includes('enterprise')) return 'business_center';
+ 1158             if (name.includes('retail') || name.includes('wholesale')) return 'shopping_cart';
+ 1159             if (name.includes('import') || name.includes('export')) return 'flight';
+ 1160             if (name.includes('insurance') || name.includes('risk management')) return 'security';
+ 1161             if (name.includes('banking') || name.includes('finance')) return 'account_balance';
+ 1162             
+ 1163             // COMPUTER/ICT TOPICS
+ 1164             if (name.includes('programming') || name.includes('coding')) return 'code';
+ 1165             if (name.includes('database') || name.includes('sql')) return 'storage';
+ 1166             if (name.includes('network') || name.includes('internet')) return 'lan';
+ 1167             if (name.includes('hardware') || name.includes('computer parts')) return 'computer';
+ 1168             if (name.includes('software') || name.includes('application')) return 'apps';
+ 1169             if (name.includes('algorithm') || name.includes('data structure')) return 'device_hub';
+ 1170             if (name.includes('web') || name.includes('website')) return 'web';
+ 1171             if (name.includes('cybersecurity') || name.includes('security')) return 'lock';
+ 1172             
+ 1173             // CRS (CHRISTIAN RELIGIOUS STUDIES) TOPICS
+ 1174             if (name.includes('bible') || name.includes('scripture')) return 'menu_book';
+ 1175             if (name.includes('jesus') || name.includes('christ')) return 'person';
+ 1176             if (name.includes('parable') || name.includes('miracle')) return 'auto_stories';
+ 1177             if (name.includes('apostle') || name.includes('disciple')) return 'groups';
+ 1178             if (name.includes('church') || name.includes('worship')) return 'church';
+ 1179             if (name.includes('faith') || name.includes('belief')) return 'volunteer_activism';
+ 1180             if (name.includes('old testament') || name.includes('new testament')) return 'history_edu';
+ 1181             if (name.includes('prayer') || name.includes('meditation')) return 'hands';
+ 1182             
+ 1183             // GEOGRAPHY TOPICS
+ 1184             if (name.includes('map') || name.includes('cartography')) return 'map';
+ 1185             if (name.includes('climate') || name.includes('weather')) return 'wb_sunny';
+ 1186             if (name.includes('river') || name.includes('lake') || name.includes('ocean')) return 'water';
+ 1187             if (name.includes('mountain') || name.includes('hill') || name.includes('valley')) return 'landscape';
+ 1188             if (name.includes('population') || name.includes('demography')) return 'groups';
+ 1189             if (name.includes('urban') || name.includes('rural')) return 'location_city';
+ 1190             if (name.includes('resource') || name.includes('natural resource')) return 'forest';
+ 1191             if (name.includes('continent') || name.includes('country')) return 'public';
+ 1192             
+ 1193             // GOVERNMENT TOPICS
+ 1194             if (name.includes('constitution') || name.includes('law')) return 'gavel';
+ 1195             if (name.includes('democracy') || name.includes('election')) return 'how_to_vote';
+ 1196             if (name.includes('executive') || name.includes('legislative') || name.includes('judiciary')) return 'account_balance';
+ 1197             if (name.includes('citizenship') || name.includes('civic')) return 'person';
+ 1198             if (name.includes('political party') || name.includes('politics')) return 'groups';
+ 1199             if (name.includes('human right') || name.includes('rights')) return 'policy';
+ 1200             if (name.includes('public administration') || name.includes('bureaucracy')) return 'business_center';
+ 1201             
+ 1202             // HISTORY TOPICS
+ 1203             if (name.includes('ancient') || name.includes('medieval') || name.includes('modern')) return 'history';
+ 1204             if (name.includes('war') || name.includes('battle')) return 'military_tech';
+ 1205             if (name.includes('revolution') || name.includes('rebellion')) return 'change_circle';
+ 1206             if (name.includes('civilization') || name.includes('empire')) return 'public';
+ 1207             if (name.includes('archaeology') || name.includes('artifact')) return 'digging';
+ 1208             if (name.includes('timeline') || name.includes('chronology')) return 'schedule';
+ 1209             if (name.includes('biography') || name.includes('historical figure')) return 'person';
+ 1210             
+ 1211             // HOME ECONOMICS TOPICS
+ 1212             if (name.includes('cooking') || name.includes('culinary')) return 'restaurant_menu';
+ 1213             if (name.includes('sewing') || name.includes('tailoring')) return 'content_cut';
+ 1214             if (name.includes('nutrition') || name.includes('diet')) return 'nutrition';
+ 1215             if (name.includes('childcare') || name.includes('parenting')) return 'family_restroom';
+ 1216             if (name.includes('budget') || name.includes('home management')) return 'savings';
+ 1217             if (name.includes('textile') || name.includes('fabric')) return 'checkroom';
+ 1218             if (name.includes('hygiene') || name.includes('sanitation')) return 'clean_hands';
+ 1219             
+ 1220             // ISLAMIC STUDIES TOPICS
+ 1221             if (name.includes('quran') || name.includes('koran')) return 'menu_book';
+ 1222             if (name.includes('prophet') || name.includes('muhammad')) return 'person';
+ 1223             if (name.includes('prayer') || name.includes('salah')) return 'mosque';
+ 1224             if (name.includes('fasting') || name.includes('ramadan')) return 'nights_stay';
+ 1225             if (name.includes('islamic law') || name.includes('sharia')) return 'gavel';
+ 1226             if (name.includes('hadith') || name.includes('sunnah')) return 'auto_stories';
+ 1227             if (name.includes('islamic history') || name.includes('caliphate')) return 'history_edu';
+ 1228             
+ 1229             // LITERATURE TOPICS
+ 1230             if (name.includes('novel') || name.includes('fiction')) return 'menu_book';
+ 1231             if (name.includes('poetry') || name.includes('poem')) return 'format_quote';
+ 1232             if (name.includes('drama') || name.includes('play')) return 'theater_comedy';
+ 1233             if (name.includes('prose') || name.includes('short story')) return 'article';
+ 1234             if (name.includes('character') || name.includes('protagonist')) return 'person';
+ 1235             if (name.includes('theme') || name.includes('symbolism')) return 'lightbulb';
+ 1236             if (name.includes('literary criticism') || name.includes('analysis')) return 'analytics';
+ 1237             
+ 1238             // PHE (PHYSICAL AND HEALTH EDUCATION) TOPICS
+ 1239             if (name.includes('sports') || name.includes('athletics')) return 'sports';
+ 1240             if (name.includes('exercise') || name.includes('fitness')) return 'fitness_center';
+ 1241             if (name.includes('health') || name.includes('hygiene')) return 'healing';
+ 1242             if (name.includes('nutrition') || name.includes('diet')) return 'nutrition';
+ 1243             if (name.includes('first aid') || name.includes('safety')) return 'medical_services';
+ 1244             if (name.includes('game') || name.includes('recreation')) return 'sports_tennis';
+ 1245             if (name.includes('anatomy') || name.includes('physiology')) return 'accessibility';
+ 1246             
+ 1247             // MUSIC TOPICS
+ 1248             if (name.includes('music theory') || name.includes('notation')) return 'music_note';
+ 1249             if (name.includes('instrument') || name.includes('piano') || name.includes('guitar')) return 'piano';
+ 1250             if (name.includes('rhythm') || name.includes('beat')) return 'graphic_eq';
+ 1251             if (name.includes('composition') || name.includes('songwriting')) return 'create';
+ 1252             if (name.includes('voice') || name.includes('singing')) return 'mic';
+ 1253             if (name.includes('music history') || name.includes('composer')) return 'history_edu';
+ 1254             if (name.includes('performance') || name.includes('concert')) return 'live_tv';
+ 1255             
+ 1256             // Default icons by subject
+ 1257             if (cat.includes('math')) return 'calculate';
+ 1258             if (cat.includes('physics')) return 'science';
+ 1259             if (cat.includes('chemistry')) return 'science';
+ 1260             if (cat.includes('biology')) return 'biotech';
+ 1261             if (cat.includes('english')) return 'translate';
+ 1262             if (cat.includes('economic')) return 'trending_up';
+ 1263             if (cat.includes('accounting')) return 'receipt_long';
+ 1264             if (cat.includes('agriculture')) return 'agriculture';
+ 1265             if (cat.includes('art')) return 'palette';
+ 1266             if (cat.includes('commerce')) return 'store';
+ 1267             if (cat.includes('computer') || cat.includes('ict') || cat.includes('technology')) return 'computer';
+ 1268             if (cat.includes('crs') || cat.includes('christian') || cat.includes('religious')) return 'church';
+ 1269             if (cat.includes('geography')) return 'map';
+ 1270             if (cat.includes('government') || cat.includes('civic')) return 'account_balance';
+ 1271             if (cat.includes('history')) return 'history';
+ 1272             if (cat.includes('home-economic') || cat.includes('home economic')) return 'restaurant_menu';
+ 1273             if (cat.includes('islamic') || cat.includes('islamic studies')) return 'mosque';
+ 1274             if (cat.includes('literature')) return 'menu_book';
+ 1275             if (cat.includes('phe') || cat.includes('physical education') || cat.includes('health education')) return 'fitness_center';
+ 1276             if (cat.includes('music')) return 'music_note';
+ 1277             
+ 1278             // Ultimate fallback
+ 1279             return 'quiz';
+ 1280         }
+ 1281       
+ 1282 
+ 1283 // Analytics Storage Functions - Using localStorage as primary method
+ 1284         function saveAnalyticsData() {
+ 1285             try {
+ 1286                 const dataToSave = JSON.stringify(analyticsData);
+ 1287                 let savedSuccessfully = false;
+ 1288                 
+ 1289                 // Method 1: Try localStorage first (preferred)
+ 1290                 try {
+ 1291                     if (typeof(Storage) !== "undefined" && localStorage) {
+ 1292                         localStorage.setItem('ravenAnalytics', dataToSave);
+ 1293                         console.log('âœ… Data saved to localStorage');
+ 1294                         savedSuccessfully = true;
+ 1295                     }
+ 1296                 } catch (localStorageError) {
+ 1297                     console.warn('âš ï¸ localStorage not available:', localStorageError.message);
+ 1298                 }
+ 1299                 
+ 1300                 // Method 2: Try sessionStorage as fallback
+ 1301                 if (!savedSuccessfully) {
+ 1302                     try {
+ 1303                         if (typeof(Storage) !== "undefined" && sessionStorage) {
+ 1304                             sessionStorage.setItem('ravenAnalytics', dataToSave);
+ 1305                             console.log('ðŸ“‹ Data saved to sessionStorage (fallback)');
+ 1306                             savedSuccessfully = true;
+ 1307                         }
+ 1308                     } catch (sessionStorageError) {
+ 1309                         console.warn('âš ï¸ sessionStorage not available:', sessionStorageError.message);
+ 1310                     }
+ 1311                 }
+ 1312                 
+ 1313                 // Method 3: Cookie fallback
+ 1314                 if (!savedSuccessfully) {
+ 1315                     try {
+ 1316                         document.cookie = `ravenAnalytics=${encodeURIComponent(dataToSave)}; path=/; max-age=31536000; SameSite=Lax`;
+ 1317                         console.log('ðŸª Data saved to cookies (fallback)');
+ 1318                         savedSuccessfully = true;
+ 1319                     } catch (cookieError) {
+ 1320                         console.warn('âš ï¸ Cookie storage failed:', cookieError.message);
+ 1321                     }
+ 1322                 }
+ 1323                 
+ 1324                 // Method 4: Window object as last resort
+ 1325                 window.ravenAnalyticsBackup = analyticsData;
+ 1326                 
+ 1327                 if (savedSuccessfully) {
+ 1328                     console.log('ðŸ“Š Current quiz count:', analyticsData.quizResults.length);
+ 1329                     console.log('ðŸ“ˆ Topics tracked:', Object.keys(analyticsData.topicProgress).length);
+ 1330                     
+ 1331                     // Test localStorage availability explicitly
+ 1332                     testLocalStorageAvailability();
+ 1333                 }
+ 1334                 
+ 1335                 return savedSuccessfully;
+ 1336             } catch (error) {
+ 1337                 console.error('âŒ Failed to save analytics data:', error);
+ 1338                 return false;
+ 1339             }
+ 1340         }
+ 1341 
+ 1342 
+ 1343         function loadAnalyticsData() {
+ 1344             try {
+ 1345                 console.log('ðŸ”„ Loading analytics data...');
+ 1346                 let loadedData = null;
+ 1347                 
+ 1348                 // Method 1: Try localStorage first
+ 1349                 try {
+ 1350                     if (typeof(Storage) !== "undefined" && localStorage) {
+ 1351                         const data = localStorage.getItem('ravenAnalytics');
+ 1352                         if (data) {
+ 1353                             loadedData = JSON.parse(data);
+ 1354                             console.log('âœ… Data loaded from localStorage');
+ 1355                         }
+ 1356                     }
+ 1357                 } catch (localStorageError) {
+ 1358                     console.warn('âš ï¸ Failed to load from localStorage:', localStorageError.message);
+ 1359                 }
+ 1360                 
+ 1361                 // Method 2: Try sessionStorage if localStorage failed
+ 1362                 if (!loadedData) {
+ 1363                     try {
+ 1364                         if (typeof(Storage) !== "undefined" && sessionStorage) {
+ 1365                             const data = sessionStorage.getItem('ravenAnalytics');
+ 1366                             if (data) {
+ 1367                                 loadedData = JSON.parse(data);
+ 1368                                 console.log('ðŸ“‹ Data loaded from sessionStorage');
+ 1369                             }
+ 1370                         }
+ 1371                     } catch (sessionStorageError) {
+ 1372                         console.warn('âš ï¸ Failed to load from sessionStorage:', sessionStorageError.message);
+ 1373                     }
+ 1374                 }
+ 1375                 
+ 1376                 // Method 3: Try cookies if storage APIs failed
+ 1377                 if (!loadedData) {
+ 1378                     loadedData = tryLoadFromCookie('ravenAnalytics');
+ 1379                     if (loadedData) {
+ 1380                         console.log('ðŸª Data loaded from cookies');
+ 1381                     }
+ 1382                 }
+ 1383                 
+ 1384                 // Method 4: Try window backup
+ 1385                 if (!loadedData && window.ravenAnalyticsBackup) {
+ 1386                     loadedData = window.ravenAnalyticsBackup;
+ 1387                     console.log('ðŸ’¾ Data loaded from window backup');
+ 1388                 }
+ 1389                 
+ 1390                 if (loadedData && validateAnalyticsData(loadedData)) {
+ 1391                     analyticsData = loadedData;
+ 1392                     console.log('ðŸ“Š Loaded quiz count:', analyticsData.quizResults.length);
+ 1393                     console.log('ðŸ“ˆ Loaded topics:', Object.keys(analyticsData.topicProgress).length);
+ 1394                     return true;
+ 1395                 }
+ 1396                 
+ 1397                 throw new Error('No valid data found');
+ 1398                 
+ 1399             } catch (error) {
+ 1400                 console.log('âš ï¸ Initializing with empty analytics data:', error.message);
+ 1401                 analyticsData = {
+ 1402                     quizResults: [],
+ 1403                     topicProgress: {},
+ 1404                     subjectProgress: {},
+ 1405                     timeSpent: {}
+ 1406                 };
+ 1407                 return false;
+ 1408             }
+ 1409         }
+ 1410 
+ 1411 
+ 1412         function tryLoadFromCookie(cookieName) {
+ 1413             try {
+ 1414                 const cookies = document.cookie.split(';').map(cookie => cookie.trim());
+ 1415                 const targetCookie = cookies.find(cookie => cookie.startsWith(cookieName + '='));
+ 1416                 
+ 1417                 if (targetCookie) {
+ 1418                     const encodedData = targetCookie.split('=')[1];
+ 1419                     const decodedData = decodeURIComponent(encodedData);
+ 1420                     return JSON.parse(decodedData);
+ 1421                 }
+ 1422                 return null;
+ 1423             } catch (error) {
+ 1424                 console.warn(`Failed to load from ${cookieName}:`, error);
+ 1425                 return null;
+ 1426             }
+ 1427         }
+ 1428 
+ 1429         function testLocalStorageAvailability() {
+ 1430             try {
+ 1431                 if (typeof(Storage) !== "undefined") {
+ 1432                     // Test if localStorage is actually working
+ 1433                     const testKey = 'ravenTest_' + Date.now();
+ 1434                     localStorage.setItem(testKey, 'test');
+ 1435                     const retrieved = localStorage.getItem(testKey);
+ 1436                     localStorage.removeItem(testKey);
+ 1437                     
+ 1438                     if (retrieved === 'test') {
+ 1439                         console.log('âœ… localStorage is working properly');
+ 1440                         return true;
+ 1441                     } else {
+ 1442                         console.warn('âš ï¸ localStorage test failed - data not retrieved correctly');
+ 1443                         return false;
+ 1444                     }
+ 1445                 } else {
+ 1446                     console.warn('âš ï¸ Web Storage not supported');
+ 1447                     return false;
+ 1448                 }
+ 1449             } catch (error) {
+ 1450                 console.warn('âš ï¸ localStorage test error:', error.message);
+ 1451                 return false;
+ 1452             }
+ 1453         }
+ 1454 
+ 1455         // Function to manually clear stored data (for debugging)
+ 1456         function clearStoredData() {
+ 1457             try {
+ 1458                 if (localStorage) localStorage.removeItem('ravenAnalytics');
+ 1459                 if (sessionStorage) sessionStorage.removeItem('ravenAnalytics');
+ 1460                 document.cookie = 'ravenAnalytics=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
+ 1461                 window.ravenAnalyticsBackup = undefined;
+ 1462                 console.log('ðŸ—‘ï¸ All stored data cleared');
+ 1463             } catch (error) {
+ 1464                 console.error('Failed to clear data:', error);
+ 1465             }
+ 1466         }
+ 1467 
+ 1468         function validateAnalyticsData(data) {
+ 1469             return data && 
+ 1470                    typeof data === 'object' && 
+ 1471                    Array.isArray(data.quizResults) &&
+ 1472                    typeof data.topicProgress === 'object' &&
+ 1473                    typeof data.subjectProgress === 'object';
+ 1474         }
+ 1475 
+ 1476         // Function to refresh all views that show progress data
+ 1477         function refreshAllProgressViews() {
+ 1478             // Update analytics if currently viewing
+ 1479             if (currentView === 'analytics') {
+ 1480                 renderAnalytics();
+ 1481             }
+ 1482             
+ 1483             // Update progress if currently viewing
+ 1484             if (currentView === 'progress') {
+ 1485                 renderProgress();
+ 1486             }
+ 1487             
+ 1488             // Always refresh the subject selection to show updated progress
+ 1489             renderSubjects();
+ 1490             
+ 1491             // If currently viewing topics, refresh those too
+ 1492             if (currentView === 'topics' && currentSubject && subjects[currentSubject.id]) {
+ 1493                 renderTopics(subjects[currentSubject.id].topics);
+ 1494             }
+ 1495         }
+ 1496 
+ 1497         function saveQuizResult(score) {
+ 1498             const result = {
+ 1499                 id: Date.now(),
+ 1500                 subject: currentSubject.id,
+ 1501                 subjectName: currentSubject.name,
+ 1502                 topic: currentTopic.name,
+ 1503                 score: score.percentage,
+ 1504                 correct: score.correct,
+ 1505                 total: score.total,
+ 1506                 timeSpent: score.timeSpent,
+ 1507                 date: new Date().toISOString(),
+ 1508                 questions: currentQuestions.length
+ 1509             };
+ 1510 
+ 1511             analyticsData.quizResults.push(result);
+ 1512 
+ 1513             // Update topic progress - Fixed averaging calculation
+ 1514             const topicKey = `${currentSubject.id}_${currentTopic.name}`;
+ 1515             if (!analyticsData.topicProgress[topicKey]) {
+ 1516                 analyticsData.topicProgress[topicKey] = {
+ 1517                     bestScore: 0,
+ 1518                     attempts: 0,
+ 1519                     averageScore: 0,
+ 1520                     totalScore: 0,
+ 1521                     averageTime: 0,
+ 1522                     totalTime: 0
+ 1523                 };
+ 1524             }
+ 1525 
+ 1526             const topicProgress = analyticsData.topicProgress[topicKey];
+ 1527             topicProgress.attempts++;
+ 1528             topicProgress.totalScore += score.percentage;
+ 1529             topicProgress.averageScore = Math.round(topicProgress.totalScore / topicProgress.attempts * 100) / 100; // Fixed rounding
+ 1530             topicProgress.bestScore = Math.max(topicProgress.bestScore, score.percentage);
+ 1531             topicProgress.totalTime += score.timeSpent;
+ 1532             topicProgress.averageTime = topicProgress.totalTime / topicProgress.attempts;
+ 1533 
+ 1534             // Update subject progress - Fixed averaging calculation
+ 1535             if (!analyticsData.subjectProgress[currentSubject.id]) {
+ 1536                 analyticsData.subjectProgress[currentSubject.id] = {
+ 1537                     bestScore: 0,
+ 1538                     attempts: 0,
+ 1539                     averageScore: 0,
+ 1540                     totalScore: 0
+ 1541                 };
+ 1542             }
+ 1543 
+ 1544             const subjectProgress = analyticsData.subjectProgress[currentSubject.id];
+ 1545             subjectProgress.attempts++;
+ 1546             subjectProgress.totalScore += score.percentage;
+ 1547             subjectProgress.averageScore = Math.round(subjectProgress.totalScore / subjectProgress.attempts * 100) / 100; // Fixed rounding
+ 1548             subjectProgress.bestScore = Math.max(subjectProgress.bestScore, score.percentage);
+ 1549 
+ 1550             // Save data with improved method
+ 1551             const saveSuccess = saveAnalyticsData();
+ 1552             if (saveSuccess) {
+ 1553                 console.log('âœ… Quiz result saved and persisted');
+ 1554             } else {
+ 1555                 console.warn('âš ï¸ Quiz result saved but persistence may have failed');
+ 1556             }
+ 1557             
+ 1558             // Always refresh all views that might show progress data
+ 1559             refreshAllProgressViews();
+ 1560 
+ 1561             // Debug logging
+ 1562             console.log(`ðŸŽ¯ Quiz completed: ${score.percentage}%`);
+ 1563             console.log(`ðŸ“š Topic progress for ${topicKey}:`, topicProgress);
+ 1564         }
+ 1565 
+ 1566         function getTopicProgress(subjectId, topicName) {
+ 1567             const topicKey = `${subjectId}_${topicName}`;
+ 1568             return analyticsData.topicProgress[topicKey] || {
+ 1569                 bestScore: 0,
+ 1570                 attempts: 0,
+ 1571                 averageScore: 0,
+ 1572                 averageTime: 0
+ 1573             };
+ 1574         }
+ 1575 
+ 1576         // Function to get progress bar color based on score
+ 1577         function getProgressBarColor(score) {
+ 1578             if (score >= 80) return 'linear-gradient(90deg, #10B981, #059669)'; // Green - Excellent
+ 1579             if (score >= 60) return 'linear-gradient(90deg, #3B82F6, #1D4ED8)'; // Blue - Good  
+ 1580             if (score >= 40) return 'linear-gradient(90deg, #F59E0B, #D97706)'; // Yellow - Average
+ 1581             return 'linear-gradient(90deg, #EF4444, #DC2626)'; // Red - Weak
+ 1582         }
+ 1583 
+ 1584 
+ 1585         // Initialize the app
+ 1586         async function init() {
+ 1587             console.log('ðŸš€ Initializing Raven Learning Platform...');
+ 1588             loadAnalyticsData();
+ 1589             renderSubjects();
+ 1590             setupEventListeners();
+ 1591             loadProgress();
+ 1592             setupSwipeGestures();
+ 1593             console.log('âœ… App initialized successfully');
+ 1594         }
+ 1595 
+ 1596         // Render subjects
+ 1597         function renderSubjects() {
+ 1598             const subjectGrid = document.getElementById('subjectGrid');
+ 1599             subjectGrid.innerHTML = '';
+ 1600 
+ 1601                     const subjectIcons = {
+ 1602                         'english': 'auto_stories',            // Storytelling and literature
+ 1603                         'mathematics': 'functions',           // Math functions and operations
+ 1604                         'physics': 'bolt',                    // Electricity and energy
+ 1605                         'chemistry': 'science',               // Science experiments
+ 1606                         'biology': 'psychology',              // Brain and life sciences
+ 1607                         'computer': 'code',                   // Programming and coding
+ 1608                         'agriculture': 'grass',               // Farming and crops
+ 1609                         'accounting': 'summarize',            // Financial summaries
+ 1610                         'commerce': 'business_center',        // Business and trade
+ 1611                         'economics': 'show_chart',            // Data charts and trends
+ 1612                         'art': 'brush',                       // Painting and drawing
+ 1613                         'music': 'piano',                      // Musical instruments
+ 1614                         'literature': 'book',                 // Books and reading
+ 1615                         'crs': 'church',          // Faith and spirituality
+ 1616                         'islamic-studies': 'star',            // Islamic symbol
+ 1617                         'geography': 'public',                // Global studies
+ 1618                         'government': 'gavel',                // Law and justice
+ 1619                         'history': 'history_edu',             // Historical education
+ 1620                         'home-economics': 'home',        // Food and nutrition
+ 1621                         'phe': 'sports_gymnastics'           // Sports and gymnastics
+ 1622                     };
+ 1623 
+ 1624 
+ 1625                     const subjectColors = {
+ 1626                         'mathematics': 'from-data-500 to-data-600',           // #5A7B9E to #4d6a87
+ 1627                         'physics': 'from-warning to-warning/80',              // #f59e0b to #f59e0b/80
+ 1628                         'chemistry': 'from-primary-500 to-primary-600',       // #0F2C59 to #0a2549
+ 1629                         'biology': 'from-success to-success/80',              // #22c55e to #22c55e/80
+ 1630                         'english': 'from-accent-500 to-accent-600',           // #009F9D to #008280
+ 1631                         'economics': 'from-premium-500 to-premium-600',       // #D2C1A7 to #c4b095
+ 1632                         'accounting': 'from-data-500 to-data-700',            // #5A7B9E to #405970
+ 1633                         'agriculture': 'from-success to-success/80',         
+ 1634                         'art': 'from-accent-500 to-accent-700',               // #009F9D to #006663
+ 1635                         'commerce': 'from-primary-500 to-primary-700',        // #0F2C59 to #081e39
+ 1636                         'computer': 'from-data-500 to-data-600',              // #5A7B9E to #4d6a87
+ 1637                         'crs': 'from-premium-500 to-premium-700',             // #D2C1A7 to #b69f83
+ 1638                         'geography': 'from-accent-500 to-accent-600',         // #009F9D to #008280
+ 1639                         'government': 'from-primary-500 to-primary-600',      // #0F2C59 to #0a2549
+ 1640                         'history': 'from-premium-500 to-premium-600',         // #D2C1A7 to #c4b095
+ 1641                         'home-economics': 'from-premium-500 to-premium-600',      
+ 1642                         'islamic-studies': 'from-primary-500 to-primary-700', // #0F2C59 to #081e39
+ 1643                         'literature': 'from-accent-500 to-accent-700',        // #009F9D to #006663
+ 1644                         'phe': 'from-primary-500 to-primary-700',                 
+ 1645                         'music': 'from-premium-500 to-premium-700'            // #D2C1A7 to #b69f83
+ 1646                     };
+ 1647                     availableSubjects.forEach((subject, index) => {
+ 1648                         const subjectCard = document.createElement('div');
+ 1649                         subjectCard.className = `material-card stagger-animation material-button w-full flex items-center space-x-4 p-4 sm:p-6 border border-neutral-300 dark:border-neutral-600 text-neutral-700 dark:text-neutral-300 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-700 touch-target bg-white dark:bg-neutral-800 cursor-pointer`;
+ 1650                         
+ 1651                         const icon = subjectIcons[subject.id] || 'school';
+ 1652                         const color = subjectColors[subject.id] || 'bg-primary-500';
+ 1653                         
+ 1654                         // Get subject progress for display
+ 1655                         const subjectProgress = analyticsData.subjectProgress[subject.id];
+ 1656                         const progressText = subjectProgress ? `Avg: ${Math.round(subjectProgress.averageScore)}% | ${subjectProgress.attempts} attempts` : 'Not started';
+ 1657                         
+ 1658                         subjectCard.innerHTML = `
+ 1659                             <div class="w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br ${color} rounded-xl flex items-center justify-center shadow-material-1">
+ 1660                                 <span class="material-icons text-white">${icon}</span>
+ 1661                             </div>
+ 1662                             <div class="flex-1">
+ 1663                                 <div class="button-text text-neutral-800 dark:text-white mb-1">${subject.name}</div>
+ 1664                                 <div class="caption text-neutral-500 dark:text-neutral-400">${progressText}</div>
+ 1665                             </div>
+ 1666                             <span class="material-icons text-neutral-400">arrow_forward_ios</span>
+ 1667                         `;
+ 1668                         
+ 1669                         subjectCard.style.animationDelay = `${(index + 1) * 0.1}s`;
+ 1670                         subjectCard.addEventListener('click', () => selectSubject(subject));
+ 1671                         subjectGrid.appendChild(subjectCard);
+ 1672                     });
+ 1673                 }
+ 1674 
+ 1675 
+ 1676         // Select subject and load its data
+ 1677         async function selectSubject(subject) {
+ 1678             showLoading();
+ 1679             try {
+ 1680                 const response = await fetch(subject.file);
+ 1681                 if (!response.ok) {
+ 1682                     throw new Error(`Failed to load ${subject.name} data`);
+ 1683                 }
+ 1684                 const data = await response.json();
+ 1685                 subjects[subject.id] = data;
+ 1686                 currentSubject = subject;
+ 1687                 renderTopics(data.topics);
+ 1688                 showTopicSelection();
+ 1689             } catch (error) {
+ 1690                 showError(`Error loading ${subject.name}: ${error.message}`);
+ 1691             } finally {
+ 1692                 hideLoading();
+ 1693             }
+ 1694         }
+ 1695 
+ 1696 // Render topics for selected subject
+ 1697         function renderTopics(topics) {
+ 1698             const topicGrid = document.getElementById('topicGrid');
+ 1699             const selectedSubjectTitle = document.getElementById('selectedSubjectTitle');
+ 1700             
+ 1701             selectedSubjectTitle.textContent = currentSubject.name;
+ 1702             topicGrid.innerHTML = '';
+ 1703 
+ 1704             // High-contrast color schemes arranged for maximum visual differentiation
+ 1705             const colorSchemes = [
+ 1706                 { primary: 'from-blue-500 to-blue-600', accent: 'blue' },      // Cool
+ 1707                 { primary: 'from-orange-500 to-orange-600', accent: 'orange' }, // Warm
+ 1708                 { primary: 'from-green-500 to-green-600', accent: 'green' },    // Cool
+ 1709                 { primary: 'from-red-500 to-red-600', accent: 'red' },         // Warm
+ 1710                 { primary: 'from-purple-500 to-purple-600', accent: 'purple' }, // Cool
+ 1711                 { primary: 'from-amber-500 to-amber-600', accent: 'amber' },   // Warm
+ 1712                 { primary: 'from-teal-500 to-teal-600', accent: 'teal' },      // Cool
+ 1713                 { primary: 'from-pink-500 to-pink-600', accent: 'pink' },      // Warm
+ 1714                 { primary: 'from-indigo-500 to-indigo-600', accent: 'indigo' }, // Cool
+ 1715                 { primary: 'from-lime-500 to-lime-600', accent: 'lime' }       // Warm
+ 1716             ];
+ 1717 
+ 1718             // Group topics by category
+ 1719             const categories = {};
+ 1720             Object.entries(topics).forEach(([topicId, topic]) => {
+ 1721                 if (!categories[topic.category]) {
+ 1722                     categories[topic.category] = [];
+ 1723                 }
+ 1724                 categories[topic.category].push({ id: topicId, ...topic });
+ 1725             });
+ 1726 
+ 1727             // Get category names and assign high-contrast colors
+ 1728             const categoryNames = Object.keys(categories);
+ 1729             const categoryColors = {};
+ 1730             
+ 1731             categoryNames.forEach((category, index) => {
+ 1732                 // Use alternating pattern: cool, warm, cool, warm, etc.
+ 1733                 const colorIndex = index % 2 === 0 
+ 1734                     ? (index * 2) % colorSchemes.length  // Even indices: 0, 2, 4, 6, 8
+ 1735                     : (index * 2 + 1) % colorSchemes.length; // Odd indices: 1, 3, 5, 7, 9
+ 1736                 
+ 1737                 categoryColors[category] = colorSchemes[colorIndex];
+ 1738             });
+ 1739 
+ 1740             // Render each category
+ 1741             Object.entries(categories).forEach(([category, categoryTopics]) => {
+ 1742                 const colors = categoryColors[category];
+ 1743                 
+ 1744                 const categoryDiv = document.createElement('div');
+ 1745                 categoryDiv.className = 'col-span-full mt-8 mb-2';
+ 1746                 categoryDiv.innerHTML = `
+ 1747                     <div class="flex items-center space-x-3 mb-4">
+ 1748                         <div class="w-1 h-6 bg-gradient-to-b ${colors.primary} rounded-full"></div>
+ 1749                         <h3 class="text-xl font-semibold text-${colors.accent}-600 dark:text-${colors.accent}-400 font-roboto">${category}</h3>
+ 1750                         <div class="flex-1 h-px bg-gradient-to-r from-neutral-300 to-transparent dark:from-neutral-600"></div>
+ 1751                     </div>
+ 1752                 `;
+ 1753                 topicGrid.appendChild(categoryDiv);
+ 1754 
+ 1755                 categoryTopics.forEach((topic, index) => {
+ 1756                     const topicCard = document.createElement('div');
+ 1757                     const questionCount = topic.questions ? topic.questions.length : 0;
+ 1758                     const progressData = getTopicProgress(currentSubject.id, topic.name);
+ 1759                     
+ 1760                     topicCard.className = `material-card stagger-animation material-button w-full flex items-start space-x-4 p-5 sm:p-6 border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 rounded-2xl hover:border-${colors.accent}-300 dark:hover:border-${colors.accent}-400 hover:shadow-material-2 transition-all duration-300 bg-white dark:bg-neutral-800/50 backdrop-blur-sm ${questionCount > 0 ? 'cursor-pointer hover:scale-[1.02]' : 'opacity-60 cursor-not-allowed'}`;
+ 1761                     
+ 1762                     // Get appropriate icon for topic
+ 1763                     const topicIcon = getTopicIcon(topic.name, topic.category);
+ 1764                     
+ 1765                     topicCard.innerHTML = `
+ 1766                         <div class="flex-shrink-0 w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br ${colors.primary} rounded-xl flex items-center justify-center shadow-material-1 group-hover:shadow-material-2 transition-shadow duration-300 mt-1">
+ 1767                             <span class="material-icons text-white text-base sm:text-lg">${topicIcon}</span>
+ 1768                         </div>
+ 1769                         <div class="flex-1 min-w-0 overflow-hidden">
+ 1770                             <div class="button-text text-neutral-800 dark:text-white mb-1 font-roboto break-words whitespace-normal">${topic.name}</div>
+ 1771                             <div class="caption text-neutral-500 dark:text-neutral-400 mb-2 font-roboto">${questionCount} questions</div>
+ 1772                             ${progressData.attempts > 0 ? 
+ 1773                                 `<div class="space-y-2">
+ 1774                                     <div class="flex justify-between items-center text-xs font-roboto">
+ 1775                                         <span class="text-neutral-500 dark:text-neutral-400">Progress</span>
+ 1776                                         <span class="font-medium text-${colors.accent}-600 dark:text-${colors.accent}-400">${Math.round(progressData.averageScore)}%</span>
+ 1777                                     </div>
+ 1778                                     <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-1.5">
+ 1779                                         <div class="h-1.5 rounded-full transition-all duration-500 ease-out" style="width: ${progressData.averageScore}%; background: ${getProgressBarColor(progressData.averageScore)}"></div>
+ 1780                                     </div>
+ 1781                                     <div class="flex justify-between text-xs text-neutral-400 dark:text-neutral-500 font-roboto">
+ 1782                                         <span>Best: ${Math.round(progressData.bestScore)}%</span>
+ 1783                                         <span>Avg: ${Math.round(progressData.averageScore)}%</span>
+ 1784                                         <span>${progressData.attempts} attempts</span>
+ 1785                                     </div>
+ 1786                                 </div>` : 
+ 1787                                 `<div class="text-xs text-neutral-400 dark:text-neutral-500 italic font-roboto">Not attempted yet</div>`
+ 1788                             }
+ 1789                         </div>
+ 1790                         <span class="material-icons text-neutral-300 dark:text-neutral-500 group-hover:text-${colors.accent}-600 dark:group-hover:text-${colors.accent}-400 transition-colors duration-300 flex-shrink-0 mt-1 ${questionCount === 0 ? 'opacity-50' : ''}">arrow_forward_ios</span>
+ 1791                     `;
+ 1792                     
+ 1793                     topicCard.style.animationDelay = `${(index + 1) * 0.08}s`;
+ 1794                     
+ 1795                     if (questionCount > 0) {
+ 1796                         topicCard.addEventListener('click', () => startQuiz(topic));
+ 1797                         topicCard.title = `Start ${topic.name} quiz`;
+ 1798                         topicCard.classList.add('group');
+ 1799                     } else {
+ 1800                         topicCard.title = 'No questions available for this topic';
+ 1801                     }
+ 1802                     
+ 1803                     topicGrid.appendChild(topicCard);
+ 1804                 });
+ 1805             });
+ 1806         }
+ 1807 
+ 1808             
+ 1809 // Start quiz for selected topic
+ 1810         function startQuiz(topic) {
+ 1811             if (!topic.questions || topic.questions.length === 0) {
+ 1812                 showError('No questions available for this topic');
+ 1813                 return;
+ 1814             }
+ 1815 
+ 1816             currentTopic = topic;
+ 1817             currentQuestions = [...topic.questions];
+ 1818             currentQuestionIndex = 0;
+ 1819             userAnswers = [];
+ 1820             quizStartTime = Date.now();
+ 1821 
+ 1822             // Shuffle questions
+ 1823             currentQuestions = shuffleArray(currentQuestions);
+ 1824 
+ 1825             renderQuestion();
+ 1826             showQuizInterface();
+ 1827         }
+ 1828 
+ 1829         // Render current question with fixed option formatting
+ 1830         function renderQuestion() {
+ 1831             const question = currentQuestions[currentQuestionIndex];
+ 1832             if (!question) return;
+ 1833 
+ 1834             document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
+ 1835             document.getElementById('totalQuestions').textContent = currentQuestions.length;
+ 1836             document.getElementById('questionMeta').textContent = `${currentTopic.name} - ${currentTopic.category}`;
+ 1837             document.getElementById('questionText').textContent = question.question;
+ 1838 
+ 1839             // Update progress bar
+ 1840             const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
+ 1841             document.getElementById('progressFill').style.width = `${progress}%`;
+ 1842 
+ 1843             // Render options with proper formatting
+ 1844             const optionsContainer = document.getElementById('questionOptions');
+ 1845             optionsContainer.innerHTML = '';
+ 1846 
+ 1847             question.options.forEach((option, index) => {
+ 1848                 const optionBtn = document.createElement('div');
+ 1849                 optionBtn.className = 'option-btn material-button p-4 rounded-lg border-2 border-neutral-200 dark:border-neutral-600 bg-white dark:bg-neutral-800 text-neutral-800 dark:text-white cursor-pointer touch-target';
+ 1850                 optionBtn.innerHTML = `
+ 1851                     <div class="flex items-center space-x-3">
+ 1852                         <span class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center font-medium text-sm">${String.fromCharCode(65 + index)}</span>
+ 1853                         <span class="body-1 flex-1">${option}</span>
+ 1854                     </div>
+ 1855                 `;
+ 1856                 
+ 1857                 const isSelected = userAnswers[currentQuestionIndex] === index;
+ 1858                 if (isSelected) {
+ 1859                     optionBtn.classList.add('selected');
+ 1860                 }
+ 1861 
+ 1862                 optionBtn.addEventListener('click', () => selectOption(index));
+ 1863                 optionsContainer.appendChild(optionBtn);
+ 1864             });
+ 1865 
+ 1866             // Update button states
+ 1867             updateNavigationButtons();
+ 1868             
+ 1869             // Hide explanation
+ 1870             document.getElementById('explanationBox').classList.add('hidden');
+ 1871         }
+ 1872 
+ 1873         // Select an option
+ 1874         function selectOption(optionIndex) {
+ 1875             userAnswers[currentQuestionIndex] = optionIndex;
+ 1876             
+ 1877             // Update option styles
+ 1878             const options = document.querySelectorAll('.option-btn');
+ 1879             options.forEach((option, index) => {
+ 1880                 option.classList.remove('selected');
+ 1881                 if (index === optionIndex) {
+ 1882                     option.classList.add('selected');
+ 1883                 }
+ 1884             });
+ 1885 
+ 1886             updateNavigationButtons();
+ 1887         }
+ 1888 
+ 1889         // Update navigation button states
+ 1890         function updateNavigationButtons() {
+ 1891             const prevBtn = document.getElementById('prevBtn');
+ 1892             const nextBtn = document.getElementById('nextBtn');
+ 1893             const explainBtn = document.getElementById('explainBtn');
+ 1894 
+ 1895             prevBtn.disabled = currentQuestionIndex === 0;
+ 1896             nextBtn.disabled = userAnswers[currentQuestionIndex] === undefined;
+ 1897             explainBtn.disabled = userAnswers[currentQuestionIndex] === undefined;
+ 1898 
+ 1899             if (currentQuestionIndex === currentQuestions.length - 1) {
+ 1900                 nextBtn.textContent = 'Finish Quiz';
+ 1901             } else {
+ 1902                 nextBtn.textContent = 'Next';
+ 1903             }
+ 1904         }
+ 1905 
+ 1906         // Navigate to previous question
+ 1907         function previousQuestion() {
+ 1908             if (currentQuestionIndex > 0) {
+ 1909                 currentQuestionIndex--;
+ 1910                 renderQuestion();
+ 1911             }
+ 1912         }
+ 1913 
+ 1914         // Navigate to next question or finish quiz
+ 1915         function nextQuestion() {
+ 1916             if (currentQuestionIndex < currentQuestions.length - 1) {
+ 1917                 currentQuestionIndex++;
+ 1918                 renderQuestion();
+ 1919             } else {
+ 1920                 finishQuiz();
+ 1921             }
+ 1922         }
+ 1923 
+ 1924         // Show explanation for current question
+ 1925         function showExplanation() {
+ 1926             const question = currentQuestions[currentQuestionIndex];
+ 1927             const explanationBox = document.getElementById('explanationBox');
+ 1928             const explanationText = document.getElementById('explanationText');
+ 1929 
+ 1930             if (question.explanation) {
+ 1931                 explanationText.textContent = question.explanation;
+ 1932                 explanationBox.classList.remove('hidden');
+ 1933 
+ 1934                 // Show correct/incorrect for all options
+ 1935                 const options = document.querySelectorAll('.option-btn');
+ 1936                 const correctIndex = question.answer.charCodeAt(0) - 97; // Convert 'a', 'b', 'c' to 0, 1, 2
+ 1937                 const userIndex = userAnswers[currentQuestionIndex];
+ 1938 
+ 1939                 options.forEach((option, index) => {
+ 1940                     option.classList.remove('selected');
+ 1941                     if (index === correctIndex) {
+ 1942                         option.classList.add('correct');
+ 1943                     } else if (index === userIndex && index !== correctIndex) {
+ 1944                         option.classList.add('incorrect');
+ 1945                     }
+ 1946                 });
+ 1947             }
+ 1948         }
+ 1949 
+ 1950 
+ 1951         // Finish quiz and show results
+ 1952         function finishQuiz() {
+ 1953             const score = calculateScore();
+ 1954             saveQuizResult(score);
+ 1955             showQuizResults(score);
+ 1956         }
+ 1957 
+ 1958 
+ 1959         // Calculate quiz score
+ 1960         function calculateScore() {
+ 1961             let correct = 0;
+ 1962             currentQuestions.forEach((question, index) => {
+ 1963                 const correctIndex = question.answer.charCodeAt(0) - 97;
+ 1964                 if (userAnswers[index] === correctIndex) {
+ 1965                     correct++;
+ 1966                 }
+ 1967             });
+ 1968             return {
+ 1969                 correct,
+ 1970                 total: currentQuestions.length,
+ 1971                 percentage: (correct / currentQuestions.length) * 100,
+ 1972                 timeSpent: Date.now() - quizStartTime
+ 1973             };
+ 1974         }
+ 1975 
+ 1976 
+ 1977         // Show quiz results - Fixed to properly hide navigation
+ 1978         function showQuizResults(score) {
+ 1979             document.getElementById('finalScore').textContent = `${Math.round(score.percentage)}%`;
+ 1980             document.getElementById('scoreDetails').textContent = `${score.correct} out of ${score.total} correct`;
+ 1981             
+ 1982             // Hide the main quiz elements
+ 1983             document.getElementById('quizResults').classList.remove('hidden');
+ 1984             document.querySelector('#quizInterface .material-card').classList.add('hidden');
+ 1985             
+ 1986             // Hide navigation buttons container
+ 1987             const navigationContainer = document.getElementById('quizNavigation');
+ 1988             if (navigationContainer) {
+ 1989                 navigationContainer.classList.add('hidden');
+ 1990             }
+ 1991         }
+ 1992 
+ 1993         // ========== SWIPE GESTURE FUNCTIONS ==========
+ 1994         
+ 1995         function setupSwipeGestures() {
+ 1996             const quizCard = document.getElementById('quizCard');
+ 1997             const swipeIndicatorLeft = document.getElementById('swipeIndicatorLeft');
+ 1998             const swipeIndicatorRight = document.getElementById('swipeIndicatorRight');
+ 1999 
+ 2000             if (!quizCard) return;
+ 2001 
+ 2002             // Touch events for mobile
+ 2003             quizCard.addEventListener('touchstart', handleTouchStart, { passive: true });
+ 2004             quizCard.addEventListener('touchmove', handleTouchMove, { passive: true });
+ 2005             quizCard.addEventListener('touchend', handleTouchEnd, { passive: true });
+ 2006 
+ 2007             // Mouse events for desktop testing
+ 2008             quizCard.addEventListener('mousedown', handleMouseDown);
+ 2009             quizCard.addEventListener('mousemove', handleMouseMove);
+ 2010             quizCard.addEventListener('mouseup', handleMouseUp);
+ 2011 
+ 2012             // Double-click for desktop
+ 2013             quizCard.addEventListener('dblclick', handleDoubleClick);
+ 2014         }
+ 2015 
+ 2016         function handleTouch