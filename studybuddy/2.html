<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StudySync - No Student Learns Alone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        display: ['Fraunces', 'serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eef7ff',
                            100: '#d9edff',
                            200: '#bce0ff',
                            300: '#8eccff',
                            400: '#59afff',
                            500: '#3b8bff',
                            600: '#1a5ff5',
                            700: '#1a4de1',
                            800: '#1c40b6',
                            900: '#1c3a8f',
                        },
                        accent: {
                            50: '#effef7',
                            100: '#dafeef',
                            200: '#b7fbde',
                            300: '#7ef5c5',
                            400: '#3ee8a5',
                            500: '#14d18a',
                            600: '#0aad70',
                            700: '#0c885c',
                            800: '#106b4b',
                            900: '#10583f',
                        },
                        premium: {
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                        },
                        coral: {
                            400: '#fb7185',
                            500: '#f43f5e',
                            600: '#e11d48',
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'slide-down': 'slideDown 0.3s ease-out',
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'scale-in': 'scaleIn 0.3s ease-out',
                        'confetti': 'confetti 1s ease-out forwards',
                        'bounce-in': 'bounceIn 0.5s ease-out',
                        'swipe-right': 'swipeRight 0.4s ease-out forwards',
                        'swipe-left': 'swipeLeft 0.4s ease-out forwards',
                        'swipe-up': 'swipeUp 0.4s ease-out forwards',
                    }
                }
            }
        }
    </script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3); }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes swipeRight {
            to { opacity: 0; transform: translateX(150%) rotate(20deg); }
        }

        @keyframes swipeLeft {
            to { opacity: 0; transform: translateX(-150%) rotate(-20deg); }
        }

        @keyframes swipeUp {
            to { opacity: 0; transform: translateY(-150%) scale(0.8); }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(720deg); opacity: 0; }
        }

        .card-stack {
            perspective: 1000px;
        }

        .swipe-card {
            touch-action: none;
            user-select: none;
            transition: transform 0.1s ease-out;
            transform-style: preserve-3d;
        }

        .swipe-card.dragging {
            transition: none;
        }

        .gradient-mesh {
            background:
                radial-gradient(at 40% 20%, rgba(59, 139, 255, 0.3) 0px, transparent 50%),
                radial-gradient(at 80% 0%, rgba(62, 232, 165, 0.2) 0px, transparent 50%),
                radial-gradient(at 0% 50%, rgba(251, 113, 133, 0.15) 0px, transparent 50%),
                radial-gradient(at 80% 50%, rgba(245, 158, 11, 0.1) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(59, 139, 255, 0.2) 0px, transparent 50%);
        }

        .dark .gradient-mesh {
            background:
                radial-gradient(at 40% 20%, rgba(59, 139, 255, 0.15) 0px, transparent 50%),
                radial-gradient(at 80% 0%, rgba(62, 232, 165, 0.1) 0px, transparent 50%),
                radial-gradient(at 0% 50%, rgba(251, 113, 133, 0.08) 0px, transparent 50%),
                radial-gradient(at 80% 50%, rgba(245, 158, 11, 0.05) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(59, 139, 255, 0.1) 0px, transparent 50%);
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .dark .glass {
            background: rgba(30, 30, 35, 0.8);
        }

        .profile-gradient {
            background: linear-gradient(135deg, #3b8bff 0%, #14d18a 50%, #f59e0b 100%);
        }

        .text-gradient {
            background: linear-gradient(135deg, #3b8bff 0%, #14d18a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .shadow-glow {
            box-shadow: 0 0 40px rgba(59, 139, 255, 0.3), 0 0 80px rgba(20, 209, 138, 0.2);
        }

        .dark .shadow-glow {
            box-shadow: 0 0 40px rgba(59, 139, 255, 0.2), 0 0 80px rgba(20, 209, 138, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b8bff 0%, #1a5ff5 100%);
            box-shadow: 0 4px 15px rgba(59, 139, 255, 0.4);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 25px rgba(59, 139, 255, 0.5);
            transform: translateY(-2px);
        }

        .btn-accent {
            background: linear-gradient(135deg, #14d18a 0%, #0aad70 100%);
            box-shadow: 0 4px 15px rgba(20, 209, 138, 0.4);
        }

        .nav-item.active {
            color: #3b8bff;
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: #3b8bff;
            border-radius: 50%;
        }

        input, select, textarea {
            font-size: 16px !important;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 2px;
        }

        @media (max-width: 380px) {
            .card-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="font-sans bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-white min-h-screen overflow-x-hidden">
    <div id="app">
        <!-- Loading Screen -->
        <div id="loading-screen" class="fixed inset-0 z-50 flex items-center justify-center gradient-mesh bg-slate-50 dark:bg-slate-950">
            <div class="text-center animate-fade-in">
                <div class="w-20 h-20 mx-auto mb-6 rounded-2xl profile-gradient flex items-center justify-center shadow-glow animate-pulse-slow">
                    <span class="text-3xl font-bold text-white font-display">S</span>
                </div>
                <h1 class="text-2xl font-bold font-display text-gradient">StudySync</h1>
                <p class="text-slate-500 dark:text-slate-400 mt-2 text-sm">No student learns alone</p>
            </div>
        </div>

        <!-- Onboarding Screen -->
        <div id="onboarding-screen" class="fixed inset-0 z-40 gradient-mesh bg-slate-50 dark:bg-slate-950 hidden">
            <div class="min-h-screen flex flex-col items-center justify-center p-6">
                <div class="max-w-md w-full animate-slide-up">
                    <!-- Logo -->
                    <div class="text-center mb-10">
                        <div class="w-24 h-24 mx-auto mb-6 rounded-3xl profile-gradient flex items-center justify-center shadow-glow animate-float">
                            <span class="text-4xl font-bold text-white font-display">S</span>
                        </div>
                        <h1 class="text-4xl font-bold font-display mb-2">
                            <span class="text-gradient">StudySync</span>
                        </h1>
                        <p class="text-slate-600 dark:text-slate-400 text-lg">No student learns alone</p>
                    </div>

                    <!-- Role Selection -->
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <button onclick="selectRole('learner')" id="role-learner" class="role-btn group p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 hover:border-primary-500 dark:hover:border-primary-400 transition-all duration-300 hover:shadow-lg">
                            <div class="w-14 h-14 bg-gradient-to-br from-primary-400 to-primary-600 rounded-xl flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                                <i class="fas fa-graduation-cap text-white text-xl"></i>
                            </div>
                            <h3 class="font-semibold text-slate-900 dark:text-white mb-1">I need help</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Find tutors & partners</p>
                        </button>

                        <button onclick="selectRole('helper')" id="role-helper" class="role-btn group p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 hover:border-accent-500 dark:hover:border-accent-400 transition-all duration-300 hover:shadow-lg">
                            <div class="w-14 h-14 bg-gradient-to-br from-accent-400 to-accent-600 rounded-xl flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform">
                                <i class="fas fa-lightbulb text-white text-xl"></i>
                            </div>
                            <h3 class="font-semibold text-slate-900 dark:text-white mb-1">I can help</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Share & earn</p>
                        </button>
                    </div>

                    <!-- Form -->
                    <div class="space-y-4 mb-6">
                        <div class="relative group">
                            <i class="fas fa-envelope absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-primary-500 transition-colors"></i>
                            <input type="email" id="email-input" placeholder="Your .edu email"
                                class="w-full p-4 pl-12 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                        </div>

                        <div class="relative group">
                            <i class="fas fa-university absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-primary-500 transition-colors"></i>
                            <select id="university-select" class="w-full p-4 pl-12 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all appearance-none cursor-pointer">
                                <option value="">Select your university</option>
                                <option value="mit">MIT</option>
                                <option value="stanford">Stanford University</option>
                                <option value="harvard">Harvard University</option>
                                <option value="berkeley">UC Berkeley</option>
                                <option value="caltech">Caltech</option>
                                <option value="princeton">Princeton University</option>
                                <option value="yale">Yale University</option>
                                <option value="columbia">Columbia University</option>
                                <option value="other">Other</option>
                            </select>
                            <i class="fas fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"></i>
                        </div>

                        <div class="relative group">
                            <i class="fas fa-book absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-primary-500 transition-colors"></i>
                            <input type="text" id="major-input" placeholder="Your major (e.g., Computer Science)"
                                class="w-full p-4 pl-12 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                        </div>
                    </div>

                    <button onclick="completeOnboarding()" class="w-full py-4 btn-primary text-white font-semibold rounded-xl transition-all duration-300 flex items-center justify-center gap-2">
                        <span>Get Started</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>

                    <p class="text-center text-sm text-slate-500 dark:text-slate-400 mt-6">
                        By continuing, you agree to our Terms & Privacy Policy
                    </p>
                </div>
            </div>
        </div>

        <!-- Main App Container -->
        <div id="main-app" class="hidden">
            <!-- Header -->
            <header id="main-header" class="fixed top-0 left-0 right-0 z-30 glass border-b border-slate-200/50 dark:border-slate-700/50">
                <div class="max-w-lg mx-auto px-4 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl profile-gradient flex items-center justify-center">
                                <span class="text-white font-bold font-display">S</span>
                            </div>
                            <div>
                                <h2 class="font-semibold text-slate-900 dark:text-white" id="header-title">Discover</h2>
                                <p class="text-xs text-slate-500 dark:text-slate-400" id="header-subtitle">Swipe to learn or teach</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <button onclick="showFilters()" class="p-2.5 rounded-xl bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                                <i class="fas fa-sliders text-slate-600 dark:text-slate-300"></i>
                            </button>
                            <button onclick="showNotifications()" class="p-2.5 rounded-xl bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors relative">
                                <i class="fas fa-bell text-slate-600 dark:text-slate-300"></i>
                                <span class="absolute -top-1 -right-1 w-5 h-5 bg-coral-500 text-white text-xs font-bold rounded-full flex items-center justify-center">3</span>
                            </button>
                        </div>
                    </div>

                    <!-- Subject Tabs -->
                    <div id="subject-tabs" class="mt-3 -mx-4 px-4 overflow-x-auto scrollbar-hide">
                        <div class="flex gap-2 pb-1">
                            <button class="subject-tab active px-4 py-2 bg-primary-500 text-white rounded-full text-sm font-medium whitespace-nowrap shadow-sm" data-subject="all">
                                All Subjects
                            </button>
                            <button class="subject-tab px-4 py-2 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full text-sm font-medium whitespace-nowrap hover:bg-slate-50 dark:hover:bg-slate-700" data-subject="calculus">
                                Calculus
                            </button>
                            <button class="subject-tab px-4 py-2 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full text-sm font-medium whitespace-nowrap hover:bg-slate-50 dark:hover:bg-slate-700" data-subject="cs">
                                Computer Science
                            </button>
                            <button class="subject-tab px-4 py-2 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full text-sm font-medium whitespace-nowrap hover:bg-slate-50 dark:hover:bg-slate-700" data-subject="biology">
                                Biology
                            </button>
                            <button class="subject-tab px-4 py-2 bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-full text-sm font-medium whitespace-nowrap hover:bg-slate-50 dark:hover:bg-slate-700" data-subject="physics">
                                Physics
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Discovery View -->
            <div id="discovery-view" class="pt-36 pb-40 px-4 min-h-screen">
                <div class="max-w-md mx-auto card-stack relative h-[520px] flex items-center justify-center">
                    <!-- Cards will be dynamically inserted here -->
                    <div id="card-container" class="relative w-full h-full"></div>

                    <!-- Empty State -->
                    <div id="empty-state" class="hidden absolute inset-0 flex items-center justify-center">
                        <div class="text-center p-8">
                            <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center">
                                <i class="fas fa-search text-3xl text-slate-400"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-slate-900 dark:text-white mb-2">No more profiles</h3>
                            <p class="text-slate-500 dark:text-slate-400 mb-6">Check back later for more study partners!</p>
                            <button onclick="resetCards()" class="px-6 py-3 btn-primary text-white font-medium rounded-xl">
                                <i class="fas fa-redo mr-2"></i>Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Swipe Action Buttons -->
                <div id="swipe-buttons" class="fixed bottom-24 left-0 right-0 px-6">
                    <div class="max-w-md mx-auto">
                        <div class="flex items-center justify-center gap-6">
                            <button onclick="swipeCard('left')" class="swipe-btn w-16 h-16 rounded-full bg-white dark:bg-slate-800 shadow-lg hover:shadow-xl flex items-center justify-center transition-all duration-300 hover:scale-110 group">
                                <div class="w-12 h-12 rounded-full bg-coral-50 dark:bg-coral-900/30 flex items-center justify-center group-hover:bg-coral-100 dark:group-hover:bg-coral-900/50 transition-colors">
                                    <i class="fas fa-times text-xl text-coral-500"></i>
                                </div>
                            </button>

                            <button onclick="swipeCard('up')" class="swipe-btn w-20 h-20 rounded-full bg-gradient-to-br from-premium-400 to-premium-600 shadow-lg hover:shadow-xl flex items-center justify-center transition-all duration-300 hover:scale-110 relative">
                                <i class="fas fa-bolt text-2xl text-white"></i>
                                <span class="absolute -top-1 -right-1 w-6 h-6 bg-white dark:bg-slate-800 text-premium-600 text-xs font-bold rounded-full flex items-center justify-center shadow">3</span>
                            </button>

                            <button onclick="swipeCard('right')" class="swipe-btn w-16 h-16 rounded-full bg-white dark:bg-slate-800 shadow-lg hover:shadow-xl flex items-center justify-center transition-all duration-300 hover:scale-110 group">
                                <div class="w-12 h-12 rounded-full bg-accent-50 dark:bg-accent-900/30 flex items-center justify-center group-hover:bg-accent-100 dark:group-hover:bg-accent-900/50 transition-colors">
                                    <i class="fas fa-check text-xl text-accent-500"></i>
                                </div>
                            </button>
                        </div>

                        <p class="text-center mt-4 text-slate-500 dark:text-slate-400 text-sm">
                            <span class="text-coral-500 font-medium">‚Üê</span> Pass ¬∑
                            <span class="text-premium-500 font-medium">‚Üë</span> Priority ¬∑
                            <span class="text-accent-500 font-medium">‚Üí</span> Connect
                        </p>
                    </div>
                </div>
            </div>

            <!-- Matches View -->
            <div id="matches-view" class="pt-24 pb-24 px-4 min-h-screen hidden">
                <div class="max-w-lg mx-auto">
                    <h2 class="text-2xl font-bold font-display text-slate-900 dark:text-white mb-6">Your Matches</h2>

                    <!-- New Matches -->
                    <div class="mb-8">
                        <h3 class="text-sm font-medium text-slate-500 dark:text-slate-400 mb-3 uppercase tracking-wider">New Connections</h3>
                        <div class="flex gap-4 overflow-x-auto scrollbar-hide pb-2">
                            <div id="new-matches-container" class="flex gap-4"></div>
                        </div>
                    </div>

                    <!-- Active Conversations -->
                    <div>
                        <h3 class="text-sm font-medium text-slate-500 dark:text-slate-400 mb-3 uppercase tracking-wider">Messages</h3>
                        <div id="conversations-container" class="space-y-3"></div>
                    </div>
                </div>
            </div>

            <!-- Profile View -->
            <div id="profile-view" class="pb-24 min-h-screen hidden">
                <div class="max-w-lg mx-auto">
                    <!-- Cover -->
                    <div class="h-48 profile-gradient rounded-b-3xl relative">
                        <button onclick="editProfile()" class="absolute top-4 right-4 p-2.5 rounded-xl bg-white/20 backdrop-blur-sm text-white hover:bg-white/30 transition-colors">
                            <i class="fas fa-pen"></i>
                        </button>
                        <div class="absolute -bottom-12 left-6">
                            <div class="w-28 h-28 rounded-2xl border-4 border-white dark:border-slate-900 bg-white dark:bg-slate-800 overflow-hidden shadow-lg" id="profile-avatar">
                                <div class="w-full h-full bg-gradient-to-br from-primary-400 to-accent-500 flex items-center justify-center">
                                    <span class="text-4xl text-white font-bold" id="profile-initial">S</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pt-16 px-6">
                        <!-- Name & Status -->
                        <div class="flex items-start justify-between mb-6">
                            <div>
                                <h1 class="text-2xl font-bold text-slate-900 dark:text-white" id="profile-name">Sarah Johnson</h1>
                                <div class="flex items-center text-slate-600 dark:text-slate-400 gap-2">
                                    <i class="fas fa-university text-sm"></i>
                                    <span id="profile-university">Stanford University</span>
                                </div>
                                <div class="flex items-center text-slate-500 dark:text-slate-400 gap-2 mt-1">
                                    <i class="fas fa-book-open text-sm"></i>
                                    <span id="profile-major">Biology Major</span>
                                </div>
                            </div>
                            <div class="px-3 py-1.5 bg-accent-100 dark:bg-accent-900/30 rounded-full">
                                <div class="flex items-center gap-1.5">
                                    <span class="w-2 h-2 bg-accent-500 rounded-full animate-pulse"></span>
                                    <span class="text-sm font-medium text-accent-700 dark:text-accent-400">Online</span>
                                </div>
                            </div>
                        </div>

                        <!-- Stats -->
                        <div class="grid grid-cols-3 gap-4 mb-8">
                            <div class="bg-white dark:bg-slate-800 rounded-2xl p-4 text-center shadow-sm">
                                <div class="text-2xl font-bold text-primary-600 dark:text-primary-400">142</div>
                                <div class="text-sm text-slate-500 dark:text-slate-400">Sessions</div>
                            </div>
                            <div class="bg-white dark:bg-slate-800 rounded-2xl p-4 text-center shadow-sm">
                                <div class="text-2xl font-bold text-accent-600 dark:text-accent-400">4.9</div>
                                <div class="text-sm text-slate-500 dark:text-slate-400">Rating</div>
                            </div>
                            <div class="bg-white dark:bg-slate-800 rounded-2xl p-4 text-center shadow-sm">
                                <div class="text-2xl font-bold text-premium-600 dark:text-premium-400">3.2k</div>
                                <div class="text-sm text-slate-500 dark:text-slate-400">Points</div>
                            </div>
                        </div>

                        <!-- Tutor Level -->
                        <div class="bg-gradient-to-r from-premium-400/10 to-premium-500/10 dark:from-premium-500/20 dark:to-premium-600/20 rounded-2xl p-4 mb-6 border border-premium-200 dark:border-premium-800">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-premium-400 to-premium-600 flex items-center justify-center">
                                        <i class="fas fa-crown text-white text-lg"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold text-slate-900 dark:text-white">Master Mentor</h4>
                                        <p class="text-sm text-slate-500 dark:text-slate-400">Top 5% of tutors</p>
                                    </div>
                                </div>
                                <i class="fas fa-chevron-right text-slate-400"></i>
                            </div>
                        </div>

                        <!-- Expertise -->
                        <div class="mb-8">
                            <h3 class="font-semibold text-slate-900 dark:text-white mb-3">My Expertise</h3>
                            <div class="flex flex-wrap gap-2" id="expertise-tags">
                                <span class="px-4 py-2 bg-gradient-to-r from-primary-500 to-accent-500 text-white rounded-full text-sm font-medium flex items-center gap-2">
                                    <i class="fas fa-star text-xs"></i> Organic Chemistry
                                </span>
                                <span class="px-4 py-2 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full text-sm font-medium">Cell Biology</span>
                                <span class="px-4 py-2 bg-accent-100 dark:bg-accent-900/30 text-accent-700 dark:text-accent-300 rounded-full text-sm font-medium">Genetics</span>
                                <button class="px-4 py-2 border border-dashed border-slate-300 dark:border-slate-600 text-slate-500 dark:text-slate-400 rounded-full text-sm hover:border-primary-400 hover:text-primary-500 transition-colors">
                                    <i class="fas fa-plus mr-1"></i> Add
                                </button>
                            </div>
                        </div>

                        <!-- Availability -->
                        <div class="bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm mb-8">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="font-semibold text-slate-900 dark:text-white">Weekly Availability</h3>
                                <button class="text-primary-500 text-sm font-medium">Edit</button>
                            </div>
                            <div class="grid grid-cols-7 gap-2">
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Mon</div>
                                    <div class="w-10 h-10 rounded-lg bg-primary-500 text-white flex items-center justify-center mx-auto font-medium">3</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Tue</div>
                                    <div class="w-10 h-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 flex items-center justify-center mx-auto font-medium">2</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Wed</div>
                                    <div class="w-10 h-10 rounded-lg bg-primary-500 text-white flex items-center justify-center mx-auto font-medium">4</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Thu</div>
                                    <div class="w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-400 flex items-center justify-center mx-auto font-medium">0</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Fri</div>
                                    <div class="w-10 h-10 rounded-lg bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 flex items-center justify-center mx-auto font-medium">2</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Sat</div>
                                    <div class="w-10 h-10 rounded-lg bg-accent-500 text-white flex items-center justify-center mx-auto font-medium">5</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-xs font-medium text-slate-500 dark:text-slate-400 mb-2">Sun</div>
                                    <div class="w-10 h-10 rounded-lg bg-accent-100 dark:bg-accent-900/30 text-accent-600 dark:text-accent-400 flex items-center justify-center mx-auto font-medium">3</div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Reviews -->
                        <div class="mb-8">
                            <h3 class="font-semibold text-slate-900 dark:text-white mb-4">Recent Reviews</h3>
                            <div class="space-y-4" id="reviews-container">
                                <!-- Reviews inserted dynamically -->
                            </div>
                        </div>

                        <!-- Settings -->
                        <div class="space-y-3">
                            <button class="w-full flex items-center justify-between p-4 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow transition-shadow">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center">
                                        <i class="fas fa-cog text-slate-600 dark:text-slate-400"></i>
                                    </div>
                                    <span class="font-medium text-slate-900 dark:text-white">Settings</span>
                                </div>
                                <i class="fas fa-chevron-right text-slate-400"></i>
                            </button>
                            <button class="w-full flex items-center justify-between p-4 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow transition-shadow">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center">
                                        <i class="fas fa-question-circle text-slate-600 dark:text-slate-400"></i>
                                    </div>
                                    <span class="font-medium text-slate-900 dark:text-white">Help & Support</span>
                                </div>
                                <i class="fas fa-chevron-right text-slate-400"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Navigation -->
            <nav class="fixed bottom-0 left-0 right-0 z-30 glass border-t border-slate-200/50 dark:border-slate-700/50 safe-area-inset-bottom">
                <div class="max-w-lg mx-auto px-6 py-3">
                    <div class="flex items-center justify-around">
                        <button onclick="showView('discovery')" class="nav-item relative flex flex-col items-center gap-1 px-4 py-2 active">
                            <i class="fas fa-layer-group text-lg"></i>
                            <span class="text-xs font-medium">Discover</span>
                        </button>
                        <button onclick="showView('matches')" class="nav-item relative flex flex-col items-center gap-1 px-4 py-2 text-slate-500 dark:text-slate-400">
                            <i class="fas fa-comments text-lg"></i>
                            <span class="text-xs font-medium">Matches</span>
                            <span class="absolute -top-1 right-1 w-5 h-5 bg-coral-500 text-white text-xs font-bold rounded-full flex items-center justify-center">2</span>
                        </button>
                        <button onclick="showView('sessions')" class="nav-item relative flex flex-col items-center gap-1 px-4 py-2 text-slate-500 dark:text-slate-400">
                            <i class="fas fa-calendar-alt text-lg"></i>
                            <span class="text-xs font-medium">Sessions</span>
                        </button>
                        <button onclick="showView('profile')" class="nav-item relative flex flex-col items-center gap-1 px-4 py-2 text-slate-500 dark:text-slate-400">
                            <i class="fas fa-user text-lg"></i>
                            <span class="text-xs font-medium">Profile</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>

        <!-- Modals Container -->
        <div id="modals-container"></div>
    </div>

    <script>
        // App State
        const state = {
            currentView: 'discovery',
            user: {
                name: 'Sarah Johnson',
                email: '',
                university: 'Stanford University',
                major: 'Biology',
                role: 'both',
                points: 3200,
                rating: 4.9,
                sessions: 142
            },
            currentCardIndex: 0,
            profiles: [],
            matches: [],
            conversations: []
        };

        // Sample Profiles Data
        const sampleProfiles = [
            {
                id: 1,
                name: 'Alex Chen',
                university: 'MIT',
                major: 'Computer Science',
                rating: 4.9,
                reviews: 127,
                verified: true,
                level: 'Master Mentor',
                subjects: ['Data Structures', 'Algorithms', 'Python'],
                availability: ['3 PM', '4 PM', '7 PM'],
                price: 25,
                points: 50,
                bio: 'I focus on real-world examples and practical coding exercises. I recently aced this course with an A+.',
                gradient: 'from-primary-400 to-primary-600'
            },
            {
                id: 2,
                name: 'Emma Williams',
                university: 'Stanford',
                major: 'Biology',
                rating: 4.8,
                reviews: 89,
                verified: true,
                level: 'Reliable Tutor',
                subjects: ['Organic Chemistry', 'Biochemistry', 'Lab Techniques'],
                availability: ['10 AM', '2 PM', '5 PM'],
                price: 20,
                points: 40,
                bio: 'Pre-med student passionate about making complex biology concepts click. Love using visual aids!',
                gradient: 'from-accent-400 to-accent-600'
            },
            {
                id: 3,
                name: 'Marcus Thompson',
                university: 'Berkeley',
                major: 'Physics',
                rating: 4.7,
                reviews: 64,
                verified: true,
                level: 'Reliable Tutor',
                subjects: ['Quantum Mechanics', 'Thermodynamics', 'Calculus III'],
                availability: ['1 PM', '3 PM', '8 PM'],
                price: 30,
                points: 60,
                bio: 'Physics PhD candidate. I break down complex topics into intuitive concepts using real-world analogies.',
                gradient: 'from-purple-400 to-purple-600'
            },
            {
                id: 4,
                name: 'Priya Patel',
                university: 'Harvard',
                major: 'Economics',
                rating: 5.0,
                reviews: 156,
                verified: true,
                level: 'Master Mentor',
                subjects: ['Microeconomics', 'Econometrics', 'Game Theory'],
                availability: ['9 AM', '12 PM', '6 PM'],
                price: 35,
                points: 70,
                bio: 'Former TA with 3 years of tutoring experience. My students average a full letter grade improvement!',
                gradient: 'from-coral-400 to-coral-600'
            },
            {
                id: 5,
                name: 'Jordan Lee',
                university: 'Caltech',
                major: 'Mathematics',
                rating: 4.9,
                reviews: 203,
                verified: true,
                level: 'Certified Expert',
                subjects: ['Linear Algebra', 'Differential Equations', 'Real Analysis'],
                availability: ['11 AM', '4 PM', '9 PM'],
                price: 40,
                points: 80,
                bio: 'Math olympiad gold medalist. I make abstract math tangible through problem-solving strategies.',
                gradient: 'from-premium-400 to-premium-600'
            }
        ];

        const sampleMatches = [
            { id: 1, name: 'Alex Chen', subject: 'Data Structures', new: true, gradient: 'from-primary-400 to-primary-600' },
            { id: 2, name: 'Emma Williams', subject: 'Biochemistry', new: true, gradient: 'from-accent-400 to-accent-600' },
            { id: 3, name: 'Priya Patel', subject: 'Microeconomics', new: false, gradient: 'from-coral-400 to-coral-600' }
        ];

        const sampleConversations = [
            {
                id: 1,
                name: 'Priya Patel',
                lastMessage: 'Great! See you at 3 PM tomorrow üìö',
                time: '2m ago',
                unread: 2,
                gradient: 'from-coral-400 to-coral-600'
            },
            {
                id: 2,
                name: 'Marcus Thompson',
                lastMessage: 'The Schr√∂dinger equation makes more sense now!',
                time: '1h ago',
                unread: 0,
                gradient: 'from-purple-400 to-purple-600'
            },
            {
                id: 3,
                name: 'Jordan Lee',
                lastMessage: 'Let me know if you need help with the proof',
                time: '3h ago',
                unread: 0,
                gradient: 'from-premium-400 to-premium-600'
            }
        ];

        const sampleReviews = [
            { name: 'Mike R.', rating: 5, text: 'Sarah explained complex topics in a way that finally made sense. My grade improved from C to A!', gradient: 'from-primary-400 to-primary-600' },
            { name: 'Lisa T.', rating: 5, text: 'Super patient and knowledgeable. Helped me prepare for my organic chem final perfectly!', gradient: 'from-accent-400 to-accent-600' },
            { name: 'David K.', rating: 4, text: 'Great tutor! Very flexible with scheduling and always prepared.', gradient: 'from-purple-400 to-purple-600' }
        ];

        // Initialize App
        function init() {
            // Dark mode detection
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            });

            // Load profiles
            state.profiles = [...sampleProfiles];
            state.matches = [...sampleMatches];
            state.conversations = [...sampleConversations];

            // Show loading then onboarding
            setTimeout(() => {
                document.getElementById('loading-screen').classList.add('hidden');
                document.getElementById('onboarding-screen').classList.remove('hidden');
            }, 1500);
        }

        // Role Selection
        function selectRole(role) {
            state.user.role = role;
            document.querySelectorAll('.role-btn').forEach(btn => {
                btn.classList.remove('border-primary-500', 'border-accent-500', 'bg-primary-50', 'bg-accent-50', 'dark:bg-primary-900/20', 'dark:bg-accent-900/20');
                btn.classList.add('border-slate-200', 'dark:border-slate-700');
            });

            const selectedBtn = document.getElementById(`role-${role}`);
            if (role === 'learner') {
                selectedBtn.classList.remove('border-slate-200', 'dark:border-slate-700');
                selectedBtn.classList.add('border-primary-500', 'bg-primary-50', 'dark:bg-primary-900/20');
            } else {
                selectedBtn.classList.remove('border-slate-200', 'dark:border-slate-700');
                selectedBtn.classList.add('border-accent-500', 'bg-accent-50', 'dark:bg-accent-900/20');
            }
        }

        // Complete Onboarding
        function completeOnboarding() {
            const email = document.getElementById('email-input').value;
            const university = document.getElementById('university-select').value;
            const major = document.getElementById('major-input').value;

            if (!email || !university || !major) {
                showModal('error', 'Please fill in all fields to continue.');
                return;
            }

            state.user.email = email;
            state.user.university = document.getElementById('university-select').options[document.getElementById('university-select').selectedIndex].text;
            state.user.major = major;

            document.getElementById('onboarding-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');

            renderCards();
            renderMatches();
            renderConversations();
            renderReviews();
            updateProfile();
        }

        // Render Profile Cards
        function renderCards() {
            const container = document.getElementById('card-container');
            container.innerHTML = '';

            if (state.currentCardIndex >= state.profiles.length) {
                document.getElementById('empty-state').classList.remove('hidden');
                document.getElementById('swipe-buttons').classList.add('hidden');
                return;
            }

            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('swipe-buttons').classList.remove('hidden');

            // Render up to 3 cards (stack effect)
            const cardsToRender = Math.min(3, state.profiles.length - state.currentCardIndex);

            for (let i = cardsToRender - 1; i >= 0; i--) {
                const profile = state.profiles[state.currentCardIndex + i];
                const card = createCard(profile, i);
                container.appendChild(card);
            }

            // Setup swipe on top card
            const topCard = container.querySelector('.swipe-card:last-child');
            if (topCard) {
                setupSwipe(topCard);
            }
        }

        function createCard(profile, stackIndex) {
            const card = document.createElement('div');
            card.className = `swipe-card absolute w-full bg-white dark:bg-slate-800 rounded-3xl shadow-xl overflow-hidden`;
            card.style.zIndex = 10 - stackIndex;
            card.style.transform = `translateY(${stackIndex * 12}px) scale(${1 - stackIndex * 0.04})`;
            card.style.opacity = stackIndex === 0 ? 1 : 0.7 - stackIndex * 0.2;

            card.innerHTML = `
                <!-- Swipe Indicators -->
                <div class="swipe-indicator-left absolute top-6 left-6 z-20 opacity-0 transition-opacity">
                    <div class="px-4 py-2 bg-coral-500 text-white font-bold rounded-lg rotate-[-20deg] text-lg border-2 border-white shadow-lg">
                        PASS
                    </div>
                </div>
                <div class="swipe-indicator-right absolute top-6 right-6 z-20 opacity-0 transition-opacity">
                    <div class="px-4 py-2 bg-accent-500 text-white font-bold rounded-lg rotate-[20deg] text-lg border-2 border-white shadow-lg">
                        CONNECT
                    </div>
                </div>
                <div class="swipe-indicator-up absolute top-6 left-1/2 -translate-x-1/2 z-20 opacity-0 transition-opacity">
                    <div class="px-4 py-2 bg-premium-500 text-white font-bold rounded-lg text-lg border-2 border-white shadow-lg">
                        ‚ö° PRIORITY
                    </div>
                </div>

                <!-- Verified Badge -->
                ${profile.verified ? `
                <div class="absolute top-4 right-4 z-10">
                    <div class="flex items-center gap-1.5 bg-accent-500/90 backdrop-blur-sm px-3 py-1.5 rounded-full shadow-lg">
                        <i class="fas fa-check-circle text-white text-xs"></i>
                        <span class="text-xs font-semibold text-white">Verified</span>
                    </div>
                </div>
                ` : ''}

                <!-- Profile Header -->
                <div class="h-44 bg-gradient-to-br ${profile.gradient} relative">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                    <div class="absolute bottom-4 left-5 right-5">
                        <div class="flex items-end justify-between">
                            <div>
                                <h3 class="text-2xl font-bold text-white mb-0.5">${profile.name}</h3>
                                <div class="flex items-center text-white/90 text-sm gap-1">
                                    <i class="fas fa-university text-xs"></i>
                                    <span>${profile.major} ¬∑ ${profile.university}</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-1 bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-full">
                                <i class="fas fa-star text-premium-400 text-sm"></i>
                                <span class="text-white font-semibold">${profile.rating}</span>
                                <span class="text-white/70 text-sm">(${profile.reviews})</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card Content -->
                <div class="p-5 card-content">
                    <!-- Level Badge -->
                    <div class="flex items-center gap-2 mb-4">
                        <span class="px-3 py-1 bg-gradient-to-r from-premium-400/20 to-premium-500/20 text-premium-700 dark:text-premium-300 rounded-full text-xs font-semibold border border-premium-300/30">
                            <i class="fas fa-crown mr-1"></i>${profile.level}
                        </span>
                    </div>

                    <!-- Subjects -->
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${profile.subjects.map((subject, idx) => `
                            <span class="px-3 py-1.5 ${idx === 0 ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300'} rounded-full text-xs font-medium">${subject}</span>
                        `).join('')}
                    </div>

                    <!-- Availability -->
                    <div class="mb-4">
                        <div class="flex items-center text-slate-600 dark:text-slate-400 mb-2 text-sm">
                            <i class="fas fa-calendar-check mr-2 text-accent-500"></i>
                            <span class="font-medium">Available Today</span>
                        </div>
                        <div class="flex gap-2">
                            ${profile.availability.map(time => `
                                <span class="px-3 py-1.5 bg-slate-50 dark:bg-slate-700/50 rounded-lg text-sm text-slate-700 dark:text-slate-300">${time}</span>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Bio -->
                    <div class="mb-5">
                        <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed">"${profile.bio}"</p>
                    </div>

                    <!-- Footer -->
                    <div class="flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-700">
                        <div>
                            <div class="text-xl font-bold text-primary-600 dark:text-primary-400">$${profile.price}<span class="text-sm font-normal text-slate-500">/hr</span></div>
                            <div class="text-xs text-slate-500 dark:text-slate-400">or ${profile.points} pts</div>
                        </div>
                        <button onclick="event.stopPropagation(); quickMatch(${profile.id})" class="px-5 py-2.5 btn-primary text-white font-semibold rounded-xl text-sm flex items-center gap-2 transition-all">
                            <i class="fas fa-bolt"></i>
                            <span>Quick Match</span>
                        </button>
                    </div>
                </div>
            `;

            return card;
        }

        // Swipe Functionality
        function setupSwipe(card) {
            let startX = 0;
            let startY = 0;
            let currentX = 0;
            let currentY = 0;
            let isDragging = false;

            const onStart = (e) => {
                isDragging = true;
                card.classList.add('dragging');
                const point = e.touches ? e.touches[0] : e;
                startX = point.clientX;
                startY = point.clientY;
            };

            const onMove = (e) => {
                if (!isDragging) return;
                e.preventDefault();

                const point = e.touches ? e.touches[0] : e;
                currentX = point.clientX - startX;
                currentY = point.clientY - startY;

                const rotation = currentX * 0.05;
                card.style.transform = `translate(${currentX}px, ${currentY}px) rotate(${rotation}deg)`;

                // Show indicators
                const leftIndicator = card.querySelector('.swipe-indicator-left');
                const rightIndicator = card.querySelector('.swipe-indicator-right');
                const upIndicator = card.querySelector('.swipe-indicator-up');

                if (currentX < -50) {
                    leftIndicator.style.opacity = Math.min(1, (-currentX - 50) / 100);
                    rightIndicator.style.opacity = 0;
                    upIndicator.style.opacity = 0;
                } else if (currentX > 50) {
                    rightIndicator.style.opacity = Math.min(1, (currentX - 50) / 100);
                    leftIndicator.style.opacity = 0;
                    upIndicator.style.opacity = 0;
                } else if (currentY < -50) {
                    upIndicator.style.opacity = Math.min(1, (-currentY - 50) / 100);
                    leftIndicator.style.opacity = 0;
                    rightIndicator.style.opacity = 0;
                } else {
                    leftIndicator.style.opacity = 0;
                    rightIndicator.style.opacity = 0;
                    upIndicator.style.opacity = 0;
                }
            };

            const onEnd = () => {
                if (!isDragging) return;
                isDragging = false;
                card.classList.remove('dragging');

                const threshold = 100;

                if (currentX < -threshold) {
                    animateSwipe(card, 'left');
                } else if (currentX > threshold) {
                    animateSwipe(card, 'right');
                } else if (currentY < -threshold) {
                    animateSwipe(card, 'up');
                } else {
                    // Reset position
                    card.style.transition = 'transform 0.3s ease';
                    card.style.transform = '';
                    card.querySelector('.swipe-indicator-left').style.opacity = 0;
                    card.querySelector('.swipe-indicator-right').style.opacity = 0;
                    card.querySelector('.swipe-indicator-up').style.opacity = 0;
                    setTimeout(() => card.style.transition = '', 300);
                }

                currentX = 0;
                currentY = 0;
            };

            card.addEventListener('mousedown', onStart);
            card.addEventListener('mousemove', onMove);
            card.addEventListener('mouseup', onEnd);
            card.addEventListener('mouseleave', onEnd);

            card.addEventListener('touchstart', onStart, { passive: true });
            card.addEventListener('touchmove', onMove, { passive: false });
            card.addEventListener('touchend', onEnd);
        }

        function animateSwipe(card, direction) {
            const animations = {
                left: 'swipe-left',
                right: 'swipe-right',
                up: 'swipe-up'
            };

            card.style.animation = `${animations[direction]} 0.4s ease-out forwards`;

            setTimeout(() => {
                if (direction === 'right' || direction === 'up') {
                    showMatchModal(state.profiles[state.currentCardIndex]);
                }
                state.currentCardIndex++;
                renderCards();
            }, 400);
        }

        function swipeCard(direction) {
            const container = document.getElementById('card-container');
            const topCard = container.querySelector('.swipe-card:last-child');
            if (topCard) {
                animateSwipe(topCard, direction);
            }
        }

        function resetCards() {
            state.currentCardIndex = 0;
            renderCards();
        }

        // Quick Match
        function quickMatch(profileId) {
            const profile = state.profiles.find(p => p.id === profileId);
            if (profile) {
                showMatchModal(profile);
                state.currentCardIndex++;
                setTimeout(() => renderCards(), 500);
            }
        }

        // Match Modal
        function showMatchModal(profile) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in';
            modal.id = 'match-modal';
            modal.innerHTML = `
                <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('match-modal')"></div>
                <div class="relative bg-white dark:bg-slate-800 rounded-3xl shadow-2xl max-w-md w-full overflow-hidden animate-scale-in">
                    <!-- Confetti -->
                    <div class="confetti-container absolute inset-0 pointer-events-none overflow-hidden">
                        ${Array(20).fill(0).map((_, i) => `
                            <div class="confetti-piece" style="
                                left: ${Math.random() * 100}%;
                                top: 50%;
                                background: ${['#3b8bff', '#14d18a', '#f59e0b', '#f43f5e', '#8b5cf6'][Math.floor(Math.random() * 5)]};
                                animation: confetti 1s ease-out ${Math.random() * 0.5}s forwards;
                                transform: rotate(${Math.random() * 360}deg);
                            "></div>
                        `).join('')}
                    </div>

                    <!-- Header -->
                    <div class="h-40 bg-gradient-to-br ${profile.gradient} relative flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-5xl mb-3 animate-bounce-in">üéâ</div>
                            <h3 class="text-2xl font-bold text-white font-display">Study Match!</h3>
                        </div>
                    </div>

                    <div class="p-8 text-center">
                        <!-- Profile Images -->
                        <div class="flex items-center justify-center -space-x-4 mb-6">
                            <div class="w-20 h-20 rounded-2xl border-4 border-white dark:border-slate-800 overflow-hidden shadow-lg bg-gradient-to-br from-primary-400 to-accent-500 flex items-center justify-center">
                                <span class="text-2xl font-bold text-white">${state.user.name.charAt(0)}</span>
                            </div>
                            <div class="w-20 h-20 rounded-2xl border-4 border-white dark:border-slate-800 overflow-hidden shadow-lg bg-gradient-to-br ${profile.gradient} flex items-center justify-center">
                                <span class="text-2xl font-bold text-white">${profile.name.charAt(0)}</span>
                            </div>
                        </div>

                        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-2">You and ${profile.name.split(' ')[0]} matched!</h2>
                        <p class="text-slate-600 dark:text-slate-400 mb-8">Perfect match for ${profile.subjects[0]}</p>

                        <!-- Actions -->
                        <div class="space-y-3">
                            <button onclick="showBookingModal(${profile.id})" class="w-full py-4 btn-primary text-white font-semibold rounded-xl flex items-center justify-center gap-2 transition-all">
                                <i class="fas fa-calendar-check"></i>
                                <span>Schedule Session</span>
                            </button>

                            <button onclick="closeModal('match-modal')" class="w-full py-4 bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-white font-semibold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors flex items-center justify-center gap-2">
                                <i class="fas fa-comment"></i>
                                <span>Message First</span>
                            </button>

                            <button onclick="closeModal('match-modal')" class="text-primary-500 dark:text-primary-400 font-medium py-2 hover:underline">
                                Continue Browsing
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('modals-container').appendChild(modal);
        }

        // Booking Modal
        function showBookingModal(profileId) {
            closeModal('match-modal');

            const profile = state.profiles.find(p => p.id === profileId) || state.profiles[0];

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-end sm:items-center justify-center animate-fade-in';
            modal.id = 'booking-modal';
            modal.innerHTML = `
                <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal('booking-modal')"></div>
                <div class="relative bg-white dark:bg-slate-800 rounded-t-3xl sm:rounded-3xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto animate-slide-up">
                    <!-- Header -->
                    <div class="sticky top-0 bg-white dark:bg-slate-800 p-6 border-b border-slate-100 dark:border-slate-700 z-10">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-xl font-bold text-slate-900 dark:text-white">Book Session</h3>
                                <p class="text-slate-500 dark:text-slate-400 text-sm">with ${profile.name}</p>
                            </div>
                            <span class="px-3 py-1.5 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full text-sm font-medium">${profile.subjects[0]}</span>
                        </div>
                    </div>

                    <div class="p-6">
                        <!-- Date Selection -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-slate-900 dark:text-white mb-3">Select Date</h4>
                            <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
                                <button class="date-btn px-4 py-3 rounded-xl bg-primary-500 text-white whitespace-nowrap min-w-[80px]" data-selected="true">
                                    <div class="text-sm font-semibold">Today</div>
                                    <div class="text-xs opacity-90">Dec 15</div>
                                </button>
                                <button class="date-btn px-4 py-3 rounded-xl bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 whitespace-nowrap hover:bg-slate-200 dark:hover:bg-slate-600 min-w-[80px]">
                                    <div class="text-sm font-medium">Tomorrow</div>
                                    <div class="text-xs">Dec 16</div>
                                </button>
                                <button class="date-btn px-4 py-3 rounded-xl bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 whitespace-nowrap hover:bg-slate-200 dark:hover:bg-slate-600 min-w-[80px]">
                                    <div class="text-sm font-medium">Tue</div>
                                    <div class="text-xs">Dec 17</div>
                                </button>
                                <button class="date-btn px-4 py-3 rounded-xl bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 whitespace-nowrap hover:bg-slate-200 dark:hover:bg-slate-600 min-w-[80px]">
                                    <div class="text-sm font-medium">Wed</div>
                                    <div class="text-xs">Dec 18</div>
                                </button>
                            </div>
                        </div>

                        <!-- Time Slots -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-slate-900 dark:text-white mb-3">Select Time</h4>
                            <div class="grid grid-cols-3 gap-2">
                                ${profile.availability.map((time, idx) => `
                                    <button class="time-btn py-3 rounded-xl ${idx === 2 ? 'bg-gradient-to-br from-primary-500 to-accent-500 text-white shadow-lg' : 'bg-slate-50 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-primary-50 dark:hover:bg-primary-900/30 hover:text-primary-600 dark:hover:text-primary-400'} transition-colors">
                                        <div class="text-sm font-medium">${time}</div>
                                        <div class="text-xs opacity-70">45 min</div>
                                    </button>
                                `).join('')}
                                <button class="time-btn py-3 rounded-xl bg-slate-50 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-primary-50 dark:hover:bg-primary-900/30 transition-colors">
                                    <div class="text-sm font-medium">8:00 PM</div>
                                    <div class="text-xs opacity-70">1 hr</div>
                                </button>
                                <button class="time-btn py-3 rounded-xl bg-slate-50 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-primary-50 dark:hover:bg-primary-900/30 transition-colors">
                                    <div class="text-sm font-medium">9:00 PM</div>
                                    <div class="text-xs opacity-70">45 min</div>
                                </button>
                            </div>
                        </div>

                        <!-- Session Type -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-slate-900 dark:text-white mb-3">Session Type</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <button class="session-type-btn p-4 rounded-xl border-2 border-primary-500 bg-primary-50 dark:bg-primary-900/20 text-left">
                                    <div class="text-xl mb-2">üéØ</div>
                                    <div class="text-sm font-semibold text-slate-900 dark:text-white">1:1 Tutoring</div>
                                    <div class="text-xs text-slate-500 dark:text-slate-400">Personalized help</div>
                                </button>
                                <button class="session-type-btn p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-primary-300 dark:hover:border-primary-700 text-left transition-colors">
                                    <div class="text-xl mb-2">üë•</div>
                                    <div class="text-sm font-semibold text-slate-900 dark:text-white">Group Study</div>
                                    <div class="text-xs text-slate-500 dark:text-slate-400">2+ students ¬∑ $15/hr</div>
                                </button>
                            </div>
                        </div>

                        <!-- Payment -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-slate-900 dark:text-white mb-3">Payment Method</h4>
                            <div class="space-y-2">
                                <button class="payment-btn w-full flex items-center justify-between p-4 rounded-xl border-2 border-primary-500 bg-primary-50 dark:bg-primary-900/20">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg profile-gradient flex items-center justify-center">
                                            <span class="text-white text-sm font-bold">S</span>
                                        </div>
                                        <div class="text-left">
                                            <div class="font-medium text-slate-900 dark:text-white">StudySync Points</div>
                                            <div class="text-sm text-slate-500 dark:text-slate-400">Balance: ${state.user.points.toLocaleString()} pts</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-primary-600 dark:text-primary-400">${profile.points} pts</div>
                                        <div class="text-xs text-slate-500">$${profile.price} value</div>
                                    </div>
                                </button>

                                <button class="payment-btn w-full flex items-center justify-between p-4 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-primary-300 dark:hover:border-primary-600 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex items-center justify-center">
                                            <i class="fas fa-credit-card text-slate-600 dark:text-slate-400"></i>
                                        </div>
                                        <div class="text-left">
                                            <div class="font-medium text-slate-900 dark:text-white">Credit Card</div>
                                            <div class="text-sm text-slate-500 dark:text-slate-400">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4567</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-slate-900 dark:text-white">$${profile.price}.00</div>
                                        <div class="text-xs text-slate-500">+$${(profile.price * 0.15).toFixed(2)} fee</div>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- Confirm Button -->
                        <button onclick="confirmBooking()" class="w-full py-4 btn-primary text-white font-semibold rounded-xl flex items-center justify-center gap-2 transition-all">
                            <i class="fas fa-check-circle"></i>
                            <span>Confirm Session ¬∑ $${profile.price}.00</span>
                        </button>

                        <p class="text-center text-xs text-slate-500 dark:text-slate-400 mt-4">
                            24-hour cancellation policy ¬∑ Secure payment
                        </p>
                    </div>
                </div>
            `;

            document.getElementById('modals-container').appendChild(modal);

            // Setup interactive buttons
            setupBookingInteractions();
        }

        function setupBookingInteractions() {
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.date-btn').forEach(b => {
                        b.classList.remove('bg-primary-500', 'text-white');
                        b.classList.add('bg-slate-100', 'dark:bg-slate-700', 'text-slate-700', 'dark:text-slate-300');
                    });
                    this.classList.remove('bg-slate-100', 'dark:bg-slate-700', 'text-slate-700', 'dark:text-slate-300');
                    this.classList.add('bg-primary-500', 'text-white');
                });
            });
        }

        function confirmBooking() {
            closeModal('booking-modal');
            showModal('success', 'Session booked successfully! You\'ll receive a confirmation shortly.');
        }

        // Render Matches
        function renderMatches() {
            const newMatchesContainer = document.getElementById('new-matches-container');
            newMatchesContainer.innerHTML = state.matches.filter(m => m.new).map(match => `
                <button onclick="showBookingModal(${match.id})" class="flex-shrink-0 text-center group">
                    <div class="w-16 h-16 rounded-2xl bg-gradient-to-br ${match.gradient} flex items-center justify-center mb-2 group-hover:scale-110 transition-transform shadow-lg">
                        <span class="text-xl font-bold text-white">${match.name.charAt(0)}</span>
                    </div>
                    <p class="text-xs font-medium text-slate-900 dark:text-white truncate w-16">${match.name.split(' ')[0]}</p>
                    <p class="text-xs text-slate-500 dark:text-slate-400 truncate w-16">${match.subject.split(' ')[0]}</p>
                </button>
            `).join('');
        }

        function renderConversations() {
            const container = document.getElementById('conversations-container');
            container.innerHTML = state.conversations.map(conv => `
                <button class="w-full flex items-center gap-4 p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm hover:shadow transition-shadow text-left">
                    <div class="w-14 h-14 rounded-xl bg-gradient-to-br ${conv.gradient} flex items-center justify-center flex-shrink-0">
                        <span class="text-lg font-bold text-white">${conv.name.charAt(0)}</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between mb-1">
                            <h4 class="font-semibold text-slate-900 dark:text-white">${conv.name}</h4>
                            <span class="text-xs text-slate-500 dark:text-slate-400">${conv.time}</span>
                        </div>
                        <p class="text-sm text-slate-600 dark:text-slate-400 truncate">${conv.lastMessage}</p>
                    </div>
                    ${conv.unread > 0 ? `
                        <div class="w-6 h-6 bg-coral-500 text-white text-xs font-bold rounded-full flex items-center justify-center flex-shrink-0">
                            ${conv.unread}
                        </div>
                    ` : ''}
                </button>
            `).join('');
        }

        function renderReviews() {
            const container = document.getElementById('reviews-container');
            container.innerHTML = sampleReviews.map(review => `
                <div class="bg-white dark:bg-slate-800 rounded-xl p-4 shadow-sm">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-lg bg-gradient-to-br ${review.gradient} flex items-center justify-center">
                                <span class="text-sm font-bold text-white">${review.name.charAt(0)}</span>
                            </div>
                            <span class="font-medium text-slate-900 dark:text-white">${review.name}</span>
                        </div>
                        <div class="flex text-premium-500">
                            ${Array(review.rating).fill('<i class="fas fa-star text-sm"></i>').join('')}
                        </div>
                    </div>
                    <p class="text-sm text-slate-600 dark:text-slate-400 leading-relaxed">"${review.text}"</p>
                </div>
            `).join('');
        }

        function updateProfile() {
            document.getElementById('profile-name').textContent = state.user.name;
            document.getElementById('profile-university').textContent = state.user.university;
            document.getElementById('profile-major').textContent = `${state.user.major} Major`;
            document.getElementById('profile-initial').textContent = state.user.name.charAt(0);
        }

        // View Navigation
        function showView(viewName) {
            state.currentView = viewName;

            // Hide all views
            document.getElementById('discovery-view').classList.add('hidden');
            document.getElementById('matches-view').classList.add('hidden');
            document.getElementById('profile-view').classList.add('hidden');

            // Update header
            const header = document.getElementById('main-header');
            const subjectTabs = document.getElementById('subject-tabs');
            const swipeButtons = document.getElementById('swipe-buttons');

            // Reset nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'text-primary-500');
                item.classList.add('text-slate-500', 'dark:text-slate-400');
            });

            // Show selected view
            switch(viewName) {
                case 'discovery':
                    document.getElementById('discovery-view').classList.remove('hidden');
                    document.getElementById('header-title').textContent = 'Discover';
                    document.getElementById('header-subtitle').textContent = 'Swipe to learn or teach';
                    subjectTabs.classList.remove('hidden');
                    swipeButtons.classList.remove('hidden');
                    header.classList.remove('hidden');
                    break;
                case 'matches':
                    document.getElementById('matches-view').classList.remove('hidden');
                    document.getElementById('header-title').textContent = 'Matches';
                    document.getElementById('header-subtitle').textContent = 'Your study connections';
                    subjectTabs.classList.add('hidden');
                    swipeButtons.classList.add('hidden');
                    header.classList.remove('hidden');
                    break;
                case 'sessions':
                    showModal('info', 'Sessions view coming soon! Track your upcoming and past study sessions here.');
                    return;
                case 'profile':
                    document.getElementById('profile-view').classList.remove('hidden');
                    header.classList.add('hidden');
                    swipeButtons.classList.add('hidden');
                    break;
            }

            // Update active nav item
            const navItems = document.querySelectorAll('.nav-item');
            const viewIndex = ['discovery', 'matches', 'sessions', 'profile'].indexOf(viewName);
            if (viewIndex >= 0 && navItems[viewIndex]) {
                navItems[viewIndex].classList.add('active', 'text-primary-500');
                navItems[viewIndex].classList.remove('text-slate-500', 'dark:text-slate-400');
            }
        }

        // Modals
        function showModal(type, message) {
            const icons = {
                success: '<i class="fas fa-check-circle text-4xl text-accent-500"></i>',
                error: '<i class="fas fa-exclamation-circle text-4xl text-coral-500"></i>',
                info: '<i class="fas fa-info-circle text-4xl text-primary-500"></i>'
            };

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in';
            modal.id = 'alert-modal';
            modal.innerHTML = `
                <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeModal('alert-modal')"></div>
                <div class="relative bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-scale-in text-center">
                    <div class="mb-4">${icons[type]}</div>
                    <p class="text-slate-700 dark:text-slate-300 mb-6">${message}</p>
                    <button onclick="closeModal('alert-modal')" class="px-6 py-3 btn-primary text-white font-semibold rounded-xl">
                        Got it
                    </button>
                </div>
            `;

            document.getElementById('modals-container').appendChild(modal);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('animate-fade-out');
                setTimeout(() => modal.remove(), 200);
            }
        }

        function showFilters() {
            showModal('info', 'Filter by subjects, availability, price range, and more. Coming soon!');
        }

        function showNotifications() {
            showModal('info', 'You have 3 new notifications: 2 match requests and 1 session reminder.');
        }

        function editProfile() {
            showModal('info', 'Profile editing will be available in the next update!');
        }

        // Subject Tab Selection
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('subject-tab')) {
                document.querySelectorAll('.subject-tab').forEach(tab => {
                    tab.classList.remove('bg-primary-500', 'text-white', 'shadow-sm');
                    tab.classList.add('bg-white', 'dark:bg-slate-800', 'text-slate-700', 'dark:text-slate-300');
                });
                e.target.classList.remove('bg-white', 'dark:bg-slate-800', 'text-slate-700', 'dark:text-slate-300');
                e.target.classList.add('bg-primary-500', 'text-white', 'shadow-sm');
            }
        });

        // Initialize
        init();
    </script>
</body>
</html>

