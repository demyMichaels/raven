<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounting Ledger Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <!-- Check for dark mode -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-6 text-primary">Accounting Ledger Management</h1>
        
        <!-- Tab Navigation -->
        <div class="mb-6 overflow-x-auto">
            <nav class="flex space-x-2" id="ledger-tabs">
                <button class="tab-btn py-2 px-4 rounded-t-lg font-medium bg-primary text-white" data-tab="debtors">
                    Debtors Ledger
                </button>
                <button class="tab-btn py-2 px-4 rounded-t-lg font-medium bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-tab="creditors">
                    Creditors Ledger
                </button>
                <button class="tab-btn py-2 px-4 rounded-t-lg font-medium bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-tab="general">
                    General Ledger
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div id="tab-content" class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
            <!-- Debtors Ledger -->
            <div id="debtors-tab" class="ledger-content">
                <div class="flex flex-col md:flex-row md:justify-between mb-4 gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Debtors Ledger</h2>
                        <p class="text-gray-600 dark:text-gray-400">Manage customer accounts receivable</p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <select id="debtors-filter" class="border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base">
                            <option value="all">All Entries</option>
                            <option value="a-e">A - E</option>
                            <option value="f-j">F - J</option>
                            <option value="k-o">K - O</option>
                            <option value="p-t">P - T</option>
                            <option value="u-z">U - Z</option>
                        </select>
                        <button id="add-debtor-btn" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded">
                            Add Entry
                        </button>
                    </div>
                </div>

                <!-- Debtors Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                        <thead>
                            <tr class="bg-gray-100 dark:bg-gray-700">
                                <th class="py-2 px-4 border-b text-left">Customer</th>
                                <th class="py-2 px-4 border-b text-left">Invoice #</th>
                                <th class="py-2 px-4 border-b text-left">Date</th>
                                <th class="py-2 px-4 border-b text-right">Amount</th>
                                <th class="py-2 px-4 border-b text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="debtors-table-body">
                            <!-- Populated by JavaScript -->
                        </tbody>
                        <tfoot>
                            <tr class="bg-gray-50 dark:bg-gray-700 font-bold">
                                <td colspan="3" class="py-2 px-4 text-right">Total:</td>
                                <td id="debtors-total" class="py-2 px-4 text-right">$0.00</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- Creditors Ledger -->
            <div id="creditors-tab" class="ledger-content hidden">
                <div class="flex flex-col md:flex-row md:justify-between mb-4 gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Creditors Ledger</h2>
                        <p class="text-gray-600 dark:text-gray-400">Manage supplier accounts payable</p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <select id="creditors-filter" class="border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base">
                            <option value="all">All Entries</option>
                            <option value="a-e">A - E</option>
                            <option value="f-j">F - J</option>
                            <option value="k-o">K - O</option>
                            <option value="p-t">P - T</option>
                            <option value="u-z">U - Z</option>
                        </select>
                        <button id="add-creditor-btn" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded">
                            Add Entry
                        </button>
                    </div>
                </div>

                <!-- Creditors Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                        <thead>
                            <tr class="bg-gray-100 dark:bg-gray-700">
                                <th class="py-2 px-4 border-b text-left">Supplier</th>
                                <th class="py-2 px-4 border-b text-left">Invoice #</th>
                                <th class="py-2 px-4 border-b text-left">Date</th>
                                <th class="py-2 px-4 border-b text-right">Amount</th>
                                <th class="py-2 px-4 border-b text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="creditors-table-body">
                            <!-- Populated by JavaScript -->
                        </tbody>
                        <tfoot>
                            <tr class="bg-gray-50 dark:bg-gray-700 font-bold">
                                <td colspan="3" class="py-2 px-4 text-right">Total:</td>
                                <td id="creditors-total" class="py-2 px-4 text-right">$0.00</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- General Ledger -->
            <div id="general-tab" class="ledger-content hidden">
                <div class="flex flex-col md:flex-row md:justify-between mb-4 gap-4">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">General Ledger</h2>
                        <p class="text-gray-600 dark:text-gray-400">Manage all other accounts</p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <select id="general-filter" class="border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base">
                            <option value="all">All Accounts</option>
                            <option value="assets">Assets</option>
                            <option value="liabilities">Liabilities</option>
                            <option value="equity">Equity</option>
                            <option value="revenue">Revenue</option>
                            <option value="expenses">Expenses</option>
                        </select>
                        <button id="add-general-btn" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded">
                            Add Entry
                        </button>
                    </div>
                </div>

                <!-- General Ledger Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700">
                        <thead>
                            <tr class="bg-gray-100 dark:bg-gray-700">
                                <th class="py-2 px-4 border-b text-left">Account</th>
                                <th class="py-2 px-4 border-b text-left">Type</th>
                                <th class="py-2 px-4 border-b text-left">Date</th>
                                <th class="py-2 px-4 border-b text-left">Description</th>
                                <th class="py-2 px-4 border-b text-right">Debit</th>
                                <th class="py-2 px-4 border-b text-right">Credit</th>
                                <th class="py-2 px-4 border-b text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="general-table-body">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for adding/editing entries -->
    <div id="entry-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-lg w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-xl font-bold">Add Entry</h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="entry-form">
                <input type="hidden" id="edit-id">
                <input type="hidden" id="ledger-type">
                
                <!-- Debtors Fields -->
                <div id="debtors-fields">
                    <div class="mb-4">
                        <label for="debtor-name" class="block mb-1">Customer Name</label>
                        <input type="text" id="debtor-name" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="debtor-invoice" class="block mb-1">Invoice Number</label>
                        <input type="text" id="debtor-invoice" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="debtor-date" class="block mb-1">Date</label>
                        <input type="date" id="debtor-date" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="debtor-amount" class="block mb-1">Amount ($)</label>
                        <input type="number" id="debtor-amount" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" min="0" step="0.01" required>
                    </div>
                </div>
                
                <!-- Creditors Fields -->
                <div id="creditors-fields" class="hidden">
                    <div class="mb-4">
                        <label for="creditor-name" class="block mb-1">Supplier Name</label>
                        <input type="text" id="creditor-name" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="creditor-invoice" class="block mb-1">Invoice Number</label>
                        <input type="text" id="creditor-invoice" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="creditor-date" class="block mb-1">Date</label>
                        <input type="date" id="creditor-date" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="creditor-amount" class="block mb-1">Amount ($)</label>
                        <input type="number" id="creditor-amount" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" min="0" step="0.01" required>
                    </div>
                </div>
                
                <!-- General Ledger Fields -->
                <div id="general-fields" class="hidden">
                    <div class="mb-4">
                        <label for="general-account" class="block mb-1">Account Name</label>
                        <input type="text" id="general-account" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="general-type" class="block mb-1">Account Type</label>
                        <select id="general-type" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                            <option value="">Select Account Type</option>
                            <option value="assets">Assets</option>
                            <option value="liabilities">Liabilities</option>
                            <option value="equity">Equity</option>
                            <option value="revenue">Revenue</option>
                            <option value="expenses">Expenses</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="general-date" class="block mb-1">Date</label>
                        <input type="date" id="general-date" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="mb-4">
                        <label for="general-description" class="block mb-1">Description</label>
                        <input type="text" id="general-description" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" required>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="general-debit" class="block mb-1">Debit Amount ($)</label>
                            <input type="number" id="general-debit" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label for="general-credit" class="block mb-1">Credit Amount ($)</label>
                            <input type="number" id="general-credit" class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 bg-white dark:bg-gray-700 text-base" min="0" step="0.01" required>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end gap-2 mt-6">
                    <button type="button" id="cancel-btn" class="px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded hover:bg-gray-400 dark:hover:bg-gray-600">
                        Cancel
                    </button>
                    <button type="submit" id="save-btn" class="px-4 py-2 bg-primary text-white rounded hover:bg-opacity-90">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Sample Data
        let debtorsData = [
            { id: 1, name: "Acme Corporation", invoice: "INV-001", date: "2023-05-15", amount: 1250.00 },
            { id: 2, name: "Beta Enterprises", invoice: "INV-002", date: "2023-05-20", amount: 750.50 },
            { id: 3, name: "Gamma Industries", invoice: "INV-003", date: "2023-05-25", amount: 2000.00 },
            { id: 4, name: "Delta Services", invoice: "INV-004", date: "2023-06-01", amount: 1500.75 },
            { id: 5, name: "Epsilon Tech", invoice: "INV-005", date: "2023-06-05", amount: 3000.25 },
            { id: 6, name: "Foxtrot Solutions", invoice: "INV-006", date: "2023-06-10", amount: 1800.00 },
            { id: 7, name: "Hotel Group", invoice: "INV-007", date: "2023-06-15", amount: 2200.50 }
        ];

        let creditorsData = [
            { id: 1, name: "Alpha Suppliers", invoice: "INV-100", date: "2023-05-10", amount: 950.00 },
            { id: 2, name: "Bravo Equipment", invoice: "INV-101", date: "2023-05-18", amount: 1200.25 },
            { id: 3, name: "Charlie Vendors", invoice: "INV-102", date: "2023-05-22", amount: 800.50 },
            { id: 4, name: "Echo Materials", invoice: "INV-103", date: "2023-06-02", amount: 1650.75 },
            { id: 5, name: "Golf Distributors", invoice: "INV-104", date: "2023-06-08", amount: 2100.00 }
        ];

        let generalData = [
            { id: 1, account: "Rent Expense", type: "expenses", date: "2023-05-01", description: "Monthly Office Rent", debit: 2000.00, credit: 0 },
            { id: 2, account: "Cash", type: "assets", date: "2023-05-01", description: "Monthly Office Rent", debit: 0, credit: 2000.00 },
            { id: 3, account: "Equipment", type: "assets", date: "2023-05-15", description: "Purchase of New Equipment", debit: 5000.00, credit: 0 },
            { id: 4, account: "Accounts Payable", type: "liabilities", date: "2023-05-15", description: "Purchase of New Equipment", debit: 0, credit: 5000.00 },
            { id: 5, account: "Revenue", type: "revenue", date: "2023-05-20", description: "Services Rendered", debit: 0, credit: 3500.00 },
            { id: 6, account: "Accounts Receivable", type: "assets", date: "2023-05-20", description: "Services Rendered", debit: 3500.00, credit: 0 }
        ];

        // DOM Elements
        const tabButtons = document.querySelectorAll('.tab-btn');
        const ledgerContents = document.querySelectorAll('.ledger-content');
        const debtorsTableBody = document.getElementById('debtors-table-body');
        const creditorsTableBody = document.getElementById('creditors-table-body');
        const generalTableBody = document.getElementById('general-table-body');
        const debtorsTotal = document.getElementById('debtors-total');
        const creditorsTotal = document.getElementById('creditors-total');
        const debtorsFilter = document.getElementById('debtors-filter');
        const creditorsFilter = document.getElementById('creditors-filter');
        const generalFilter = document.getElementById('general-filter');
        
        const entryModal = document.getElementById('entry-modal');
        const entryForm = document.getElementById('entry-form');
        const modalTitle = document.getElementById('modal-title');
        const ledgerTypeField = document.getElementById('ledger-type');
        const debtorsFields = document.getElementById('debtors-fields');
        const creditorsFields = document.getElementById('creditors-fields');
        const generalFields = document.getElementById('general-fields');
        const editIdField = document.getElementById('edit-id');
        
        // Add Entry Buttons
        const addDebtorBtn = document.getElementById('add-debtor-btn');
        const addCreditorBtn = document.getElementById('add-creditor-btn');
        const addGeneralBtn = document.getElementById('add-general-btn');
        
        // Modal Close Buttons
        const closeModalBtn = document.getElementById('close-modal');
        const cancelBtn = document.getElementById('cancel-btn');

        // Tab Functionality
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.getAttribute('data-tab');
                
                // Update tab buttons
                tabButtons.forEach(btn => {
                    if (btn === button) {
                        btn.classList.remove('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300');
                        btn.classList.add('bg-primary', 'text-white');
                    } else {
                        btn.classList.remove('bg-primary', 'text-white');
                        btn.classList.add('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300');
                    }
                });
                
                // Show corresponding tab content
                ledgerContents.forEach(content => {
                    content.classList.add('hidden');
                });
                document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            });
        });

        // Helper functions
        function formatCurrency(amount) {
            return '$' + parseFloat(amount).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }

        function getLetterRange(name) {
            const firstLetter = name.charAt(0).toUpperCase();
            if (firstLetter >= 'A' && firstLetter <= 'E') return 'a-e';
            if (firstLetter >= 'F' && firstLetter <= 'J') return 'f-j';
            if (firstLetter >= 'K' && firstLetter <= 'O') return 'k-o';
            if (firstLetter >= 'P' && firstLetter <= 'T') return 'p-t';
            if (firstLetter >= 'U' && firstLetter <= 'Z') return 'u-z';
            return 'other';
        }

        // Render tables
        function renderDebtorsTable(filter = 'all') {
            let filteredData = debtorsData;
            if (filter !== 'all') {
                filteredData = debtorsData.filter(item => getLetterRange(item.name) === filter);
            }
            
            debtorsTableBody.innerHTML = '';
            let total = 0;
            
            filteredData.forEach(item => {
                total += parseFloat(item.amount);
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700';
                row.innerHTML = `
                    <td class="py-2 px-4">${item.name}</td>
                    <td class="py-2 px-4">${item.invoice}</td>
                    <td class="py-2 px-4">${item.date}</td>
                    <td class="py-2 px-4 text-right">${formatCurrency(item.amount)}</td>
                    <td class="py-2 px-4 text-center">
                        <button class="text-primary hover:text-primary-dark mr-2 edit-debtor" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-500 hover:text-red-700 delete-debtor" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                debtorsTableBody.appendChild(row);
            });
            
            debtorsTotal.textContent = formatCurrency(total);
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-debtor').forEach(btn => {
                btn.addEventListener('click', () => editDebtor(btn.getAttribute('data-id')));
            });
            
            document.querySelectorAll('.delete-debtor').forEach(btn => {
                btn.addEventListener('click', () => deleteDebtor(btn.getAttribute('data-id')));
            });
        }

        function renderCreditorsTable(filter = 'all') {
            let filteredData = creditorsData;
            if (filter !== 'all') {
                filteredData = creditorsData.filter(item => getLetterRange(item.name) === filter);
            }
            
            creditorsTableBody.innerHTML = '';
            let total = 0;
            
            filteredData.forEach(item => {
                total += parseFloat(item.amount);
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700';
                row.innerHTML = `
                    <td class="py-2 px-4">${item.name}</td>
                    <td class="py-2 px-4">${item.invoice}</td>
                    <td class="py-2 px-4">${item.date}</td>
                    <td class="py-2 px-4 text-right">${formatCurrency(item.amount)}</td>
                    <td class="py-2 px-4 text-center">
                        <button class="text-primary hover:text-primary-dark mr-2 edit-creditor" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-500 hover:text-red-700 delete-creditor" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                creditorsTableBody.appendChild(row);
            });
            
            creditorsTotal.textContent = formatCurrency(total);
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-creditor').forEach(btn => {
                btn.addEventListener('click', () => editCreditor(btn.getAttribute('data-id')));
            });
            
            document.querySelectorAll('.delete-creditor').forEach(btn => {
                btn.addEventListener('click', () => deleteCreditor(btn.getAttribute('data-id')));
            });
        }

        function renderGeneralTable(filter = 'all') {
            let filteredData = generalData;
            if (filter !== 'all') {
                filteredData = generalData.filter(item => item.type === filter);
            }
            
            generalTableBody.innerHTML = '';
            
            filteredData.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700';
                row.innerHTML = `
                    <td class="py-2 px-4">${item.account}</td>
                    <td class="py-2 px-4">${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</td>
                    <td class="py-2 px-4">${item.date}</td>
                    <td class="py-2 px-4">${item.description}</td>
                    <td class="py-2 px-4 text-right">${item.debit > 0 ? formatCurrency(item.debit) : '-'}</td>
                    <td class="py-2 px-4 text-right">${item.credit > 0 ? formatCurrency(item.credit) : '-'}</td>
                    <td class="py-2 px-4 text-center">
                        <button class="text-primary hover:text-primary-dark mr-2 edit-general" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-500 hover:text-red-700 delete-general" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                generalTableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-general').forEach(btn => {
                btn.addEventListener('click', () => editGeneral(btn.getAttribute('data-id')));
            });
            
            document.querySelectorAll('.delete-general').forEach(btn => {
                btn.addEventListener('click', () => deleteGeneral(btn.getAttribute('data-id')));
            });
        }

        // CRUD operations
        function showModal(type, isEdit = false) {
            modalTitle.textContent = isEdit ? `Edit ${type} Entry` : `Add ${type} Entry`;
            ledgerTypeField.value = type;
            
            // Show appropriate fields
            debtorsFields.classList.add('hidden');
            creditorsFields.classList.add('hidden');
            generalFields.classList.add('hidden');
            
            if (type === 'Debtor') {
                debtorsFields.classList.remove('hidden');
            } else if (type === 'Creditor') {
                creditorsFields.classList.remove('hidden');
            } else if (type === 'General') {
                generalFields.classList.remove('hidden');
            }
            
            // Show modal
            entryModal.classList.remove('hidden');
            
            // If not editing, clear the form
            if (!isEdit) {
                entryForm.reset();
                editIdField.value = '';
            }
        }

        function hideModal() {
            entryModal.classList.add('hidden');
        }

        // Debtor Operations
        function addDebtor() {
            showModal('Debtor');
        }

        function editDebtor(id) {
            const debtor = debtorsData.find(item => item.id == id);
            if (debtor) {
                showModal('Debtor', true);
                
                editIdField.value = debtor.id;
                document.getElementById('debtor-name').value = debtor.name;
                document.getElementById('debtor-invoice').value = debtor.invoice;
                document.getElementById('debtor-date').value = debtor.date;
                document.getElementById('debtor-amount').value = debtor.amount;
            }
        }

        function deleteDebtor(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                debtorsData = debtorsData.filter(item => item.id != id);
                renderDebtorsTable(debtorsFilter.value);
            }
        }

        // Creditor Operations
        function addCreditor() {
            showModal('Creditor');
        }

        function editCreditor(id) {
            const creditor = creditorsData.find(item => item.id == id);
            if (creditor) {
                showModal('Creditor', true);
                
                editIdField.value = creditor.id;
                document.getElementById('creditor-name').value = creditor.name;
                document.getElementById('creditor-invoice').value = creditor.invoice;
                document.getElementById('creditor-date').value = creditor.date;
                document.getElementById('creditor-amount').value = creditor.amount;
            }
        }

        function deleteCreditor(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                creditorsData = creditorsData.filter(item => item.id != id);
                renderCreditorsTable(creditorsFilter.value);
            }
        }

        // General Ledger Operations
        function addGeneral() {
            showModal('General');
        }

        function editGeneral(id) {
            const entry = generalData.find(item => item.id == id);
            if (entry) {
                showModal('General', true);
                
                editIdField.value = entry.id;
                document.getElementById('general-account').value = entry.account;
                document.getElementById('general-type').value = entry.type;
                document.getElementById('general-date').value = entry.date;
                document.getElementById('general-description').value = entry.description;
                document.getElementById('general-debit').value = entry.debit;
                document.getElementById('general-credit').value = entry.credit;
            }
        }

        function deleteGeneral(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                generalData = generalData.filter(item => item.id != id);
                renderGeneralTable(generalFilter.value);
            }
        }

        // Form submission
        entryForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = ledgerTypeField.value;
            const isEdit = editIdField.value !== '';
            
            if (type === 'Debtor') {
                const entry = {
                    name: document.getElementById('debtor-name').value,
                    invoice: document.getElementById('debtor-invoice').value,
                    date: document.getElementById('debtor-date').value,
                    amount: parseFloat(document.getElementById('debtor-amount').value)
                };
                
                if (isEdit) {
                    const id = parseInt(editIdField.value);
                    entry.id = id;
                    const index = debtorsData.findIndex(item => item.id === id);
                    if (index !== -1) {
                        debtorsData[index] = entry;
                    }
                } else {
                    entry.id = debtorsData.length > 0 ? Math.max(...debtorsData.map(item => item.id)) + 1 : 1;
                    debtorsData.push(entry);
                }
                
                renderDebtorsTable(debtorsFilter.value);
            } else if (type === 'Creditor') {
                const entry = {
                    name: document.getElementById('creditor-name').value,
                    invoice: document.getElementById('creditor-invoice').value,
                    date: document.getElementById('creditor-date').value,
                    amount: parseFloat(document.getElementById('creditor-amount').value)
                };
                
                if (isEdit) {
                    const id = parseInt(editIdField.value);
                    entry.id = id;
                    const index = creditorsData.findIndex(item => item.id === id);
                    if (index !== -1) {
                        creditorsData[index] = entry;
                    }
                } else {
                    entry.id = creditorsData.length > 0 ? Math.max(...creditorsData.map(item => item.id)) + 1 : 1;
                    creditorsData.push(entry);
                }
                
                renderCreditorsTable(creditorsFilter.value);
            } else if (type === 'General') {
                const entry = {
                    account: document.getElementById('general-account').value,
                    type: document.getElementById('general-type').value,
                    date: document.getElementById('general-date').value,
                    description: document.getElementById('general-description').value,
                    debit: parseFloat(document.getElementById('general-debit').value),
                    credit: parseFloat(document.getElementById('general-credit').value)
                };
                
                if (isEdit) {
                    const id = parseInt(editIdField.value);
                    entry.id = id;
                    const index = generalData.findIndex(item => item.id === id);
                    if (index !== -1) {
                        generalData[index] = entry;
                    }
                } else {
                    entry.id = generalData.length > 0 ? Math.max(...generalData.map(item => item.id)) + 1 : 1;
                    generalData.push(entry);
                }
                
                renderGeneralTable(generalFilter.value);
            }
            
            hideModal();
        });

        // Event Listeners
        addDebtorBtn.addEventListener('click', addDebtor);
        addCreditorBtn.addEventListener('click', addCreditor);
        addGeneralBtn.addEventListener('click', addGeneral);
        closeModalBtn.addEventListener('click', hideModal);
        cancelBtn.addEventListener('click', hideModal);
        
        debtorsFilter.addEventListener('change', () => renderDebtorsTable(debtorsFilter.value));
        creditorsFilter.addEventListener('change', () => renderCreditorsTable(creditorsFilter.value));
        generalFilter.addEventListener('change', () => renderGeneralTable(generalFilter.value));

        // Initialize tables
        renderDebtorsTable();
        renderCreditorsTable();
        renderGeneralTable();
    </script>
</body>
</html>
