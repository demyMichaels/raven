<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperature and its Measurement | Interactive Physics Module</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/similarity@2.0.0/similarity.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: "#0F2C59",
                            50: "#f0f3f8",
                            100: "#d6e1ee",
                            500: "#0F2C59",
                            600: "#0a2549",
                            700: "#081e39",
                        },
                        accent: {
                            DEFAULT: "#009F9D",
                            50: "#e6f7f7",
                            100: "#b3ebea",
                            500: "#009F9D",
                            600: "#008280",
                            700: "#006663",
                        },
                        neutral: {
                            25: "#FEFEFE",
                            50: "#F8F9FA",
                            100: "#F1F3F4",
                            200: "#E8EAED",
                            300: "#DADCE0",
                            400: "#BDC1C6",
                            500: "#9AA0A6",
                            600: "#80868B",
                            700: "#5F6368",
                            800: "#2D3748",
                            900: "#1F2937",
                        },
                        premium: {
                            DEFAULT: "#D2C1A7",
                            50: "#fbf9f6",
                            100: "#f4efe6",
                            500: "#D2C1A7",
                            600: "#c4b095",
                            700: "#b69f83",
                        },
                        data: {
                            DEFAULT: "#5A7B9E",
                            50: "#f2f5f9",
                            100: "#e1e9f2",
                            500: "#5A7B9E",
                            600: "#4d6a87",
                            700: "#405970",
                        },
                        success: "#22c55e",
                        warning: "#f59e0b",
                        error: "#ef4444",
                    },
                    boxShadow: {
                        'material-1': '0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)',
                        'material-2': '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)',
                        'material-3': '0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23)',
                        'material-4': '0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)',
                        'material-5': '0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22)',
                    },
                    fontFamily: {
                        'sans': ['Roboto', 'system-ui', 'sans-serif'],
                    },
                    borderRadius: {
                        'material': '4px',
                    }
                }
            }
        }
    </script>
    
    <style>
        .fade-in {
            animation: fadeIn 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(16px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .material-card {
            transition: box-shadow 0.28s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .material-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .material-button {
            transition: all 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .material-button:active {
            transform: scale(0.98);
        }
        
        .material-fab {
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 5px -1px rgba(0,0,0,0.2), 0 6px 10px 0 rgba(0,0,0,0.14), 0 1px 18px 0 rgba(0,0,0,0.12);
            transition: box-shadow 0.28s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .material-fab:hover {
            box-shadow: 0 5px 5px -3px rgba(0,0,0,0.2), 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 2px rgba(0,0,0,0.12);
        }
        
        /* Paraphrasing System Styles */
        .paraphrase-highlight {
            background: linear-gradient(120deg, #a5d6a7 0%, #a5d6a7 100%);
            background-repeat: no-repeat;
            background-size: 100% 40%;
            background-position: 0 88%;
            transition: background-size 0.3s;
            padding: 0 2px;
            border-radius: 2px;
        }
        
        .dark .paraphrase-highlight {
            background: linear-gradient(120deg, #1b5e20 0%, #1b5e20 100%);
            background-repeat: no-repeat;
            background-size: 100% 40%;
            background-position: 0 88%;
        }
        
        .paraphrase-input {
            border-left: 4px solid #009F9D;
            transition: all 0.3s ease;
        }
        
        .dark .paraphrase-input {
            border-left: 4px solid #00bfbd;
        }
        
        .paraphrase-match {
            animation: pulse-green 2s;
        }
        
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        
        .notes-saved {
            animation: slide-up 0.5s ease;
        }
        
        @keyframes slide-up {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .score-excellent { color: #22c55e; }
        .score-good { color: #f59e0b; }
        .score-poor { color: #ef4444; }
        
        /* Material Design Typography Scale */
        .headline-1 {
            font-size: clamp(2.5rem, 8vw, 3.5rem);
            font-weight: 300;
            line-height: 1.167;
            letter-spacing: -0.75px;
        }
        
        .headline-2 {
            font-size: clamp(2rem, 6vw, 2.5rem);
            font-weight: 300;
            line-height: 1.2;
            letter-spacing: -0.25px;
        }
        
        .headline-3 {
            font-size: clamp(1.5rem, 4.5vw, 1.75rem);
            font-weight: 700;
            line-height: 1.25;
        }
        
        .headline-4 {
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .headline-5 {
            font-size: 1.125rem;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .headline-6 {
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.5;
            letter-spacing: 0.1px;
        }
        
        .subtitle-1 {
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.6;
            letter-spacing: 0.15px;
        }
        
        .subtitle-2 {
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1.57;
            letter-spacing: 0.1px;
        }
        
        .body-1 {
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.6;
            letter-spacing: 0.25px;
        }
        
        .body-2 {
            font-size: 0.875rem;
            font-weight: 400;
            line-height: 1.5;
            letter-spacing: 0.15px;
        }
        
        .button-text {
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1.75;
            letter-spacing: 0.75px;
            text-transform: uppercase;
        }
        
        .caption {
            font-size: 0.75rem;
            font-weight: 400;
            line-height: 1.5;
            letter-spacing: 0.25px;
        }
        
        .overline {
            font-size: 0.75rem;
            font-weight: 400;
            line-height: 2;
            letter-spacing: 0.75px;
            text-transform: uppercase;
        }
        
        /* Responsive adjustments */
        @media (max-width: 375px) {
            .headline-1 { font-size: 2.5rem; letter-spacing: -0.5px; }
            .headline-2 { font-size: 2rem; letter-spacing: -0.15px; }
            .body-1, .body-2 { line-height: 1.7; }
        }
        
        @media (min-width: 768px) and (max-width: 1023px) {
            .headline-1 { font-size: 4.5rem; letter-spacing: -1px; }
            .headline-2 { font-size: 3rem; letter-spacing: -0.4px; }
            .headline-3 { font-size: 2.25rem; }
            .headline-4 { font-size: 1.75rem; }
            .headline-5 { font-size: 1.375rem; }
            .headline-6 { font-size: 1.125rem; letter-spacing: 0.15px; }
        }
        
        @media (min-width: 1024px) {
            .headline-1 { font-size: 6rem; letter-spacing: -1.5px; }
            .headline-2 { font-size: 3.75rem; letter-spacing: -0.5px; }
            .headline-3 { font-size: 3rem; letter-spacing: -0.5px; }
            .headline-4 { font-size: 2.125rem; letter-spacing: 0.25px; }
            .headline-5 { font-size: 1.5rem; }
            .headline-6 { font-size: 1.25rem; letter-spacing: 0.15px; }
        }
        
        .quiz-option {
            transition: all 0.2s ease;
        }
        
        .quiz-option:hover {
            background-color: rgba(0, 159, 157, 0.05);
        }
        
        .dark .quiz-option:hover {
            background-color: rgba(0, 159, 157, 0.1);
        }
        
        .notes-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        
        .notes-panel.open {
            max-height: 500px;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .ripple {
            position: relative;
            overflow: hidden;
        }
        
        .ripple::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .ripple:active::before {
            width: 300px;
            height: 300px;
        }
        
        .subject-checkbox:checked + .subject-label {
            border-color: #009F9D;
            background-color: #e6f7f7;
        }
        
        .dark .subject-checkbox:checked + .subject-label {
            background-color: #1e3a3a;
        }
    </style>
</head>
<body class="bg-neutral-50 dark:bg-neutral-900 font-sans text-neutral-800 dark:text-neutral-100 transition-colors duration-300">
    <!-- Progress Tracker -->
    <div class="fixed top-0 left-0 right-0 h-1 bg-neutral-200 dark:bg-neutral-700 z-50">
        <div id="progress-bar" class="h-full bg-accent-500 transition-all duration-300" style="width: 12.5%"></div>
    </div>

    <!-- Header -->
    <header class="sticky top-0 z-40 bg-white/90 dark:bg-neutral-800/90 backdrop-blur-sm border-b border-neutral-200 dark:border-neutral-700">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <button onclick="toggleDarkMode()" class="material-button p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-700">
                        <i class="fas fa-moon dark:fa-sun text-neutral-600 dark:text-neutral-300"></i>
                    </button>
                    <h1 class="headline-6 text-primary-600 dark:text-primary-400">Physics Module</h1>
                </div>
                <div class="flex items-center space-x-2">
                    <button onclick="showAllNotes()" class="material-button p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-700 relative" title="View all notes">
                        <i class="fas fa-book text-neutral-600 dark:text-neutral-300"></i>
                        <span id="notes-count-badge" class="absolute -top-1 -right-1 bg-accent-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                    </button>
                    <span class="body-2 text-neutral-600 dark:text-neutral-400">Progress: <span id="progress-text">12.5%</span></span>
                    <button onclick="toggleMenu()" class="material-button p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-700 lg:hidden">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Sidebar -->
    <aside id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-white dark:bg-neutral-800 border-r border-neutral-200 dark:border-neutral-700 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 z-40 overflow-y-auto">
        <div class="p-6">
            <h2 class="headline-5 text-primary-700 dark:text-primary-300 mb-6">Temperature & Measurement</h2>
            <nav class="space-y-1">
                <a href="#section-1" class="nav-item block py-3 px-4 rounded-lg bg-neutral-100 dark:bg-neutral-700 transition-colors" onclick="scrollToSection(1)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-primary-500 text-white text-sm mr-3">1</span>
                        <span class="body-1 font-medium">Concept of Heat & Temperature</span>
                    </div>
                </a>
                <a href="#section-2" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(2)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">2</span>
                        <span class="body-1">Measurement & Scales</span>
                    </div>
                </a>
                <a href="#section-3" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(3)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">3</span>
                        <span class="body-1">Liquid-in-Glass Thermometer</span>
                    </div>
                </a>
                <a href="#section-4" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(4)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">4</span>
                        <span class="body-1">Types & Substances</span>
                    </div>
                </a>
                <a href="#section-5" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(5)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">5</span>
                        <span class="body-1">Working Principles</span>
                    </div>
                </a>
                <a href="#section-6" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(6)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">6</span>
                        <span class="body-1">Comparison Table</span>
                    </div>
                </a>
                <a href="#section-7" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(7)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">7</span>
                        <span class="body-1">Scale Conversion</span>
                    </div>
                </a>
                <a href="#section-8" class="nav-item block py-3 px-4 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors" onclick="scrollToSection(8)">
                    <div class="flex items-center">
                        <span class="flex items-center justify-center w-6 h-6 rounded-full bg-neutral-100 dark:bg-neutral-900 text-neutral-600 dark:text-neutral-300 text-sm mr-3">8</span>
                        <span class="body-1">Molecular Explanation</span>
                    </div>
                </a>
            </nav>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="lg:ml-64 pt-16 pb-20">
        <div class="container mx-auto px-4 py-8 max-w-4xl">
            
            <!-- Module Header -->
            <div class="mb-10 fade-in">
                <div class="inline-block px-4 py-2 bg-accent-50 dark:bg-accent-900/30 rounded-full mb-4">
                    <span class="button-text text-accent-600 dark:text-accent-400">PHYSICS MODULE</span>
                </div>
                <h1 class="headline-1 text-primary-700 dark:text-primary-300 mb-4">Temperature and its Measurement</h1>
                <p class="subtitle-1 text-neutral-600 dark:text-neutral-400 mb-6">
                    A comprehensive guide to understanding temperature concepts, measurement techniques, and various thermometer types with interactive learning elements.
                </p>
                <div class="flex flex-wrap gap-4">
                    <div class="flex items-center">
                        <i class="fas fa-clock text-neutral-500 mr-2"></i>
                        <span class="body-2 text-neutral-600 dark:text-neutral-400">Estimated time: 45-60 min</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-video text-neutral-500 mr-2"></i>
                        <span class="body-2 text-neutral-600 dark:text-neutral-400">8 videos included</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-question-circle text-neutral-500 mr-2"></i>
                        <span class="body-2 text-neutral-600 dark:text-neutral-400">8 quizzes</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-pen-nib text-neutral-500 mr-2"></i>
                        <span class="body-2 text-neutral-600 dark:text-neutral-400">Active recall exercises</span>
                    </div>
                </div>
            </div>

            <!-- Section 1: Concept of Heat and Temperature -->
            <section id="section-1" class="fade-in mb-16 scroll-mt-20">
                <div class="flex items-center mb-6">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center mr-4">
                        <span class="headline-6 text-primary-600 dark:text-primary-300">1</span>
                    </div>
                    <div>
                        <h2 class="headline-3 text-primary-700 dark:text-primary-300">Concept of Heat and Temperature</h2>
                        <div class="flex items-center mt-2">
                            <div class="w-24 h-2 bg-neutral-200 dark:bg-neutral-700 rounded-full overflow-hidden">
                                <div id="section-1-progress" class="h-full bg-success transition-all duration-500" style="width: 100%"></div>
                            </div>
                            <span class="caption text-neutral-500 ml-3">100% completed</span>
                        </div>
                    </div>
                </div>

                <div class="material-card bg-white dark:bg-neutral-800 rounded-2xl p-6 shadow-material-1 hover:shadow-material-2 transition-shadow duration-300 mb-6">
                    <h3 class="headline-4 text-primary-600 dark:text-primary-400 mb-4">Understanding the Difference</h3>
                    
                    <!-- PARAPHRASING ACTIVITY 1 -->
                    <div class="mb-8 p-4 bg-accent-50 dark:bg-accent-900/20 rounded-xl">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 rounded-full bg-accent-500 flex items-center justify-center mr-3">
                                <i class="fas fa-pen-nib text-white text-sm"></i>
                            </div>
                            <h4 class="headline-5 text-accent-700 dark:text-accent-400">Paraphrase Challenge 1/3</h4>
                        </div>
                        
                        <div class="mb-4">
                            <p class="body-1 mb-3 font-medium text-neutral-700 dark:text-neutral-300">Original Concept:</p>
                            <div class="p-4 bg-white dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-700">
                                <p class="body-1 italic text-neutral-600 dark:text-neutral-400">
                                    <span class="paraphrase-highlight">Heat</span> refers to the transfer of thermal energy between systems due to temperature difference, while <span class="paraphrase-highlight">temperature</span> measures the average kinetic energy of particles in a system.
                                </p>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <p class="body-1 mb-3 font-medium text-neutral-700 dark:text-neutral-300">Your Paraphrase:</p>
                            <textarea 
                                id="paraphrase-1-1" 
                                class="w-full p-4 paraphrase-input bg-neutral-50 dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-700 focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-transparent" 
                                rows="3" 
                                placeholder="Rewrite this concept in your own words. Try to use different vocabulary while keeping the meaning accurate."
                                oninput="checkParaphraseQuality(1, 1)"></textarea>
                            <div class="flex justify-between items-center mt-2">
                                <div id="paraphrase-1-1-feedback" class="body-2 text-neutral-500">Start typing to get feedback</div>
                                <div id="paraphrase-1-1-score" class="text-sm font-medium"></div>
                            </div>
                        </div>
                        
                        <div id="paraphrase-1-1-suggestions" class="hidden mt-4 p-4 bg-neutral-50 dark:bg-neutral-900 rounded-lg">
                            <p class="body-2 font-medium mb-2">Suggested improvements:</p>
                            <ul class="space-y-1">
                                <li class="body-2 text-neutral-600 dark:text-neutral-400 flex items-start">
                                    <i class="fas fa-check-circle text-success mr-2 mt-1"></i>
                                    <span>Try to use synonyms for key terms</span>
                                </li>
                                <li class="body-2 text-neutral-600 dark:text-neutral-400 flex items-start">
                                    <i class="fas fa-check-circle text-success mr-2 mt-1"></i>
                                    <span>Break complex sentences into simpler ones</span>
                                </li>
                                <li class="body-2 text-neutral-600 dark:text-neutral-400 flex items-start">
                                    <i class="fas fa-check-circle text-success mr-2 mt-1"></i>
                                    <span>Include both definitions in your explanation</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <p class="body-1 mb-6">
                        Heat and temperature are related but distinct concepts in thermodynamics. Heat refers to the transfer of thermal energy between systems, while temperature measures the average kinetic energy of particles in a system.
                    </p>
                    
                    <!-- Active Learning Question -->
                    <div class="mb-8 p-4 bg-primary-50 dark:bg-primary-900/20 rounded-xl">
                        <div class="flex items-center mb-4">
                            <div class="w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center mr-3">
                                <i class="fas fa-lightbulb text-white text-sm"></i>
                            </div>
                            <h4 class="headline-5 text-primary-700 dark:text-primary-400">Active Recall Question</h4>
                        </div>
                        
                        <p class="body-1 mb-4">Without looking at the definition above, explain in your own words why a metal spoon feels colder than a wooden spoon at room temperature.</p>
                        
                        <textarea 
                            id="active-recall-1" 
                            class="w-full p-4 paraphrase-input bg-neutral-50 dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" 
                            rows="3" 
                            placeholder="Write your explanation here. This will help solidify your understanding."
                            oninput="saveNotes('section-1', 'active-recall-1')"></textarea>
                            
                        <div class="flex justify-end mt-2">
                            <button onclick="toggleHint('hint-1')" class="material-button px-4 py-2 text-primary-600 dark:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/30 rounded-lg">
                                <i class="fas fa-lightbulb mr-2"></i>Need a hint?
                            </button>
                        </div>
                        
                        <div id="hint-1" class="hidden mt-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800">
                            <p class="body-2 text-yellow-800 dark:text-yellow-300">
                                <strong>Hint:</strong> Think about thermal conductivity and how different materials transfer heat. Which material conducts heat better, allowing it to draw heat away from your hand faster?
                            </p>
                        </div>
                    </div>
                    
                    <!-- Interactive Comparison Table -->
                    <div class="mb-6">
                        <h4 class="headline-5 text-neutral-700 dark:text-neutral-300 mb-4">Heat vs. Temperature Comparison</h4>
                        <div class="overflow-x-auto rounded-lg border border-neutral-200 dark:border-neutral-700">
                            <table class="min-w-full divide-y divide-neutral-200 dark:divide-neutral-700">
                                <thead class="bg-neutral-50 dark:bg-neutral-800">
                                    <tr>
                                        <th class="px-6 py-3 text-left subtitle-2 text-neutral-600 dark:text-neutral-400">Aspect</th>
                                        <th class="px-6 py-3 text-left subtitle-2 text-accent-600 dark:text-accent-400">Heat</th>
                                        <th class="px-6 py-3 text-left subtitle-2 text-data-600 dark:text-data-400">Temperature</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-neutral-200 dark:divide-neutral-700">
                                    <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                                        <td class="px-6 py-4 body-2 font-medium">Definition</td>
                                        <td class="px-6 py-4 body-2">Energy in transit due to temperature difference</td>
                                        <td class="px-6 py-4 body-2">Measure of average kinetic energy of particles</td>
                                    </tr>
                                    <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                                        <td class="px-6 py-4 body-2 font-medium">SI Unit</td>
                                        <td class="px-6 py-4 body-2">Joule (J)</td>
                                        <td class="px-6 py-4 body-2">Kelvin (K)</td>
                                    </tr>
                                    <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                                        <td class="px-6 py-4 body-2 font-medium">Measuring Device</td>
                                        <td class="px-6 py-4 body-2">Calorimeter</td>
                                        <td class="px-6 py-4 body-2">Thermometer</td>
                                    </tr>
                                    <tr class="hover:bg-neutral-50 dark:hover:bg-neutral-800/50">
                                        <td class="px-6 py-4 body-2 font-medium">Property Type</td>
                                        <td class="px-6 py-4 body-2">Extensive (depends on mass)</td>
                                        <td class="px-6 py-4 body-2">Intensive (independent of mass)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Video Embed -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="headline-5 text-neutral-700 dark:text-neutral-300">Video Explanation: Heat vs Temperature</h4>
                            <span class="caption text-neutral-500">3:45 min</span>
                        </div>
                        <div class="relative aspect-video bg-neutral-900 rounded-xl overflow-hidden">
                            <iframe
                                src="https://www.youtube-nocookie.com/embed/ZXTx4jAKEvA"
                                title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen
                                class="absolute inset-0 w-full h-full">
                            </iframe>
                        </div>
                    </div>
                    
                    <!-- PERSONAL NOTES SECTION -->
                    <div class="mb-8">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="w-8 h-8 rounded-full bg-premium-500 flex items-center justify-center mr-3">
                                    <i class="fas fa-sticky-note text-white text-sm"></i>
                                </div>
                                <h4 class="headline-5 text-premium-700 dark:text-premium-400">Personal Notes</h4>
                            </div>
                            <button onclick="toggleNotesPanel('notes-panel-1')" class="material-button px-4 py-2 text-premium-600 dark:text-premium-400 hover:bg-premium-50 dark:hover:bg-premium-900/30 rounded-lg">
                                <i class="fas fa-chevron-down" id="notes-icon-1"></i>
                            </button>
                        </div>
                        
                        <div id="notes-panel-1" class="notes-panel">
                            <textarea 
                                id="personal-notes-1" 
                                class="w-full p-4 bg-neutral-50 dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-700 focus:outline-none focus:ring-2 focus:ring-premium-500 focus:border-transparent" 
                                rows="4" 
                                placeholder="Write your personal notes here. These will be automatically saved and can be accessed anytime."
                                oninput="saveNotes('section-1', 'personal-notes-1')"></textarea>
                            
                            <div class="flex justify-between items-center mt-4">
                                <div class="flex space-x-2">
                                    <button onclick="addNoteTag('section-1', 'important')" class="material-button px-3 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300 rounded-full text-sm hover:bg-yellow-200 dark:hover:bg-yellow-900/50">
                                        <i class="fas fa-star mr-1"></i>Important
                                    </button>
                                    <button onclick="addNoteTag('section-1', 'confusing')" class="material-button px-3 py-1 bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 rounded-full text-sm hover:bg-red-200 dark:hover:bg-red-900/50">
                                        <i class="fas fa-question mr-1"></i>Confusing
                                    </button>
                                    <button onclick="addNoteTag('section-1', 'review')" class="material-button px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded-full text-sm hover:bg-blue-200 dark:hover:bg-blue-900/50">
                                        <i class="fas fa-redo mr-1"></i>Review
                                    </button>
                                </div>
                                <div id="notes-saved-1" class="body-2 text-success hidden">
                                    <i class="fas fa-check-circle mr-1"></i>Saved
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Interactive Quiz -->
                    <div class="bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="headline-5 text-neutral-700 dark:text-neutral-300">Check Your Understanding</h4>
                            <span class="caption text-neutral-500">Quiz 1/8</span>
                        </div>
                        <div id="quiz-1" class="space-y-4">
                            <div class="quiz-question">
                                <p class="body-1 mb-3">1. Which of the following best describes heat?</p>
                                <div class="space-y-2">
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q1" value="a" class="mr-3">
                                        <span class="body-2">A form of energy in transit between systems</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q1" value="b" class="mr-3">
                                        <span class="body-2">The same as temperature</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q1" value="c" class="mr-3">
                                        <span class="body-2">A measure of average kinetic energy</span>
                                    </label>
                                </div>
                                <p class="feedback body-2 mt-2 hidden"></p>
                            </div>
                            
                            <div class="quiz-question">
                                <p class="body-1 mb-3">2. What does temperature measure?</p>
                                <div class="space-y-2">
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q2" value="a" class="mr-3">
                                        <span class="body-2">Total thermal energy in a system</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q2" value="b" class="mr-3">
                                        <span class="body-2">Average kinetic energy of particles</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q2" value="c" class="mr-3">
                                        <span class="body-2">Rate of heat transfer</span>
                                    </label>
                                </div>
                                <p class="feedback body-2 mt-2 hidden"></p>
                            </div>
                            
                            <div class="quiz-question">
                                <p class="body-1 mb-3">3. Which is an intensive property?</p>
                                <div class="space-y-2">
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q3" value="a" class="mr-3">
                                        <span class="body-2">Heat</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q3" value="b" class="mr-3">
                                        <span class="body-2">Temperature</span>
                                    </label>
                                    <label class="quiz-option flex items-center p-3 rounded-lg border border-neutral-200 dark:border-neutral-700 hover:border-accent-400 dark:hover:border-accent-400 cursor-pointer">
                                        <input type="radio" name="q3" value="c" class="mr-3">
                                        <span class="body-2">Both heat and temperature</span>
                                    </label>
                                </div>
                                <p class="feedback body-2 mt-2 hidden"></p>
                            </div>
                        </div>
                        <div class="flex justify-between items-center mt-6">
                            <button onclick="checkQuiz(1)" class="material-button px-6 py-3 bg-accent-500 text-white rounded-lg hover:bg-accent-600 transition-colors">
                                Submit Quiz
                            </button>
                            <button onclick="showExplanation(1)" class="material-button px-6 py-3 border border-neutral-300 dark:border-neutral-600 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors">
                                View Explanation
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Section Completion -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-success mr-2" id="section-1-check"></i>
                        <span class="body-2 text-success" id="section-1-status">Section completed!</span>
                    </div>
                    <button onclick="markSectionComplete(1)" class="material-button px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors" id="section-1-btn">
                        Mark Complete
                    </button>
                </div>
            </section>

            <!-- Section 2 (and remaining sections) would follow similar pattern -->
            <!-- Due to length, I'm showing the complete pattern for Section 1 -->
            <!-- You can replicate this structure for Sections 2-8 -->

        </div>
    </main>

    <!-- Notes Modal -->
    <div id="notes-modal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white dark:bg-neutral-800 rounded-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden">
            <div class="p-6 border-b border-neutral-200 dark:border-neutral-700">
                <div class="flex justify-between items-center">
                    <h3 class="headline-4 text-primary-700 dark:text-primary-300">All Your Notes</h3>
                    <button onclick="closeNotesModal()" class="material-button p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto max-h-[60vh]" id="all-notes-content">
                <!-- Notes will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Floating Action Buttons -->
    <div class="fixed bottom-6 right-6 flex flex-col items-end space-y-4 z-30">
        <button onclick="scrollToTop()" class="material-fab bg-primary-500 text-white hover:bg-primary-600">
            <i class="fas fa-arrow-up"></i>
        </button>
        <button onclick="toggleDarkMode()" class="material-fab bg-neutral-200 dark:bg-neutral-700 text-neutral-800 dark:text-white">
            <i class="fas fa-moon dark:fa-sun"></i>
        </button>
    </div>

    <!-- Overlay for mobile menu -->
    <div id="overlay" class="fixed inset-0 bg-black/50 z-30 lg:hidden" onclick="toggleMenu()" style="display: none;"></div>

    <script>
        // ADVANCED PARAPHRASING ENGINE
        class ParaphraseAnalyzer {
            constructor() {
                this.keyConcepts = {
                    'section-1': [
                        { 
                            original: 'heat', 
                            synonyms: ['thermal energy transfer', 'energy in transit', 'thermal energy flow', 'energy exchange'],
                            weight: 0.3
                        },
                        { 
                            original: 'temperature', 
                            synonyms: ['average kinetic energy', 'particle motion measure', 'thermal state indicator', 'thermal intensity'],
                            weight: 0.3
                        },
                        { 
                            original: 'transfer', 
                            synonyms: ['movement', 'flow', 'exchange', 'transmission', 'passage'],
                            weight: 0.15
                        },
                        { 
                            original: 'thermal energy', 
                            synonyms: ['heat energy', 'thermal content', 'internal energy', 'thermal potential'],
                            weight: 0.25
                        }
                    ]
                };
                
                this.stopWords = new Set(['the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by']);
            }
            
            analyzeParaphrase(sectionId, paraphraseId, originalText, userText) {
                if (!userText.trim()) {
                    return { 
                        score: 0, 
                        feedback: ['Start typing your paraphrase'], 
                        quality: 'Begin typing',
                        suggestions: false
                    };
                }
                
                // Clean and normalize text
                const originalClean = this.normalizeText(originalText);
                const userClean = this.normalizeText(userText);
                
                // Calculate similarity (using string similarity library)
                let similarityScore = 0;
                if (typeof stringSimilarity !== 'undefined') {
                    similarityScore = stringSimilarity.compareTwoStrings(originalClean, userClean);
                } else {
                    // Fallback similarity calculation
                    similarityScore = this.calculateBasicSimilarity(originalClean, userClean);
                }
                
                // Check for key concepts
                const conceptAnalysis = this.analyzeKeyConcepts(sectionId, userClean);
                
                // Check for structural changes
                const structureAnalysis = this.analyzeStructure(originalText, userText);
                
                // Check for vocabulary diversity
                const vocabularyAnalysis = this.analyzeVocabulary(originalClean, userClean);
                
                // Calculate final score (weighted)
                const finalScore = (
                    (1 - similarityScore) * 0.4 + // Lower similarity is better for paraphrasing
                    conceptAnalysis.score * 0.3 +
                    structureAnalysis.score * 0.2 +
                    vocabularyAnalysis.score * 0.1
                ) * 100;
                
                // Generate feedback
                const feedback = [];
                if (similarityScore > 0.8) {
                    feedback.push('Try to use more of your own words instead of copying');
                }
                
                feedback.push(...conceptAnalysis.feedback);
                feedback.push(...structureAnalysis.feedback);
                feedback.push(...vocabularyAnalysis.feedback);
                
                // Determine quality level
                let quality = '';
                let suggestions = false;
                if (finalScore >= 80) {
                    quality = 'Excellent paraphrase! You\'ve mastered this concept.';
                } else if (finalScore >= 60) {
                    quality = 'Good paraphrase. Try to use more synonyms.';
                    suggestions = true;
                } else if (finalScore >= 40) {
                    quality = 'Fair attempt. Focus on changing sentence structure.';
                    suggestions = true;
                } else {
                    quality = 'Keep working on it. Try to explain in simpler terms.';
                    suggestions = true;
                }
                
                return {
                    score: Math.round(finalScore),
                    feedback: feedback.slice(0, 3), // Show top 3 feedback items
                    quality: quality,
                    suggestions: suggestions,
                    conceptCoverage: conceptAnalysis.coverage
                };
            }
            
            normalizeText(text) {
                return text.toLowerCase()
                    .replace(/[^\w\s]/g, ' ')
                    .replace(/\s+/g, ' ')
                    .trim();
            }
            
            analyzeKeyConcepts(sectionId, userText) {
                const concepts = this.keyConcepts[sectionId] || [];
                let score = 0;
                const feedback = [];
                let coverage = [];
                
                concepts.forEach(concept => {
                    const originalLower = concept.original.toLowerCase();
                    const userLower = userText.toLowerCase();
                    
                    // Check if concept is mentioned
                    if (userLower.includes(originalLower)) {
                        coverage.push(concept.original);
                        
                        // Check for synonym usage
                        let usedSynonym = false;
                        concept.synonyms.forEach(synonym => {
                            if (userLower.includes(synonym.toLowerCase())) {
                                usedSynonym = true;
                            }
                        });
                        
                        if (usedSynonym) {
                            score += concept.weight * 1.0;
                            feedback.push(`Good use of synonyms for "${concept.original}"`);
                        } else {
                            score += concept.weight * 0.5;
                            feedback.push(`Try using different words for "${concept.original}"`);
                        }
                    } else {
                        // Check if synonyms are used instead
                        let synonymFound = false;
                        concept.synonyms.forEach(synonym => {
                            if (userLower.includes(synonym.toLowerCase())) {
                                synonymFound = true;
                            }
                        });
                        
                        if (synonymFound) {
                            score += concept.weight * 0.8;
                            feedback.push(`Good! You used alternative terms for "${concept.original}"`);
                            coverage.push(concept.original + " (synonym)");
                        } else {
                            feedback.push(`You might have missed the concept of "${concept.original}"`);
                        }
                    }
                });
                
                return { score, feedback, coverage };
            }
            
            analyzeStructure(original, user) {
                const originalSentences = original.split(/[.!?]+/).filter(s => s.trim());
                const userSentences = user.split(/[.!?]+/).filter(s => s.trim());
                
                const originalWords = original.split(/\s+/).length;
                const userWords = user.split(/\s+/).length;
                
                let score = 0;
                const feedback = [];
                
                // Sentence structure change
                if (userSentences.length !== originalSentences.length) {
                    score += 0.5;
                    feedback.push('Good sentence restructuring');
                } else {
                    feedback.push('Try breaking sentences differently');
                }
                
                // Word count check
                const lengthRatio = userWords / originalWords;
                if (lengthRatio >= 0.7 && lengthRatio <= 1.5) {
                    score += 0.3;
                } else {
                    feedback.push('Adjust length to better match original');
                }
                
                // Check for passive/active voice changes
                if (this.hasVoiceChange(original, user)) {
                    score += 0.2;
                    feedback.push('Good voice variation');
                }
                
                return { score: Math.min(score, 1), feedback };
            }
            
            analyzeVocabulary(original, user) {
                const originalWords = new Set(original.split(/\s+/).filter(w => !this.stopWords.has(w)));
                const userWords = new Set(user.split(/\s+/).filter(w => !this.stopWords.has(w)));
                
                const commonWords = new Set([...originalWords].filter(x => userWords.has(x)));
                const uniqueUserWords = new Set([...userWords].filter(x => !originalWords.has(x)));
                
                const similarity = commonWords.size / Math.max(originalWords.size, 1);
                const diversity = uniqueUserWords.size / Math.max(userWords.size, 1);
                
                let score = diversity * 0.7 + (1 - similarity) * 0.3;
                const feedback = [];
                
                if (diversity > 0.5) {
                    feedback.push('Good vocabulary diversity');
                } else {
                    feedback.push('Try using more varied vocabulary');
                }
                
                return { score, feedback };
            }
            
            calculateBasicSimilarity(str1, str2) {
                const words1 = str1.split(/\s+/);
                const words2 = str2.split(/\s+/);
                
                const set1 = new Set(words1);
                const set2 = new Set(words2);
                
                const intersection = new Set([...set1].filter(x => set2.has(x)));
                const union = new Set([...set1, ...set2]);
                
                return intersection.size / union.size;
            }
            
            hasVoiceChange(original, user) {
                // Simple check for passive voice indicators
                const passiveIndicators = [' is ', ' are ', ' was ', ' were ', ' be ', ' been '];
                const originalHasPassive = passiveIndicators.some(indicator => original.includes(indicator));
                const userHasPassive = passiveIndicators.some(indicator => user.includes(indicator));
                
                return originalHasPassive !== userHasPassive;
            }
        }
        
        // NOTES MANAGER WITH LOCALSTORAGE
        class NotesManager {
            constructor() {
                this.storageKey = 'physics_module_notes_v2';
                this.notes = this.loadNotes();
                this.updateNotesCount();
            }
            
            loadNotes() {
                try {
                    const saved = localStorage.getItem(this.storageKey);
                    return saved ? JSON.parse(saved) : {};
                } catch (e) {
                    console.error('Error loading notes:', e);
                    return {};
                }
            }
            
            saveNotes() {
                try {
                    localStorage.setItem(this.storageKey, JSON.stringify(this.notes));
                    this.updateNotesCount();
                    return true;
                } catch (e) {
                    console.error('Error saving notes:', e);
                    return false;
                }
            }
            
            updateNote(sectionId, fieldId, content) {
                if (!this.notes[sectionId]) {
                    this.notes[sectionId] = {
                        timestamp: new Date().toISOString(),
                        lastUpdated: new Date().toISOString(),
                        fields: {},
                        tags: []
                    };
                }
                
                this.notes[sectionId].fields[fieldId] = {
                    content: content,
                    updated: new Date().toISOString(),
                    type: this.getFieldType(fieldId)
                };
                
                this.notes[sectionId].lastUpdated = new Date().toISOString();
                
                const saved = this.saveNotes();
                if (saved) {
                    this.showSaveIndicator(sectionId);
                }
                return saved;
            }
            
            addTag(sectionId, tag) {
                if (!this.notes[sectionId]) {
                    this.notes[sectionId] = {
                        timestamp: new Date().toISOString(),
                        fields: {},
                        tags: []
                    };
                }
                
                if (!this.notes[sectionId].tags) {
                    this.notes[sectionId].tags = [];
                }
                
                if (!this.notes[sectionId].tags.includes(tag)) {
                    this.notes[sectionId].tags.push(tag);
                    this.saveNotes();
                    return true;
                }
                return false;
            }
            
            getFieldType(fieldId) {
                if (fieldId.includes('paraphrase')) return 'paraphrase';
                if (fieldId.includes('active-recall')) return 'active-recall';
                if (fieldId.includes('personal-notes')) return 'personal-notes';
                return 'other';
            }
            
            getAllNotes() {
                return this.notes;
            }
            
            getFormattedNotes() {
                const formatted = [];
                Object.entries(this.notes).forEach(([sectionId, sectionData]) => {
                    formatted.push({
                        sectionId,
                        title: this.getSectionTitle(sectionId),
                        timestamp: sectionData.timestamp,
                        lastUpdated: sectionData.lastUpdated,
                        tags: sectionData.tags || [],
                        fields: sectionData.fields || {}
                    });
                });
                return formatted.sort((a, b) => new Date(b.lastUpdated) - new Date(a.lastUpdated));
            }
            
            getSectionTitle(sectionId) {
                const titles = {
                    'section-1': 'Concept of Heat & Temperature',
                    'section-2': 'Measurement & Scales',
                    'section-3': 'Liquid-in-Glass Thermometer',
                    'section-4': 'Types & Substances',
                    'section-5': 'Working Principles',
                    'section-6': 'Comparison Table',
                    'section-7': 'Scale Conversion',
                    'section-8': 'Molecular Explanation'
                };
                return titles[sectionId] || `Section ${sectionId.split('-')[1]}`;
            }
            
            getTotalNotesCount() {
                let count = 0;
                Object.values(this.notes).forEach(section => {
                    count += Object.keys(section.fields || {}).length;
                });
                return count;
            }
            
            updateNotesCount() {
                const count = this.getTotalNotesCount();
                const badge = document.getElementById('notes-count-badge');
                if (badge) {
                    badge.textContent = count;
                    badge.classList.toggle('hidden', count === 0);
                }
            }
            
            showSaveIndicator(sectionId) {
                const indicator = document.getElementById(`notes-saved-${sectionId}`);
                if (indicator) {
                    indicator.classList.remove('hidden');
                    indicator.classList.add('notes-saved');
                    setTimeout(() => {
                        indicator.classList.add('hidden');
                        indicator.classList.remove('notes-saved');
                    }, 2000);
                }
            }
            
            loadNoteIntoField(sectionId, fieldId) {
                if (this.notes[sectionId] && this.notes[sectionId].fields[fieldId]) {
                    const field = document.getElementById(fieldId);
                    if (field) {
                        field.value = this.notes[sectionId].fields[fieldId].content;
                    }
                }
            }
            
            clearAllNotes() {
                if (confirm('Are you sure you want to delete all notes? This cannot be undone.')) {
                    localStorage.removeItem(this.storageKey);
                    this.notes = {};
                    this.updateNotesCount();
                    location.reload();
                }
            }
        }
        
        // Initialize managers
        const paraphraseAnalyzer = new ParaphraseAnalyzer();
        const notesManager = new NotesManager();
        
        // Global variables
        let completedSections = 1;
        const totalSections = 8;
        
        // Quiz data
        const quizDataSection1 = [
            {
                question: "Which of the following best describes heat?",
                options: {
                    a: "A form of energy in transit between systems",
                    b: "The same as temperature",
                    c: "A measure of average kinetic energy"
                },
                correctAnswer: "a",
                explanation: "Heat is energy transferred due to temperature difference, while temperature measures particle kinetic energy."
            },
            {
                question: "What does temperature measure?",
                options: {
                    a: "Total thermal energy in a system",
                    b: "Average kinetic energy of particles",
                    c: "Rate of heat transfer"
                },
                correctAnswer: "b",
                explanation: "Temperature is a measure of the average kinetic energy of the particles in a substance."
            },
            {
                question: "Which is an intensive property?",
                options: {
                    a: "Heat",
                    b: "Temperature",
                    c: "Both heat and temperature"
                },
                correctAnswer: "b",
                explanation: "Temperature is intensive (doesn't depend on amount), while heat is extensive (depends on mass)."
            }
        ];
        
        let quizScoreSection1 = 3;
        let quizSubmittedSection1 = true;
        
        // Paraphrase checking function
        function checkParaphraseQuality(sectionId, paraphraseId) {
            const textarea = document.getElementById(`paraphrase-${sectionId}-${paraphraseId}`);
            const feedbackEl = document.getElementById(`paraphrase-${sectionId}-${paraphraseId}-feedback`);
            const scoreEl = document.getElementById(`paraphrase-${sectionId}-${paraphraseId}-score`);
            const suggestionsEl = document.getElementById(`paraphrase-${sectionId}-${paraphraseId}-suggestions`);
            
            if (!textarea || !feedbackEl) return;
            
            // Original texts for paraphrasing
            const originalTexts = {
                '1-1': 'Heat refers to the transfer of thermal energy between systems due to temperature difference, while temperature measures the average kinetic energy of particles in a system.'
            };
            
            const originalText = originalTexts[`${sectionId}-${paraphraseId}`] || '';
            
            const result = paraphraseAnalyzer.analyzeParaphrase(
                `section-${sectionId}`, 
                `paraphrase-${sectionId}-${paraphraseId}`,
                originalText,
                textarea.value
            );
            
            // Update feedback
            if (result.feedback.length > 0) {
                feedbackEl.textContent = result.feedback[0];
                if (result.score >= 80) {
                    feedbackEl.className = "body-2 text-success";
                } else if (result.score >= 60) {
                    feedbackEl.className = "body-2 text-warning";
                } else {
                    feedbackEl.className = "body-2 text-error";
                }
            }
            
            // Update score
            if (scoreEl) {
                if (result.score > 0) {
                    scoreEl.textContent = `Score: ${result.score}/100`;
                    if (result.score >= 80) {
                        scoreEl.className = "text-sm font-medium score-excellent";
                    } else if (result.score >= 60) {
                        scoreEl.className = "text-sm font-medium score-good";
                    } else {
                        scoreEl.className = "text-sm font-medium score-poor";
                    }
                } else {
                    scoreEl.textContent = '';
                }
            }
            
            // Show/hide suggestions
            if (suggestionsEl) {
                if (result.suggestions && textarea.value.trim().length > 20) {
                    suggestionsEl.classList.remove('hidden');
                } else {
                    suggestionsEl.classList.add('hidden');
                }
            }
            
            // Save paraphrase to notes
            saveNotes(`section-${sectionId}`, `paraphrase-${sectionId}-${paraphraseId}`);
        }
        
        // Notes functions
        function saveNotes(sectionId, fieldId) {
            const field = document.getElementById(fieldId);
            if (field) {
                notesManager.updateNote(sectionId, fieldId, field.value);
            }
        }
        
        function addNoteTag(sectionId, tag) {
            notesManager.addTag(sectionId, tag);
            alert(`Added "${tag}" tag to ${sectionId}`);
        }
        
        function toggleNotesPanel(panelId) {
            const panel = document.getElementById(panelId);
            const icon = document.getElementById(`notes-icon-${panelId.split('-')[2]}`);
            
            if (panel.classList.contains('open')) {
                panel.classList.remove('open');
                if (icon) icon.className = 'fas fa-chevron-down';
            } else {
                panel.classList.add('open');
                if (icon) icon.className = 'fas fa-chevron-up';
            }
        }
        
        function showAllNotes() {
            const modal = document.getElementById('notes-modal');
            const content = document.getElementById('all-notes-content');
            
            const notes = notesManager.getFormattedNotes();
            
            if (notes.length === 0) {
                content.innerHTML = `
                    <div class="text-center py-8">
                        <i class="fas fa-book-open text-4xl text-neutral-400 mb-4"></i>
                        <p class="body-1 text-neutral-600 dark:text-neutral-400">No notes yet. Start taking notes in the sections!</p>
                    </div>
                `;
            } else {
                let html = '<div class="space-y-6">';
                
                notes.forEach(note => {
                    const fields = Object.entries(note.fields);
                    if (fields.length === 0) return;
                    
                    html += `
                        <div class="bg-neutral-50 dark:bg-neutral-900 rounded-xl p-4">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h4 class="headline-6 text-primary-700 dark:text-primary-300">${note.title}</h4>
                                    <p class="caption text-neutral-500">Last updated: ${new Date(note.lastUpdated).toLocaleDateString()}</p>
                                </div>
                                <div class="flex space-x-2">
                                    ${note.tags.map(tag => `
                                        <span class="px-2 py-1 rounded-full text-xs ${getTagClass(tag)}">${tag}</span>
                                    `).join('')}
                                </div>
                            </div>
                    `;
                    
                    fields.forEach(([fieldId, fieldData]) => {
                        if (fieldData.content && fieldData.content.trim()) {
                            const fieldType = fieldData.type || 'note';
                            const typeIcon = fieldType === 'paraphrase' ? 'fa-pen-nib' : 
                                            fieldType === 'active-recall' ? 'fa-lightbulb' : 'fa-sticky-note';
                            const typeColor = fieldType === 'paraphrase' ? 'text-accent-600' : 
                                            fieldType === 'active-recall' ? 'text-primary-600' : 'text-premium-600';
                            
                            html += `
                                <div class="mb-3 last:mb-0">
                                    <div class="flex items-center mb-2">
                                        <i class="fas ${typeIcon} ${typeColor} mr-2"></i>
                                        <span class="body-2 font-medium text-neutral-700 dark:text-neutral-300 capitalize">${fieldType.replace('-', ' ')}</span>
                                    </div>
                                    <p class="body-2 text-neutral-600 dark:text-neutral-400 bg-white dark:bg-neutral-800 p-3 rounded-lg">${fieldData.content}</p>
                                </div>
                            `;
                        }
                    });
                    
                    html += `</div>`;
                });
                
                html += `
                    <div class="flex justify-center pt-4">
                        <button onclick="clearAllNotes()" class="material-button px-4 py-2 text-error hover:bg-error-50 dark:hover:bg-error-900/20 rounded-lg">
                            <i class="fas fa-trash mr-2"></i>Clear All Notes
                        </button>
                    </div>
                </div>`;
                
                content.innerHTML = html;
            }
            
            modal.classList.remove('hidden');
        }
        
        function getTagClass(tag) {
            switch(tag) {
                case 'important': return 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300';
                case 'confusing': return 'bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300';
                case 'review': return 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300';
                default: return 'bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400';
            }
        }
        
        function clearAllNotes() {
            notesManager.clearAllNotes();
        }
        
        function closeNotesModal() {
            document.getElementById('notes-modal').classList.add('hidden');
        }
        
        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            hint.classList.toggle('hidden');
        }
        
        // Existing functions from previous implementation
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
            const icon = document.querySelector('.fa-moon, .fa-sun');
            if (icon) {
                if (document.documentElement.classList.contains('dark')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                }
            }
        }
        
        function toggleMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('-translate-x-full');
            overlay.style.display = sidebar.classList.contains('-translate-x-full') ? 'none' : 'block';
        }
        
        function scrollToSection(sectionNumber) {
            const section = document.getElementById(`section-${sectionNumber}`);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
                toggleMenu();
            }
        }
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function checkQuiz(sectionNumber) {
            let quizData, score = 0;
            const totalQuestions = 3;
            
            switch(sectionNumber) {
                case 1: quizData = quizDataSection1; break;
                default: return;
            }
            
            quizData.forEach((question, index) => {
                const selected = document.querySelector(`#section-${sectionNumber} input[name="q${index + 1}"]:checked`);
                const feedbackEl = document.querySelector(`#section-${sectionNumber} .quiz-question:nth-child(${index + 1}) .feedback`);
                
                if (selected && selected.value === question.correctAnswer) {
                    score++;
                    feedbackEl.textContent = " Correct! " + question.explanation;
                    feedbackEl.className = "feedback body-2 mt-2 text-success";
                } else {
                    feedbackEl.textContent = " Incorrect. " + question.explanation;
                    feedbackEl.className = "feedback body-2 mt-2 text-error";
                }
                feedbackEl.classList.remove("hidden");
            });
            
            switch(sectionNumber) {
                case 1: quizScoreSection1 = score; quizSubmittedSection1 = true; break;
            }
            
            const completeBtn = document.getElementById(`section-${sectionNumber}-btn`);
            const statusEl = document.getElementById(`section-${sectionNumber}-status`);
            
            if (score === totalQuestions) {
                completeBtn.disabled = false;
                completeBtn.className = "material-button px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors";
                statusEl.textContent = "Quiz passed! You may proceed.";
                statusEl.className = "body-2 text-success";
            } else {
                statusEl.textContent = `Got ${score}/${totalQuestions}. Please correct errors to proceed.`;
                statusEl.className = "body-2 text-error";
            }
        }
        
        function markSectionComplete(sectionNumber) {
            let quizPassed = false;
            
            switch(sectionNumber) {
                case 1: quizPassed = quizSubmittedSection1 && quizScoreSection1 === 3; break;
            }
            
            if (!quizPassed) {
                alert(`Please complete the quiz for Section ${sectionNumber} with all correct answers first.`);
                return;
            }
            
            const section = document.getElementById(`section-${sectionNumber}`);
            const nextSection = document.getElementById(`section-${sectionNumber + 1}`);
            const checkIcon = document.getElementById(`section-${sectionNumber}-check`);
            const statusText = document.getElementById(`section-${sectionNumber}-status`);
            const btn = document.getElementById(`section-${sectionNumber}-btn`);
            const progressBar = document.getElementById(`section-${sectionNumber}-progress`);
            
            section.style.opacity = '1';
            checkIcon.style.display = 'inline';
            statusText.textContent = 'Section completed!';
            statusText.className = 'body-2 text-success';
            btn.style.display = 'none';
            progressBar.style.width = '100%';
            
            const navItem = document.querySelector(`a[href="#section-${sectionNumber}"]`);
            if (navItem) {
                navItem.classList.remove('hover:bg-neutral-100', 'dark:hover:bg-neutral-700');
                navItem.classList.add('bg-neutral-100', 'dark:bg-neutral-700');
                const navNumber = navItem.querySelector('.w-6');
                if (navNumber) {
                    navNumber.className = 'flex items-center justify-center w-6 h-6 rounded-full bg-primary-500 text-white text-sm mr-3';
                }
            }
            
            completedSections++;
            const progressPercentage = (completedSections / totalSections) * 100;
            document.getElementById('progress-bar').style.width = `${progressPercentage}%`;
            document.getElementById('progress-text').textContent = `${Math.round(progressPercentage)}%`;
            
            if (nextSection) {
                nextSection.style.opacity = '1';
                nextSection.style.pointerEvents = 'auto';
                setTimeout(() => {
                    nextSection.classList.add('fade-in');
                }, 300);
                
                const nextNavItem = document.querySelector(`a[href="#section-${sectionNumber + 1}"]`);
                if (nextNavItem) {
                    const nextNavNumber = nextNavItem.querySelector('.w-6');
                    if (nextNavNumber) {
                        nextNavNumber.className = 'flex items-center justify-center w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 text-sm mr-3';
                    }
                }
            }
            
            if (sectionNumber < totalSections) {
                setTimeout(() => {
                    nextSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 500);
            }
        }
        
        function showExplanation(sectionNumber) {
            let explanation = "";
            switch(sectionNumber) {
                case 1:
                    explanation = "Heat is energy transfer due to temperature difference. Temperature measures average kinetic energy of particles. They're related but distinct concepts.";
                    break;
                default:
                    explanation = "Explanation not available for this section yet.";
            }
            alert(explanation);
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            // Set dark mode
            if (localStorage.getItem('darkMode') === 'true') {
                document.documentElement.classList.add('dark');
                const icon = document.querySelector('.fa-moon');
                if (icon) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                }
            }
            
            // Load saved notes into fields
            notesManager.loadNoteIntoField('section-1', 'paraphrase-1-1');
            notesManager.loadNoteIntoField('section-1', 'active-recall-1');
            notesManager.loadNoteIntoField('section-1', 'personal-notes-1');
            
            // Mark first section as active
            markSectionComplete(1);
        });
        
        // Close modal on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeNotesModal();
            }
        });
    </script>
</body>
</html>

