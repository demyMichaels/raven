<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gas Laws - Interactive Physics</title>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0F2C59;
            --primary-light: #1a3f7a;
            --accent: #009F9D;
            --accent-light: #00c5c2;
            --premium: #D2C1A7;
            --data: #5A7B9E;
            --bg-primary: #FEFEFE;
            --bg-secondary: #F8F9FA;
            --text-primary: #2D3748;
            --text-secondary: #5F6368;
            --border: #E8EAED;
            --success: #22c55e;
            --error: #ef4444;
        }

        .dark {
            --primary: #1a3f7a;
            --primary-light: #0F2C59;
            --accent: #00c5c2;
            --accent-light: #009F9D;
            --premium: #b69f83;
            --data: #7a9ec0;
            --bg-primary: #1F2937;
            --bg-secondary: #111827;
            --text-primary: #F8F9FA;
            --text-secondary: #9AA0A6;
            --border: #374151;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sora', system-ui, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-icon {
            font-size: 2.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        h1 {
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 300;
        }

        /* Navigation */
        .nav-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .nav-container::-webkit-scrollbar {
            display: none;
        }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-bottom: 0;
            min-width: max-content;
        }

        .nav-tab {
            padding: 0.7rem 1.2rem;
            background: rgba(255,255,255,0.1);
            border: none;
            color: rgba(255,255,255,0.85);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 8px 8px 0 0;
            letter-spacing: 0.3px;
            white-space: nowrap;
            font-family: inherit;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .nav-tab.active {
            background: var(--bg-primary);
            color: var(--primary);
            transform: translateY(2px);
        }

        /* Module Container */
        .module {
            display: none;
            animation: fadeIn 0.5s ease;
            padding: 1.5rem 0 3rem;
        }

        .module.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }

        .concept-card {
            background: linear-gradient(135deg, rgba(15, 44, 89, 0.03) 0%, rgba(0, 159, 157, 0.03) 100%);
            border-left: 4px solid var(--accent);
        }

        .card h2, .card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .dark .card h2, .dark .card h3 {
            color: var(--accent);
        }

        /* Law Box */
        .law-box {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            text-align: center;
        }

        .law-box h3 {
            color: white;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .law-box p {
            font-family: 'Crimson Pro', serif;
            font-size: 1.1rem;
            opacity: 0.95;
        }

        /* Formula Box */
        .formula {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            font-family: 'Crimson Pro', serif;
            font-size: 1.4rem;
            text-align: center;
            margin: 1.5rem 0;
            border: 2px dashed var(--border);
            font-weight: 600;
            color: var(--primary);
        }

        .dark .formula {
            color: var(--accent);
        }

        /* Interactive Calculators */
        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-group label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        input[type="number"], select {
            width: 100%;
            padding: 0.8rem;
            font-size: 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 159, 157, 0.15);
        }

        .btn {
            padding: 0.9rem 1.8rem;
            font-size: 0.95rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0,159,157,0.3);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .result-box {
            background: linear-gradient(135deg, rgba(0, 159, 157, 0.1) 0%, rgba(15, 44, 89, 0.1) 100%);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            border: 2px solid var(--accent);
            text-align: center;
        }

        .result-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            font-family: 'Crimson Pro', serif;
        }

        .result-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* Gas Simulation Canvas */
        .simulation-container {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        canvas {
            width: 100%;
            max-width: 100%;
            height: 300px;
            border-radius: 8px;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
            display: block;
        }

        .simulation-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
            min-width: 200px;
        }

        .slider-group label {
            font-size: 0.85rem;
            font-weight: 500;
            white-space: nowrap;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: var(--border);
            appearance: none;
            cursor: pointer;
        }

        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .slider-value {
            min-width: 50px;
            text-align: right;
            font-weight: 600;
            color: var(--accent);
        }

        /* Flashcards */
        .flashcard-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        .flashcard {
            perspective: 1000px;
            width: 100%;
            max-width: 500px;
            min-height: 280px;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 280px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            min-height: 280px;
            backface-visibility: hidden;
            border-radius: 16px;
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .flashcard-front {
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            color: white;
        }

        .flashcard-front h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: white;
        }

        .flashcard-front p {
            opacity: 0.9;
        }

        .flashcard-back {
            background: var(--bg-primary);
            color: var(--text-primary);
            transform: rotateY(180deg);
            border: 3px solid var(--accent);
        }

        .flashcard-back p {
            font-family: 'Crimson Pro', serif;
            font-size: 1.15rem;
            line-height: 1.8;
        }

        .flashcard-nav {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .flashcard-counter {
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Quiz */
        .quiz-question {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
            border-left: 4px solid var(--accent);
        }

        .quiz-question h4 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .option {
            padding: 1rem;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.95rem;
        }

        .option:hover:not(.disabled) {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .option.selected {
            border-color: var(--accent);
            background: rgba(0, 159, 157, 0.1);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(34, 197, 94, 0.15);
        }

        .option.incorrect {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.15);
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Progress Bar */
        .progress-container {
            margin: 1.5rem 0;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: var(--bg-secondary);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent) 0%, var(--success) 100%);
            transition: width 0.5s ease;
            border-radius: 5px;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Example Box */
        .example-box {
            background: rgba(90, 123, 158, 0.08);
            border-left: 4px solid var(--data);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 12px 12px 0;
        }

        .example-box h4 {
            color: var(--data);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Definition Box */
        .definition-box {
            background: rgba(210, 193, 167, 0.15);
            border: 2px solid var(--premium);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 12px;
        }

        /* Grid Layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-primary);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            min-width: 400px;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--primary);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.85rem;
        }

        tr:hover {
            background: var(--bg-secondary);
        }

        /* Highlight */
        .highlight {
            background: linear-gradient(120deg, rgba(0, 159, 157, 0.15) 0%, rgba(0, 159, 157, 0.08) 100%);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
            color: var(--accent);
        }

        /* Icons */
        .icon-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
        }

        /* Intro Cards */
        .intro-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .intro-card {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .intro-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.1);
            border-color: var(--accent);
        }

        .intro-card .icon-circle {
            margin: 0 auto 1rem;
        }

        .intro-card h3 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .dark .intro-card h3 {
            color: var(--accent);
        }

        /* Manometer Diagram */
        .manometer-svg {
            max-width: 100%;
            height: auto;
        }

        /* Molecule info */
        .molecule-legend {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
            font-size: 0.85rem;
        }

        .molecule-legend span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .molecule-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .card {
                padding: 1.25rem;
            }

            .flashcard-front, .flashcard-back {
                padding: 1.5rem;
            }

            .formula {
                font-size: 1.1rem;
                padding: 1rem;
            }

            canvas {
                height: 250px;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: slideUp 0.3s ease;
            display: none;
        }

        .toast.show {
            display: block;
        }

        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        /* Scroll indicator for tabs */
        .scroll-hint {
            display: none;
            text-align: center;
            font-size: 0.75rem;
            color: rgba(255,255,255,0.6);
            margin-top: 0.5rem;
        }

        @media (max-width: 900px) {
            .scroll-hint {
                display: block;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="header-title">
                    <span class="header-icon">⚗️</span>
                    <div>
                        <h1>Gas Laws</h1>
                        <p class="header-subtitle">Chapter 21: Interactive Physics</p>
                    </div>
                </div>
            </div>
            <div class="nav-container">
                <div class="nav-tabs" id="navTabs">
                    <button class="nav-tab active" data-module="overview">Overview</button>
                    <button class="nav-tab" data-module="boyle">Boyle's Law</button>
                    <button class="nav-tab" data-module="charles">Charles' Law</button>
                    <button class="nav-tab" data-module="pressure">Pressure Law</button>
                    <button class="nav-tab" data-module="general">General Law</button>
                    <button class="nav-tab" data-module="kinetic">Kinetic Theory</button>
                    <button class="nav-tab" data-module="flashcards">Flashcards</button>
                    <button class="nav-tab" data-module="quiz">Quiz</button>
                </div>
                <p class="scroll-hint">← Swipe for more tabs →</p>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Overview Module -->
        <section class="module active" id="overview">
            <div class="card concept-card">
                <h2><i class="fas fa-atom"></i> Introduction to Gas Laws</h2>
                <p>To study the behaviour of a gas, three fundamental quantities must be considered: <span class="highlight">pressure</span>, <span class="highlight">volume</span>, and <span class="highlight">temperature</span>.</p>
                <p style="margin-top: 1rem;">When studying relationships between these quantities, one is kept constant while the other two vary:</p>
            </div>

            <div class="intro-grid">
                <div class="intro-card" onclick="switchModule('boyle')">
                    <div class="icon-circle"><i class="fas fa-compress-arrows-alt"></i></div>
                    <h3>Boyle's Law</h3>
                    <p>Volume vs Pressure</p>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem;">Temperature constant</p>
                </div>
                <div class="intro-card" onclick="switchModule('charles')">
                    <div class="icon-circle"><i class="fas fa-thermometer-half"></i></div>
                    <h3>Charles' Law</h3>
                    <p>Volume vs Temperature</p>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem;">Pressure constant</p>
                </div>
                <div class="intro-card" onclick="switchModule('pressure')">
                    <div class="icon-circle"><i class="fas fa-tachometer-alt"></i></div>
                    <h3>Pressure Law</h3>
                    <p>Pressure vs Temperature</p>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.5rem;">Volume constant</p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-ruler-vertical"></i> Measurement of Gas Pressure</h3>
                <p>Gas pressure is measured using a <strong>manometer</strong>. When gas flows through the manometer, it exerts pressure on the mercury column.</p>

                <div class="simulation-container">
                    <svg viewBox="0 0 400 280" class="manometer-svg">
                        <!-- Background -->
                        <defs>
                            <linearGradient id="mercuryGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#c0c0c0"/>
                                <stop offset="100%" style="stop-color:#808080"/>
                            </linearGradient>
                        </defs>

                        <!-- U-tube -->
                        <path d="M 100 50 L 100 200 Q 100 230 130 230 L 170 230 Q 200 230 200 200 L 200 50" fill="none" stroke="#444" stroke-width="20" stroke-linecap="round"/>
                        <path d="M 100 50 L 100 200 Q 100 230 130 230 L 170 230 Q 200 230 200 200 L 200 50" fill="none" stroke="#87CEEB" stroke-width="14" stroke-linecap="round" opacity="0.3"/>

                        <!-- Mercury in tubes -->
                        <rect x="93" y="150" width="14" height="80" fill="url(#mercuryGrad)"/>
                        <rect x="193" y="100" width="14" height="130" fill="url(#mercuryGrad)"/>

                        <!-- Height markers -->
                        <line x1="220" y1="100" x2="250" y2="100" stroke="var(--accent)" stroke-width="2"/>
                        <line x1="220" y1="150" x2="250" y2="150" stroke="var(--accent)" stroke-width="2"/>
                        <line x1="235" y1="100" x2="235" y2="150" stroke="var(--accent)" stroke-width="2"/>
                        <text x="260" y="130" fill="var(--text-primary)" font-size="14" font-weight="bold">h</text>

                        <!-- Labels -->
                        <text x="100" y="40" fill="var(--text-primary)" font-size="12" text-anchor="middle">Open (A)</text>
                        <text x="200" y="40" fill="var(--text-primary)" font-size="12" text-anchor="middle">Gas (B)</text>

                        <!-- Gas supply -->
                        <rect x="280" y="80" width="80" height="50" rx="8" fill="var(--primary)" opacity="0.8"/>
                        <text x="320" y="110" fill="white" font-size="11" text-anchor="middle">Gas Supply</text>
                        <line x1="280" y1="105" x2="210" y2="105" stroke="var(--primary)" stroke-width="4"/>

                        <!-- Atmospheric pressure arrow -->
                        <path d="M 100 30 L 100 45" stroke="var(--accent)" stroke-width="3" marker-end="url(#arrowhead)"/>
                        <text x="100" y="22" fill="var(--accent)" font-size="11" text-anchor="middle">H (atm)</text>

                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="var(--accent)"/>
                            </marker>
                        </defs>

                        <!-- Formula -->
                        <text x="320" y="180" fill="var(--text-primary)" font-size="13" font-weight="600">P = H + h</text>
                        <text x="320" y="200" fill="var(--text-secondary)" font-size="11">(cmHg)</text>
                    </svg>
                </div>

                <div class="formula">
                    Pressure of gas at B = H + h (cmHg)
                </div>
                <p style="color: var(--text-secondary); text-align: center; font-size: 0.9rem;">where H = atmospheric pressure (76 cmHg) and h = height difference</p>
            </div>

            <div class="card">
                <h3><i class="fas fa-calculator"></i> Standard Atmospheric Pressure</h3>
                <div class="definition-box">
                    <p><strong>Derivation:</strong> Using P = ρgh</p>
                    <p style="margin-top: 0.5rem;">H = 76 cm Hg = 0.76 m Hg</p>
                    <p>Density of mercury ρ = 13,600 kg/m³</p>
                    <p>g = 9.8 m/s²</p>
                </div>
                <div class="formula">
                    P = 13600 × 9.8 × 0.76 = <strong>1.013 × 10⁵ N/m²</strong>
                </div>
                <div class="grid-2">
                    <div class="example-box">
                        <h4><i class="fas fa-info-circle"></i> Key Conversions</h4>
                        <p>• 1 Pascal (Pa) = 1 N/m²</p>
                        <p>• 1 bar = 10⁵ N/m² = 10⁵ Pa</p>
                        <p>• 1 atm = 101,325 Pa</p>
                    </div>
                    <div class="example-box">
                        <h4><i class="fas fa-temperature-low"></i> STP Conditions</h4>
                        <p>• Temperature: 0°C = 273 K</p>
                        <p>• Pressure: 760 mmHg = 76 cmHg</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Boyle's Law Module -->
        <section class="module" id="boyle">
            <div class="law-box">
                <h3>Boyle's Law</h3>
                <p>The volume of a fixed mass of gas varies inversely with its pressure, provided the temperature remains constant.</p>
            </div>

            <div class="card">
                <div class="formula">
                    V ∝ 1/P &nbsp;&nbsp;or&nbsp;&nbsp; PV = constant &nbsp;&nbsp;or&nbsp;&nbsp; P₁V₁ = P₂V₂
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-flask"></i> Interactive Simulation</h3>
                <div class="simulation-container">
                    <canvas id="boyleCanvas"></canvas>
                    <div class="simulation-controls">
                        <div class="slider-group">
                            <label>Volume:</label>
                            <input type="range" id="boyleVolume" min="30" max="100" value="70">
                            <span class="slider-value" id="boyleVolumeValue">70%</span>
                        </div>
                    </div>
                    <div class="molecule-legend">
                        <span><span class="molecule-dot" style="background: #4ade80;"></span> Gas molecules</span>
                        <span><span class="molecule-dot" style="background: #60a5fa;"></span> Piston</span>
                    </div>
                </div>
                <div class="result-box" id="boyleSimResult">
                    <p>Volume: <span id="simVolume">70</span>% | Pressure: <span id="simPressure">1.43</span> units</p>
                    <p class="result-label">As volume decreases, pressure increases (inverse relationship)</p>
                </div>
            </div>

            <div class="card concept-card">
                <h3><i class="fas fa-calculator"></i> Boyle's Law Calculator</h3>
                <div class="calculator-grid">
                    <div class="input-group">
                        <label>Initial Pressure (P₁)</label>
                        <input type="number" id="boyleP1" placeholder="e.g., 850">
                    </div>
                    <div class="input-group">
                        <label>Initial Volume (V₁)</label>
                        <input type="number" id="boyleV1" placeholder="e.g., 20">
                    </div>
                    <div class="input-group">
                        <label>Final Pressure (P₂)</label>
                        <input type="number" id="boyleP2" placeholder="e.g., 600">
                    </div>
                    <div class="input-group">
                        <label>Final Volume (V₂)</label>
                        <input type="number" id="boyleV2" placeholder="Leave blank">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="calculateBoyle()">Calculate</button>
                    <button class="btn btn-secondary" onclick="clearBoyle()">Clear</button>
                </div>
                <div class="result-box" id="boyleResult" style="display: none;">
                    <p class="result-value" id="boyleAnswer"></p>
                    <p class="result-label" id="boyleWorkings"></p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-lightbulb"></i> Worked Examples</h3>
                <div class="example-box">
                    <h4>Example: Volume Change with Pressure</h4>
                    <p><strong>Problem:</strong> A gas has pressure 850 cmHg at volume 20 cm³. Find the volume when pressure becomes 600 cmHg.</p>
                    <p style="margin-top: 1rem;"><strong>Solution:</strong></p>
                    <p>Using P₁V₁ = P₂V₂</p>
                    <p>850 × 20 = 600 × V₂</p>
                    <p>V₂ = (850 × 20) / 600 = <strong>28.33 cm³</strong></p>
                </div>
            </div>
        </section>

        <!-- Charles' Law Module -->
        <section class="module" id="charles">
            <div class="law-box">
                <h3>Charles' Law</h3>
                <p>The volume of a fixed mass of gas is directly proportional to its absolute temperature, provided pressure remains constant.</p>
            </div>

            <div class="card">
                <div class="formula">
                    V ∝ T &nbsp;&nbsp;or&nbsp;&nbsp; V/T = constant &nbsp;&nbsp;or&nbsp;&nbsp; V₁/T₁ = V₂/T₂
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-flask"></i> Interactive Simulation</h3>
                <div class="simulation-container">
                    <canvas id="charlesCanvas"></canvas>
                    <div class="simulation-controls">
                        <div class="slider-group">
                            <label>Temperature:</label>
                            <input type="range" id="charlesTemp" min="200" max="500" value="300">
                            <span class="slider-value" id="charlesTempValue">300 K</span>
                        </div>
                    </div>
                </div>
                <div class="result-box" id="charlesSimResult">
                    <p>Temperature: <span id="simTemp">300</span> K | Volume: <span id="simCharlesVol">100</span>%</p>
                    <p class="result-label">As temperature increases, volume increases (direct relationship)</p>
                </div>
            </div>

            <div class="card concept-card">
                <h3><i class="fas fa-calculator"></i> Charles' Law Calculator</h3>
                <div class="calculator-grid">
                    <div class="input-group">
                        <label>Initial Volume (V₁)</label>
                        <input type="number" id="charlesV1" placeholder="e.g., 600">
                    </div>
                    <div class="input-group">
                        <label>Initial Temp (T₁) in K</label>
                        <input type="number" id="charlesT1" placeholder="e.g., 273">
                    </div>
                    <div class="input-group">
                        <label>Final Volume (V₂)</label>
                        <input type="number" id="charlesV2" placeholder="Leave blank">
                    </div>
                    <div class="input-group">
                        <label>Final Temp (T₂) in K</label>
                        <input type="number" id="charlesT2" placeholder="e.g., 403">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="calculateCharles()">Calculate</button>
                    <button class="btn btn-secondary" onclick="clearCharles()">Clear</button>
                </div>
                <div class="result-box" id="charlesResult" style="display: none;">
                    <p class="result-value" id="charlesAnswer"></p>
                    <p class="result-label" id="charlesWorkings"></p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-snowflake"></i> Absolute Zero</h3>
                <div class="definition-box">
                    <p>When the volume-temperature graph is extrapolated backward, it meets the temperature axis at <strong>−273°C</strong>, called <span class="highlight">absolute zero</span>.</p>
                    <div class="formula" style="margin-top: 1rem;">
                        T (K) = θ (°C) + 273
                    </div>
                </div>
            </div>
        </section>

        <!-- Pressure Law Module -->
        <section class="module" id="pressure">
            <div class="law-box">
                <h3>Pressure Law (Gay-Lussac's Law)</h3>
                <p>The pressure of a fixed mass of gas is directly proportional to its absolute temperature, provided volume is constant.</p>
            </div>

            <div class="card">
                <div class="formula">
                    P ∝ T &nbsp;&nbsp;or&nbsp;&nbsp; P/T = constant &nbsp;&nbsp;or&nbsp;&nbsp; P₁/T₁ = P₂/T₂
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-flask"></i> Interactive Simulation</h3>
                <div class="simulation-container">
                    <canvas id="pressureCanvas"></canvas>
                    <div class="simulation-controls">
                        <div class="slider-group">
                            <label>Temperature:</label>
                            <input type="range" id="pressureTemp" min="200" max="500" value="300">
                            <span class="slider-value" id="pressureTempValue">300 K</span>
                        </div>
                    </div>
                </div>
                <div class="result-box" id="pressureSimResult">
                    <p>Temperature: <span id="simPressTemp">300</span> K | Pressure: <span id="simPressPressure">1.0</span> units</p>
                    <p class="result-label">At constant volume, higher temperature = higher pressure</p>
                </div>
            </div>

            <div class="card concept-card">
                <h3><i class="fas fa-calculator"></i> Pressure Law Calculator</h3>
                <div class="calculator-grid">
                    <div class="input-group">
                        <label>Initial Pressure (P₁)</label>
                        <input type="number" id="pressP1" placeholder="e.g., 100">
                    </div>
                    <div class="input-group">
                        <label>Initial Temp (T₁) in K</label>
                        <input type="number" id="pressT1" placeholder="e.g., 300">
                    </div>
                    <div class="input-group">
                        <label>Final Pressure (P₂)</label>
                        <input type="number" id="pressP2" placeholder="Leave blank">
                    </div>
                    <div class="input-group">
                        <label>Final Temp (T₂) in K</label>
                        <input type="number" id="pressT2" placeholder="e.g., 360">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="calculatePressure()">Calculate</button>
                    <button class="btn btn-secondary" onclick="clearPressure()">Clear</button>
                </div>
                <div class="result-box" id="pressureResult" style="display: none;">
                    <p class="result-value" id="pressureAnswer"></p>
                    <p class="result-label" id="pressureWorkings"></p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-lightbulb"></i> Worked Example</h3>
                <div class="example-box">
                    <h4>Example: Pressure at Different Temperature</h4>
                    <p><strong>Problem:</strong> Pressure of a gas at constant volume is 100 cmHg at 27°C. Find pressure at 87°C.</p>
                    <p style="margin-top: 1rem;"><strong>Solution:</strong></p>
                    <p>T₁ = 27 + 273 = 300 K</p>
                    <p>T₂ = 87 + 273 = 360 K</p>
                    <p>Using P₁/T₁ = P₂/T₂</p>
                    <p>100/300 = P₂/360</p>
                    <p>P₂ = (100 × 360) / 300 = <strong>120 cmHg</strong></p>
                </div>
            </div>
        </section>

        <!-- General Gas Law Module -->
        <section class="module" id="general">
            <div class="law-box">
                <h3>General Gas Law (Combined Gas Law)</h3>
                <p>Combines Boyle's, Charles', and Pressure laws into a single equation.</p>
            </div>

            <div class="card">
                <div class="formula">
                    PV/T = constant &nbsp;&nbsp;or&nbsp;&nbsp; P₁V₁/T₁ = P₂V₂/T₂
                </div>
            </div>

            <div class="card concept-card">
                <h3><i class="fas fa-calculator"></i> General Gas Law Calculator</h3>
                <div class="calculator-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));">
                    <div class="input-group">
                        <label>P₁ (pressure)</label>
                        <input type="number" id="genP1" placeholder="e.g., 300">
                    </div>
                    <div class="input-group">
                        <label>V₁ (volume)</label>
                        <input type="number" id="genV1" placeholder="e.g., 50">
                    </div>
                    <div class="input-group">
                        <label>T₁ (K)</label>
                        <input type="number" id="genT1" placeholder="e.g., 305">
                    </div>
                    <div class="input-group">
                        <label>P₂ (pressure)</label>
                        <input type="number" id="genP2" placeholder="e.g., 360">
                    </div>
                    <div class="input-group">
                        <label>V₂ (volume)</label>
                        <input type="number" id="genV2" placeholder="e.g., 80">
                    </div>
                    <div class="input-group">
                        <label>T₂ (K)</label>
                        <input type="number" id="genT2" placeholder="Leave blank">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="calculateGeneral()">Calculate</button>
                    <button class="btn btn-secondary" onclick="clearGeneral()">Clear</button>
                </div>
                <div class="result-box" id="generalResult" style="display: none;">
                    <p class="result-value" id="generalAnswer"></p>
                    <p class="result-label" id="generalWorkings"></p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-exchange-alt"></i> STP Converter</h3>
                <p style="margin-bottom: 1rem;">Convert gas volume to Standard Temperature and Pressure (0°C, 760 mmHg)</p>
                <div class="calculator-grid">
                    <div class="input-group">
                        <label>Volume (cm³)</label>
                        <input type="number" id="stpV" placeholder="e.g., 800">
                    </div>
                    <div class="input-group">
                        <label>Temperature (°C)</label>
                        <input type="number" id="stpTc" placeholder="e.g., 33">
                    </div>
                    <div class="input-group">
                        <label>Pressure (mmHg)</label>
                        <input type="number" id="stpP" placeholder="e.g., 500">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="convertToSTP()">Convert to STP</button>
                </div>
                <div class="result-box" id="stpResult" style="display: none;">
                    <p class="result-value" id="stpAnswer"></p>
                    <p class="result-label">Volume at STP (0°C, 760 mmHg)</p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-vial"></i> Van der Waals' Equation</h3>
                <div class="definition-box">
                    <p>For <strong>real gases</strong> at high pressure or low temperature, intermolecular forces and molecular volume become significant:</p>
                    <div class="formula">
                        (P + a/V²)(V − b) = RT
                    </div>
                    <p style="margin-top: 1rem;"><strong>a</strong> = accounts for intermolecular attraction</p>
                    <p><strong>b</strong> = accounts for finite molecular volume</p>
                </div>
            </div>
        </section>

        <!-- Kinetic Theory Module -->
        <section class="module" id="kinetic">
            <div class="card concept-card">
                <h2><i class="fas fa-atom"></i> Kinetic Molecular Theory</h2>
                <p>The kinetic theory of gases provides a microscopic explanation for the macroscopic behavior described by gas laws.</p>
            </div>

            <div class="card">
                <h3><i class="fas fa-list-ol"></i> Key Assumptions</h3>
                <div class="grid-2">
                    <div class="example-box">
                        <h4>1. Particles</h4>
                        <p>Matter is composed of tiny atoms and molecules in constant random motion.</p>
                    </div>
                    <div class="example-box">
                        <h4>2. Motion</h4>
                        <p>Gas molecules move continuously and possess kinetic energy.</p>
                    </div>
                    <div class="example-box">
                        <h4>3. Forces</h4>
                        <p>Molecules exert attractive forces (Van der Waals forces) that increase with proximity.</p>
                    </div>
                    <div class="example-box">
                        <h4>4. Collisions</h4>
                        <p>Collisions between molecules and with container walls are elastic.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-microscope"></i> Explaining Gas Laws with Kinetic Theory</h3>

                <div class="definition-box">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">Pressure</h4>
                    <p>Gas pressure results from molecular collisions with container walls, causing momentum change per unit area.</p>
                </div>

                <div class="definition-box">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">Boyle's Law Explanation</h4>
                    <p>Reducing volume → molecules travel shorter distances → more collisions per second with walls → <strong>higher pressure</strong></p>
                </div>

                <div class="definition-box">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">Charles' Law Explanation</h4>
                    <p>Higher temperature → molecules move faster → more frequent and forceful collisions. To maintain constant pressure, volume must <strong>increase</strong>.</p>
                </div>

                <div class="definition-box">
                    <h4 style="color: var(--accent); margin-bottom: 0.5rem;">Pressure Law Explanation</h4>
                    <p>At constant volume, higher temperature → faster molecules → more frequent and stronger collisions → <strong>pressure increases</strong>.</p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-line"></i> Summary of Gas Laws</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Law</th>
                                <th>Relationship</th>
                                <th>Constant</th>
                                <th>Formula</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Boyle's</td>
                                <td>V ∝ 1/P</td>
                                <td>Temperature</td>
                                <td>PV = k</td>
                            </tr>
                            <tr>
                                <td>Charles'</td>
                                <td>V ∝ T</td>
                                <td>Pressure</td>
                                <td>V/T = k</td>
                            </tr>
                            <tr>
                                <td>Pressure</td>
                                <td>P ∝ T</td>
                                <td>Volume</td>
                                <td>P/T = k</td>
                            </tr>
                            <tr>
                                <td>General</td>
                                <td>Combined</td>
                                <td>Mass only</td>
                                <td>PV/T = k</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Flashcards Module -->
        <section class="module" id="flashcards">
            <div class="card">
                <h2><i class="fas fa-clone"></i> Study Flashcards</h2>
                <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1rem;">Click the card to flip and reveal the answer</p>

                <div class="flashcard-container">
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="flashcard-inner">
                            <div class="flashcard-front">
                                <h3 id="flashcardQuestion">What is Boyle's Law?</h3>
                                <p>Click to reveal answer</p>
                            </div>
                            <div class="flashcard-back">
                                <p id="flashcardAnswer">The volume of a fixed mass of gas varies inversely with its pressure, provided the temperature remains constant. (PV = constant)</p>
                            </div>
                        </div>
                    </div>

                    <div class="flashcard-nav">
                        <button class="btn btn-secondary" onclick="prevCard()"><i class="fas fa-chevron-left"></i></button>
                        <span class="flashcard-counter"><span id="cardNum">1</span> / <span id="totalCards">10</span></span>
                        <button class="btn btn-secondary" onclick="nextCard()"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quiz Module -->
        <section class="module" id="quiz">
            <div class="card">
                <h2><i class="fas fa-question-circle"></i> Chapter Quiz</h2>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="quizProgress" style="width: 0%;"></div>
                    </div>
                    <div class="progress-text">
                        <span>Score: <span id="quizScore">0</span>/<span id="quizTotal">10</span></span>
                        <span id="quizPercent">0%</span>
                    </div>
                </div>
            </div>

            <div id="quizContainer"></div>

            <div class="card" style="text-align: center;">
                <button class="btn btn-primary" onclick="resetQuiz()"><i class="fas fa-redo"></i> Reset Quiz</button>
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Navigation
        const navTabs = document.querySelectorAll('.nav-tab');
        const modules = document.querySelectorAll('.module');

        function switchModule(moduleName) {
            navTabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.module === moduleName);
            });
            modules.forEach(module => {
                module.classList.toggle('active', module.id === moduleName);
            });
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        navTabs.forEach(tab => {
            tab.addEventListener('click', () => switchModule(tab.dataset.module));
        });

        // Toast notifications
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Boyle's Law Calculator
        function calculateBoyle() {
            const p1 = parseFloat(document.getElementById('boyleP1').value);
            const v1 = parseFloat(document.getElementById('boyleV1').value);
            const p2 = parseFloat(document.getElementById('boyleP2').value);
            const v2 = parseFloat(document.getElementById('boyleV2').value);

            let result, workings, missing;
            const filledCount = [p1, v1, p2, v2].filter(x => !isNaN(x)).length;

            if (filledCount !== 3) {
                showToast('Please fill exactly 3 values');
                return;
            }

            if (isNaN(v2)) {
                result = (p1 * v1) / p2;
                missing = 'V₂';
                workings = `V₂ = (${p1} × ${v1}) / ${p2} = ${result.toFixed(2)}`;
            } else if (isNaN(p2)) {
                result = (p1 * v1) / v2;
                missing = 'P₂';
                workings = `P₂ = (${p1} × ${v1}) / ${v2} = ${result.toFixed(2)}`;
            } else if (isNaN(v1)) {
                result = (p2 * v2) / p1;
                missing = 'V₁';
                workings = `V₁ = (${p2} × ${v2}) / ${p1} = ${result.toFixed(2)}`;
            } else {
                result = (p2 * v2) / v1;
                missing = 'P₁';
                workings = `P₁ = (${p2} × ${v2}) / ${v1} = ${result.toFixed(2)}`;
            }

            document.getElementById('boyleAnswer').textContent = `${missing} = ${result.toFixed(2)}`;
            document.getElementById('boyleWorkings').textContent = workings;
            document.getElementById('boyleResult').style.display = 'block';
        }

        function clearBoyle() {
            ['boyleP1', 'boyleV1', 'boyleP2', 'boyleV2'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('boyleResult').style.display = 'none';
        }

        // Charles' Law Calculator
        function calculateCharles() {
            const v1 = parseFloat(document.getElementById('charlesV1').value);
            const t1 = parseFloat(document.getElementById('charlesT1').value);
            const v2 = parseFloat(document.getElementById('charlesV2').value);
            const t2 = parseFloat(document.getElementById('charlesT2').value);

            let result, workings, missing;
            const filledCount = [v1, t1, v2, t2].filter(x => !isNaN(x)).length;

            if (filledCount !== 3) {
                showToast('Please fill exactly 3 values');
                return;
            }

            if (isNaN(v2)) {
                result = (v1 * t2) / t1;
                missing = 'V₂';
                workings = `V₂ = (${v1} × ${t2}) / ${t1} = ${result.toFixed(2)}`;
            } else if (isNaN(t2)) {
                result = (t1 * v2) / v1;
                missing = 'T₂';
                workings = `T₂ = (${t1} × ${v2}) / ${v1} = ${result.toFixed(2)} K`;
            } else if (isNaN(v1)) {
                result = (v2 * t1) / t2;
                missing = 'V₁';
                workings = `V₁ = (${v2} × ${t1}) / ${t2} = ${result.toFixed(2)}`;
            } else {
                result = (t2 * v1) / v2;
                missing = 'T₁';
                workings = `T₁ = (${t2} × ${v1}) / ${v2} = ${result.toFixed(2)} K`;
            }

            document.getElementById('charlesAnswer').textContent = `${missing} = ${result.toFixed(2)}`;
            document.getElementById('charlesWorkings').textContent = workings;
            document.getElementById('charlesResult').style.display = 'block';
        }

        function clearCharles() {
            ['charlesV1', 'charlesT1', 'charlesV2', 'charlesT2'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('charlesResult').style.display = 'none';
        }

        // Pressure Law Calculator
        function calculatePressure() {
            const p1 = parseFloat(document.getElementById('pressP1').value);
            const t1 = parseFloat(document.getElementById('pressT1').value);
            const p2 = parseFloat(document.getElementById('pressP2').value);
            const t2 = parseFloat(document.getElementById('pressT2').value);

            let result, workings, missing;
            const filledCount = [p1, t1, p2, t2].filter(x => !isNaN(x)).length;

            if (filledCount !== 3) {
                showToast('Please fill exactly 3 values');
                return;
            }

            if (isNaN(p2)) {
                result = (p1 * t2) / t1;
                missing = 'P₂';
                workings = `P₂ = (${p1} × ${t2}) / ${t1} = ${result.toFixed(2)}`;
            } else if (isNaN(t2)) {
                result = (t1 * p2) / p1;
                missing = 'T₂';
                workings = `T₂ = (${t1} × ${p2}) / ${p1} = ${result.toFixed(2)} K`;
            } else if (isNaN(p1)) {
                result = (p2 * t1) / t2;
                missing = 'P₁';
                workings = `P₁ = (${p2} × ${t1}) / ${t2} = ${result.toFixed(2)}`;
            } else {
                result = (t2 * p1) / p2;
                missing = 'T₁';
                workings = `T₁ = (${t2} × ${p1}) / ${p2} = ${result.toFixed(2)} K`;
            }

            document.getElementById('pressureAnswer').textContent = `${missing} = ${result.toFixed(2)}`;
            document.getElementById('pressureWorkings').textContent = workings;
            document.getElementById('pressureResult').style.display = 'block';
        }

        function clearPressure() {
            ['pressP1', 'pressT1', 'pressP2', 'pressT2'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('pressureResult').style.display = 'none';
        }

        // General Gas Law Calculator
        function calculateGeneral() {
            const p1 = parseFloat(document.getElementById('genP1').value);
            const v1 = parseFloat(document.getElementById('genV1').value);
            const t1 = parseFloat(document.getElementById('genT1').value);
            const p2 = parseFloat(document.getElementById('genP2').value);
            const v2 = parseFloat(document.getElementById('genV2').value);
            const t2 = parseFloat(document.getElementById('genT2').value);

            const values = [p1, v1, t1, p2, v2, t2];
            const filledCount = values.filter(x => !isNaN(x)).length;

            if (filledCount !== 5) {
                showToast('Please fill exactly 5 values');
                return;
            }

            let result, workings, missing;

            if (isNaN(t2)) {
                result = (p2 * v2 * t1) / (p1 * v1);
                missing = 'T₂';
                workings = `T₂ = (${p2} × ${v2} × ${t1}) / (${p1} × ${v1}) = ${result.toFixed(2)} K`;
            } else if (isNaN(v2)) {
                result = (p1 * v1 * t2) / (p2 * t1);
                missing = 'V₂';
                workings = `V₂ = (${p1} × ${v1} × ${t2}) / (${p2} × ${t1}) = ${result.toFixed(2)}`;
            } else if (isNaN(p2)) {
                result = (p1 * v1 * t2) / (v2 * t1);
                missing = 'P₂';
                workings = `P₂ = (${p1} × ${v1} × ${t2}) / (${v2} × ${t1}) = ${result.toFixed(2)}`;
            } else if (isNaN(t1)) {
                result = (p1 * v1 * t2) / (p2 * v2);
                missing = 'T₁';
                workings = `T₁ = (${p1} × ${v1} × ${t2}) / (${p2} × ${v2}) = ${result.toFixed(2)} K`;
            } else if (isNaN(v1)) {
                result = (p2 * v2 * t1) / (p1 * t2);
                missing = 'V₁';
                workings = `V₁ = (${p2} × ${v2} × ${t1}) / (${p1} × ${t2}) = ${result.toFixed(2)}`;
            } else {
                result = (p2 * v2 * t1) / (v1 * t2);
                missing = 'P₁';
                workings = `P₁ = (${p2} × ${v2} × ${t1}) / (${v1} × ${t2}) = ${result.toFixed(2)}`;
            }

            document.getElementById('generalAnswer').textContent = `${missing} = ${result.toFixed(2)}`;
            document.getElementById('generalWorkings').textContent = workings;
            document.getElementById('generalResult').style.display = 'block';
        }

        function clearGeneral() {
            ['genP1', 'genV1', 'genT1', 'genP2', 'genV2', 'genT2'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('generalResult').style.display = 'none';
        }

        // STP Converter
        function convertToSTP() {
            const v = parseFloat(document.getElementById('stpV').value);
            const tc = parseFloat(document.getElementById('stpTc').value);
            const p = parseFloat(document.getElementById('stpP').value);

            if (isNaN(v) || isNaN(tc) || isNaN(p)) {
                showToast('Please fill all values');
                return;
            }

            const t1 = tc + 273;
            const t2 = 273;
            const p2 = 760;

            const v2 = (p * v * t2) / (t1 * p2);

            document.getElementById('stpAnswer').textContent = `${v2.toFixed(2)} cm³`;
            document.getElementById('stpResult').style.display = 'block';
        }

        // Flashcards
        const flashcards = [
            { q: "What is Boyle's Law?", a: "The volume of a fixed mass of gas varies inversely with its pressure, provided the temperature remains constant. (PV = constant)" },
            { q: "What is Charles' Law?", a: "The volume of a fixed mass of gas is directly proportional to its absolute temperature, provided pressure remains constant. (V/T = constant)" },
            { q: "What is the Pressure Law (Gay-Lussac's)?", a: "The pressure of a fixed mass of gas is directly proportional to its absolute temperature, provided volume is constant. (P/T = constant)" },
            { q: "What is Absolute Zero?", a: "The temperature at which a gas would theoretically have zero volume. It equals −273°C or 0 Kelvin." },
            { q: "How do you convert Celsius to Kelvin?", a: "T(K) = θ(°C) + 273" },
            { q: "What is Standard Temperature and Pressure (STP)?", a: "Temperature: 0°C (273 K) and Pressure: 760 mmHg (76 cmHg or 1.013 × 10⁵ N/m²)" },
            { q: "What is the General Gas Law equation?", a: "P₁V₁/T₁ = P₂V₂/T₂ (combines all three gas laws)" },
            { q: "How does a manometer measure gas pressure?", a: "It measures the height difference (h) in mercury columns. Gas pressure = H + h, where H is atmospheric pressure." },
            { q: "Why does pressure increase when volume decreases (kinetic explanation)?", a: "Molecules travel shorter distances, leading to more frequent collisions with container walls per second." },
            { q: "What is Van der Waals' equation?", a: "(P + a/V²)(V − b) = RT, where 'a' accounts for intermolecular attraction and 'b' for molecular volume." }
        ];

        let currentCard = 0;

        function updateFlashcard() {
            document.getElementById('flashcardQuestion').textContent = flashcards[currentCard].q;
            document.getElementById('flashcardAnswer').textContent = flashcards[currentCard].a;
            document.getElementById('cardNum').textContent = currentCard + 1;
            document.getElementById('totalCards').textContent = flashcards.length;
            document.getElementById('flashcard').classList.remove('flipped');
        }

        function flipCard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }

        function nextCard() {
            currentCard = (currentCard + 1) % flashcards.length;
            updateFlashcard();
        }

        function prevCard() {
            currentCard = (currentCard - 1 + flashcards.length) % flashcards.length;
            updateFlashcard();
        }

        // Quiz
        const quizQuestions = [
            { q: "Absolute zero of temperature is:", options: ["−273°C", "100°C", "0°C", "273°C"], correct: 0 },
            { q: "If a piston is pushed into a closed cylinder, which statements are true?\nI. Collisions per second increase\nII. Average distance between molecules decreases\nIII. Pressure increases", options: ["I and II only", "I and III only", "I, II, and III", "II and III only"], correct: 2 },
            { q: "Volume of gas at 0°C is 273 cm³. What is the volume at 273°C at constant pressure?", options: ["272 cm³", "273 cm³", "274 cm³", "546 cm³"], correct: 3 },
            { q: "Gas volume is 600 cm³ at 27°C. Cooled to 0°C at constant pressure. What is the change in volume?", options: ["54 cm³", "273 cm³", "300 cm³", "546 cm³"], correct: 0 },
            { q: "Gas at 30°C has volume reduced to 2/3 and pressure doubled. New temperature?", options: ["404°C", "313°C", "131°C", "101°C"], correct: 2 },
            { q: "According to kinetic theory, which is NOT correct when temperature increases?", options: ["Mean speed increases", "Collisions per second increase", "Momentum change per collision increases", "Mean kinetic energy decreases"], correct: 3 },
            { q: "Pressure changes from 200 N/m² to 100 N/m², temperature from 127°C to 73°C. Ratio V₂:V₁?", options: ["2.4:1", "2.0:1", "1.73:1", "1.2:1"], correct: 2 },
            { q: "Pressure is 2.0 × 10⁵ N/m² at constant temperature. If volume is halved, new pressure?", options: ["1.0 × 10⁵", "2.0 × 10⁵", "3.0 × 10⁵", "4.0 × 10⁵"], correct: 3 },
            { q: "In Boyle's Law, what remains constant?", options: ["Pressure", "Volume", "Temperature", "Mass only"], correct: 2 },
            { q: "The formula PV/T = constant is known as the:", options: ["Boyle's Law", "Charles' Law", "Pressure Law", "General Gas Law"], correct: 3 }
        ];

        let quizScore = 0;
        let answeredQuestions = new Set();

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = quizQuestions.map((q, idx) => `
                <div class="card quiz-question" id="question${idx}">
                    <h4>Question ${idx + 1}: ${q.q.replace(/\n/g, '<br>')}</h4>
                    <div class="options">
                        ${q.options.map((opt, optIdx) => `
                            <div class="option" data-question="${idx}" data-option="${optIdx}" onclick="selectAnswer(${idx}, ${optIdx})">
                                ${String.fromCharCode(65 + optIdx)}. ${opt}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            updateQuizProgress();
        }

        function selectAnswer(questionIdx, optionIdx) {
            if (answeredQuestions.has(questionIdx)) return;

            const question = quizQuestions[questionIdx];
            const options = document.querySelectorAll(`[data-question="${questionIdx}"]`);

            options.forEach(opt => {
                opt.classList.add('disabled');
                const thisOptIdx = parseInt(opt.dataset.option);
                if (thisOptIdx === question.correct) {
                    opt.classList.add('correct');
                } else if (thisOptIdx === optionIdx) {
                    opt.classList.add('incorrect');
                }
            });

            if (optionIdx === question.correct) {
                quizScore++;
            }

            answeredQuestions.add(questionIdx);
            updateQuizProgress();
        }

        function updateQuizProgress() {
            const total = quizQuestions.length;
            const percent = (answeredQuestions.size / total) * 100;
            document.getElementById('quizProgress').style.width = `${percent}%`;
            document.getElementById('quizScore').textContent = quizScore;
            document.getElementById('quizTotal').textContent = total;
            document.getElementById('quizPercent').textContent = `${Math.round((quizScore / total) * 100)}%`;
        }

        function resetQuiz() {
            quizScore = 0;
            answeredQuestions.clear();
            renderQuiz();
        }

        // Gas Simulations
        class GasSimulation {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.molecules = [];
                this.width = 0;
                this.height = 0;
                this.containerWidth = 100;
                this.temperature = 300;
                this.animationId = null;
                this.resize();
            }

            resize() {
                const rect = this.canvas.getBoundingClientRect();
                this.canvas.width = rect.width * window.devicePixelRatio;
                this.canvas.height = 300 * window.devicePixelRatio;
                this.ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
                this.width = rect.width;
                this.height = 300;
            }

            initMolecules(count = 30) {
                this.molecules = [];
                for (let i = 0; i < count; i++) {
                    this.molecules.push({
                        x: Math.random() * this.width * 0.6 + this.width * 0.1,
                        y: Math.random() * (this.height - 80) + 40,
                        vx: (Math.random() - 0.5) * 4,
                        vy: (Math.random() - 0.5) * 4,
                        radius: 6
                    });
                }
            }

            update(containerWidthPercent, speedMultiplier = 1) {
                const containerLeft = this.width * 0.1;
                const containerRight = containerLeft + (this.width * 0.7 * containerWidthPercent / 100);
                const containerTop = 40;
                const containerBottom = this.height - 40;

                this.molecules.forEach(m => {
                    m.x += m.vx * speedMultiplier;
                    m.y += m.vy * speedMultiplier;

                    if (m.x - m.radius < containerLeft) {
                        m.x = containerLeft + m.radius;
                        m.vx = Math.abs(m.vx);
                    }
                    if (m.x + m.radius > containerRight) {
                        m.x = containerRight - m.radius;
                        m.vx = -Math.abs(m.vx);
                    }
                    if (m.y - m.radius < containerTop) {
                        m.y = containerTop + m.radius;
                        m.vy = Math.abs(m.vy);
                    }
                    if (m.y + m.radius > containerBottom) {
                        m.y = containerBottom - m.radius;
                        m.vy = -Math.abs(m.vy);
                    }
                });
            }

            drawBoyle(containerWidthPercent) {
                this.ctx.clearRect(0, 0, this.width, this.height);

                const containerLeft = this.width * 0.1;
                const containerWidth = this.width * 0.7 * containerWidthPercent / 100;
                const containerTop = 40;
                const containerHeight = this.height - 80;

                // Container
                this.ctx.fillStyle = 'rgba(30, 58, 95, 0.8)';
                this.ctx.fillRect(containerLeft, containerTop, containerWidth, containerHeight);
                this.ctx.strokeStyle = '#60a5fa';
                this.ctx.lineWidth = 3;
                this.ctx.strokeRect(containerLeft, containerTop, containerWidth, containerHeight);

                // Piston
                this.ctx.fillStyle = 'linear-gradient(180deg, #60a5fa 0%, #3b82f6 100%)';
                this.ctx.fillStyle = '#60a5fa';
                this.ctx.fillRect(containerLeft + containerWidth - 15, containerTop, 20, containerHeight);

                // Molecules
                this.molecules.forEach(m => {
                    this.ctx.beginPath();
                    this.ctx.arc(m.x, m.y, m.radius, 0, Math.PI * 2);
                    this.ctx.fillStyle = '#4ade80';
                    this.ctx.fill();
                    this.ctx.strokeStyle = '#22c55e';
                    this.ctx.lineWidth = 1;
                    this.ctx.stroke();
                });

                // Labels
                this.ctx.fillStyle = '#fff';
                this.ctx.font = '14px Sora';
                this.ctx.fillText('Volume', containerLeft + containerWidth / 2 - 25, this.height - 15);
            }

            drawCharles(tempK) {
                this.ctx.clearRect(0, 0, this.width, this.height);

                const volumePercent = (tempK / 300) * 70;
                const containerLeft = this.width * 0.15;
                const containerWidth = this.width * volumePercent / 100;
                const containerTop = 40;
                const containerHeight = this.height - 80;

                // Container
                const hue = Math.min(60, (tempK - 200) / 5);
                this.ctx.fillStyle = `hsla(${hue}, 70%, 20%, 0.8)`;
                this.ctx.fillRect(containerLeft, containerTop, containerWidth, containerHeight);
                this.ctx.strokeStyle = `hsl(${hue}, 70%, 50%)`;
                this.ctx.lineWidth = 3;
                this.ctx.strokeRect(containerLeft, containerTop, containerWidth, containerHeight);

                // Molecules
                this.molecules.forEach(m => {
                    this.ctx.beginPath();
                    this.ctx.arc(m.x, m.y, m.radius, 0, Math.PI * 2);
                    this.ctx.fillStyle = `hsl(${hue + 60}, 70%, 60%)`;
                    this.ctx.fill();
                });

                // Temperature indicator
                this.ctx.fillStyle = '#fff';
                this.ctx.font = '14px Sora';
                this.ctx.fillText(`${tempK} K`, this.width - 60, 30);
            }

            drawPressure(tempK) {
                this.ctx.clearRect(0, 0, this.width, this.height);

                const containerLeft = this.width * 0.2;
                const containerWidth = this.width * 0.6;
                const containerTop = 40;
                const containerHeight = this.height - 80;

                // Container (fixed volume)
                const hue = Math.min(60, (tempK - 200) / 5);
                this.ctx.fillStyle = `hsla(${hue}, 70%, 20%, 0.8)`;
                this.ctx.fillRect(containerLeft, containerTop, containerWidth, containerHeight);
                this.ctx.strokeStyle = `hsl(${hue}, 70%, 50%)`;
                this.ctx.lineWidth = 4;
                this.ctx.strokeRect(containerLeft, containerTop, containerWidth, containerHeight);

                // Molecules
                this.molecules.forEach(m => {
                    this.ctx.beginPath();
                    this.ctx.arc(m.x, m.y, m.radius, 0, Math.PI * 2);
                    this.ctx.fillStyle = `hsl(${hue + 60}, 70%, 60%)`;
                    this.ctx.fill();
                });

                // Fixed volume indicator
                this.ctx.fillStyle = '#fff';
                this.ctx.font = '12px Sora';
                this.ctx.fillText('Fixed Volume', containerLeft + containerWidth / 2 - 40, this.height - 15);
            }
        }

        // Initialize simulations
        let boyleSim, charlesSim, pressureSim;

        function initSimulations() {
            // Boyle's Law
            boyleSim = new GasSimulation('boyleCanvas');
            boyleSim.initMolecules(25);

            const boyleSlider = document.getElementById('boyleVolume');
            boyleSlider.addEventListener('input', () => {
                const vol = parseInt(boyleSlider.value);
                document.getElementById('boyleVolumeValue').textContent = vol + '%';
                document.getElementById('simVolume').textContent = vol;
                document.getElementById('simPressure').textContent = (100 / vol).toFixed(2);
            });

            function animateBoyle() {
                const vol = parseInt(boyleSlider.value);
                boyleSim.update(vol, 1);
                boyleSim.drawBoyle(vol);
                requestAnimationFrame(animateBoyle);
            }
            animateBoyle();

            // Charles' Law
            charlesSim = new GasSimulation('charlesCanvas');
            charlesSim.initMolecules(25);

            const charlesSlider = document.getElementById('charlesTemp');
            charlesSlider.addEventListener('input', () => {
                const temp = parseInt(charlesSlider.value);
                document.getElementById('charlesTempValue').textContent = temp + ' K';
                document.getElementById('simTemp').textContent = temp;
                document.getElementById('simCharlesVol').textContent = Math.round((temp / 300) * 100);
            });

            function animateCharles() {
                const temp = parseInt(charlesSlider.value);
                const speed = temp / 300;
                charlesSim.update((temp / 300) * 70, speed);
                charlesSim.drawCharles(temp);
                requestAnimationFrame(animateCharles);
            }
            animateCharles();

            // Pressure Law
            pressureSim = new GasSimulation('pressureCanvas');
            pressureSim.initMolecules(25);

            const pressureSlider = document.getElementById('pressureTemp');
            pressureSlider.addEventListener('input', () => {
                const temp = parseInt(pressureSlider.value);
                document.getElementById('pressureTempValue').textContent = temp + ' K';
                document.getElementById('simPressTemp').textContent = temp;
                document.getElementById('simPressPressure').textContent = (temp / 300).toFixed(2);
            });

            function animatePressure() {
                const temp = parseInt(pressureSlider.value);
                const speed = temp / 300;
                pressureSim.update(60, speed);
                pressureSim.drawPressure(temp);
                requestAnimationFrame(animatePressure);
            }
            animatePressure();
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            updateFlashcard();
            renderQuiz();
            initSimulations();

            // Handle canvas resize
            window.addEventListener('resize', () => {
                if (boyleSim) boyleSim.resize();
                if (charlesSim) charlesSim.resize();
                if (pressureSim) pressureSim.resize();
            });
        });
    </script>
</body>
</html>

