<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bohr Atom Visualizer</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=JetBrains+Mono:wght@300;400;500&family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --accent-cyan: #00f5ff;
            --accent-magenta: #ff00aa;
            --accent-purple: #8b5cf6;
            --accent-gold: #ffd700;
            --text-primary: #e8e8f0;
            --text-secondary: #8888aa;
            --glow-cyan: 0 0 30px rgba(0, 245, 255, 0.5);
            --glow-magenta: 0 0 30px rgba(255, 0, 170, 0.5);
        }

        .dark {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated background */
        .cosmos-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .nebula {
            position: absolute;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.15;
            animation: float 20s ease-in-out infinite;
        }

        .nebula-1 {
            background: radial-gradient(circle, var(--accent-purple) 0%, transparent 70%);
            top: -200px;
            right: -200px;
        }

        .nebula-2 {
            background: radial-gradient(circle, var(--accent-cyan) 0%, transparent 70%);
            bottom: -200px;
            left: -200px;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(30px, -30px) scale(1.1); }
        }

        /* Main container */
        .app-container {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 16px;
            gap: 16px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 20px 0;
        }

        .header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-magenta) 50%, var(--accent-purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: var(--glow-cyan);
            animation: headerGlow 3s ease-in-out infinite;
        }

        @keyframes headerGlow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(0, 245, 255, 0.3)); }
            50% { filter: drop-shadow(0 0 40px rgba(255, 0, 170, 0.5)); }
        }

        .header p {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-secondary);
            margin-top: 8px;
            font-size: 0.85rem;
            letter-spacing: 2px;
        }

        /* Navigation tabs */
        .nav-tabs {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            padding: 8px;
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .nav-tab {
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 1px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            color: var(--accent-cyan);
            background: rgba(0, 245, 255, 0.1);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
            color: var(--accent-cyan);
            box-shadow: var(--glow-cyan), inset 0 0 20px rgba(0, 245, 255, 0.1);
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Canvas container */
        .canvas-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            aspect-ratio: 1;
            background: radial-gradient(circle at center, rgba(139, 92, 246, 0.1) 0%, transparent 70%);
            border-radius: 24px;
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        #atomCanvas {
            width: 100%;
            height: 100%;
        }

        /* Controls panel */
        .controls-panel {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            color: var(--accent-cyan);
            letter-spacing: 2px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-label i {
            font-size: 1rem;
        }

        /* Orbit selector */
        .orbit-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .orbit-btn {
            width: 50px;
            height: 50px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            background: rgba(0, 245, 255, 0.05);
            color: var(--text-primary);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .orbit-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, var(--accent-cyan) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .orbit-btn:hover::before {
            width: 100px;
            height: 100px;
            opacity: 0.3;
        }

        .orbit-btn.selected {
            border-color: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
            background: rgba(0, 245, 255, 0.2);
        }

        .orbit-btn.from-selected {
            border-color: var(--accent-magenta);
            box-shadow: var(--glow-magenta);
        }

        /* Transition button */
        .transition-btn {
            width: 100%;
            padding: 16px;
            border: none;
            background: linear-gradient(135deg, var(--accent-magenta) 0%, var(--accent-purple) 100%);
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
            letter-spacing: 2px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
        }

        .transition-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(255, 0, 170, 0.4);
        }

        .transition-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Info cards */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .info-card {
            background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
            border-radius: 16px;
            padding: 16px;
            border: 1px solid rgba(255,255,255,0.05);
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-cyan) 0%, var(--accent-magenta) 100%);
        }

        .info-card-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-secondary);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .info-card-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-cyan);
            margin-top: 6px;
        }

        .info-card-unit {
            font-size: 0.7rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* Spectrum section */
        .spectrum-container {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .spectrum-display {
            height: 80px;
            background: linear-gradient(90deg, #1a0a20 0%, #0a0a15 100%);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .spectrum-line {
            position: absolute;
            top: 0;
            height: 100%;
            width: 3px;
            transition: all 0.5s ease;
        }

        .spectrum-labels {
            display: flex;
            justify-content: space-between;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        /* Series selector */
        .series-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-top: 16px;
        }

        .series-card {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 14px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .series-card:hover {
            border-color: rgba(0, 245, 255, 0.3);
        }

        .series-card.active {
            border-color: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
        }

        .series-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .series-range {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .series-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.6rem;
            margin-top: 8px;
            font-weight: 600;
        }

        .series-type.uv { background: rgba(138, 43, 226, 0.3); color: #bb86fc; }
        .series-type.visible { background: rgba(0, 245, 255, 0.3); color: var(--accent-cyan); }
        .series-type.ir { background: rgba(255, 100, 100, 0.3); color: #ff8888; }

        /* Energy diagram */
        .energy-diagram {
            position: relative;
            height: 400px;
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .energy-level {
            position: absolute;
            left: 80px;
            right: 20px;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-cyan) 0%, transparent 100%);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .energy-level::before {
            content: attr(data-n);
            position: absolute;
            left: -60px;
            top: 50%;
            transform: translateY(-50%);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--accent-cyan);
        }

        .energy-level::after {
            content: attr(data-energy);
            position: absolute;
            right: 0;
            top: -20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .energy-level:hover {
            height: 5px;
            box-shadow: var(--glow-cyan);
        }

        /* Formulas section */
        .formulas-grid {
            display: grid;
            gap: 16px;
        }

        .formula-card {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
        }

        .formula-card:hover {
            border-color: rgba(0, 245, 255, 0.3);
            transform: translateY(-2px);
        }

        .formula-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            color: var(--accent-magenta);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .formula-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            letter-spacing: 1px;
            overflow-x: auto;
        }

        .formula-explanation {
            margin-top: 16px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Calculator section */
        .calculator-container {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 24px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .calc-input-group {
            margin-bottom: 20px;
        }

        .calc-input-group label {
            display: block;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.75rem;
            color: var(--accent-cyan);
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .calc-input {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-tertiary);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .calc-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
        }

        .calc-select {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg-tertiary);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            cursor: pointer;
        }

        .calc-select:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .calc-result {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }

        .calc-result-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .calc-result-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        /* Photon animation */
        .photon {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            animation: photonEmit 1s ease-out forwards;
        }

        @keyframes photonEmit {
            0% {
                transform: scale(1) translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: scale(0.5) translate(100px, -100px);
                opacity: 0;
            }
        }

        /* Transition arrow animation */
        .transition-arrow {
            position: absolute;
            pointer-events: none;
            z-index: 50;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                padding: 12px;
            }

            .nav-tab {
                padding: 10px 14px;
                font-size: 0.65rem;
            }

            .nav-tab span {
                display: none;
            }

            .orbit-btn {
                width: 44px;
                height: 44px;
                font-size: 1rem;
            }

            .info-card-value {
                font-size: 1.1rem;
            }

            .energy-diagram {
                height: 350px;
            }
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-cyan);
            border-radius: 8px;
            padding: 8px 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-primary);
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .tooltip.visible {
            opacity: 1;
        }

        /* Loading animation for canvas */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(10, 10, 15, 0.9);
            border-radius: 24px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid transparent;
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Wave animation for photon */
        .wave-indicator {
            position: absolute;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--accent-gold);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .wave-indicator.visible {
            opacity: 1;
        }

        /* Glowing dot for current state */
        .state-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-cyan);
            box-shadow: var(--glow-cyan);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
        }

        /* Main layout for desktop */
        .main-content {
            display: grid;
            gap: 20px;
        }

        @media (min-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr 400px;
            }
        }

        .visualization-area {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
    </style>
</head>
<body>
    <div class="cosmos-bg" id="cosmosBackground">
        <div class="nebula nebula-1"></div>
        <div class="nebula nebula-2"></div>
    </div>

    <div class="app-container">
        <header class="header">
            <h1>Bohr Atom Lab</h1>
            <p>Interactive Quantum Visualization</p>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" data-section="visualizer">
                <i class="fas fa-atom"></i>
                <span>Atom</span>
            </button>
            <button class="nav-tab" data-section="spectrum">
                <i class="fas fa-rainbow"></i>
                <span>Spectrum</span>
            </button>
            <button class="nav-tab" data-section="energy">
                <i class="fas fa-bolt"></i>
                <span>Energy</span>
            </button>
            <button class="nav-tab" data-section="formulas">
                <i class="fas fa-square-root-alt"></i>
                <span>Formulas</span>
            </button>
            <button class="nav-tab" data-section="calculator">
                <i class="fas fa-calculator"></i>
                <span>Calculate</span>
            </button>
        </nav>

        <!-- Visualizer Section -->
        <section class="section active" id="visualizer">
            <div class="main-content">
                <div class="visualization-area">
                    <div class="canvas-container">
                        <canvas id="atomCanvas"></canvas>
                    </div>
                    <div class="info-grid">
                        <div class="info-card">
                            <div class="info-card-title">Current Orbit (n)</div>
                            <div class="info-card-value" id="currentOrbit">1</div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Radius</div>
                            <div class="info-card-value" id="currentRadius">0.529 <span class="info-card-unit">Å</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Energy</div>
                            <div class="info-card-value" id="currentEnergy">-13.6 <span class="info-card-unit">eV</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Velocity</div>
                            <div class="info-card-value" id="currentVelocity">2.19 <span class="info-card-unit">×10⁶ m/s</span></div>
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-crosshairs"></i>
                            SELECT FINAL ORBIT (n₁)
                        </div>
                        <div class="orbit-buttons" id="toOrbitBtns">
                            <button class="orbit-btn selected" data-n="1">1</button>
                            <button class="orbit-btn" data-n="2">2</button>
                            <button class="orbit-btn" data-n="3">3</button>
                            <button class="orbit-btn" data-n="4">4</button>
                            <button class="orbit-btn" data-n="5">5</button>
                            <button class="orbit-btn" data-n="6">6</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-arrow-up"></i>
                            SELECT INITIAL ORBIT (n₂)
                        </div>
                        <div class="orbit-buttons" id="fromOrbitBtns">
                            <button class="orbit-btn" data-n="1">1</button>
                            <button class="orbit-btn from-selected" data-n="2">2</button>
                            <button class="orbit-btn" data-n="3">3</button>
                            <button class="orbit-btn" data-n="4">4</button>
                            <button class="orbit-btn" data-n="5">5</button>
                            <button class="orbit-btn" data-n="6">6</button>
                        </div>
                    </div>

                    <button class="transition-btn" id="transitionBtn">
                        <i class="fas fa-bolt"></i>
                        EMIT PHOTON
                    </button>

                    <div class="info-grid" style="margin-top: 20px;">
                        <div class="info-card">
                            <div class="info-card-title">Wavelength (λ)</div>
                            <div class="info-card-value" id="wavelengthValue">121.5 <span class="info-card-unit">nm</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Frequency (ν)</div>
                            <div class="info-card-value" id="frequencyValue">2.47 <span class="info-card-unit">×10¹⁵ Hz</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Photon Energy</div>
                            <div class="info-card-value" id="photonEnergy">10.2 <span class="info-card-unit">eV</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Spectrum Type</div>
                            <div class="info-card-value" id="spectrumType" style="font-size: 0.9rem;">Ultraviolet</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Spectrum Section -->
        <section class="section" id="spectrum">
            <div class="spectrum-container">
                <div class="control-label">
                    <i class="fas fa-rainbow"></i>
                    HYDROGEN EMISSION SPECTRUM
                </div>
                <div class="spectrum-display" id="spectrumDisplay"></div>
                <div class="spectrum-labels">
                    <span>100 nm (UV)</span>
                    <span>400 nm</span>
                    <span>700 nm</span>
                    <span>2000 nm (IR)</span>
                </div>

                <div class="series-grid">
                    <div class="series-card active" data-series="lyman">
                        <div class="series-name">Lyman</div>
                        <div class="series-range">n → 1</div>
                        <div class="series-type uv">Ultraviolet</div>
                    </div>
                    <div class="series-card" data-series="balmer">
                        <div class="series-name">Balmer</div>
                        <div class="series-range">n → 2</div>
                        <div class="series-type visible">Visible</div>
                    </div>
                    <div class="series-card" data-series="paschen">
                        <div class="series-name">Paschen</div>
                        <div class="series-range">n → 3</div>
                        <div class="series-type ir">Infrared</div>
                    </div>
                    <div class="series-card" data-series="brackett">
                        <div class="series-name">Brackett</div>
                        <div class="series-range">n → 4</div>
                        <div class="series-type ir">Infrared</div>
                    </div>
                    <div class="series-card" data-series="pfund">
                        <div class="series-name">Pfund</div>
                        <div class="series-range">n → 5</div>
                        <div class="series-type ir">Infrared</div>
                    </div>
                </div>

                <div class="info-grid" style="margin-top: 20px;">
                    <div class="info-card">
                        <div class="info-card-title">Series Formula</div>
                        <div class="formula-display" id="seriesFormula" style="font-size: 0.9rem;">1/λ = R[1/1² - 1/n²]</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Energy Section -->
        <section class="section" id="energy">
            <div class="energy-diagram" id="energyDiagram">
                <div class="control-label" style="margin-bottom: 40px;">
                    <i class="fas fa-layer-group"></i>
                    ENERGY LEVEL DIAGRAM
                </div>
            </div>
            <div class="info-grid" style="margin-top: 16px;">
                <div class="info-card">
                    <div class="info-card-title">Ground State Energy (n=1)</div>
                    <div class="info-card-value">-13.6 <span class="info-card-unit">eV</span></div>
                </div>
                <div class="info-card">
                    <div class="info-card-title">Ionization Energy</div>
                    <div class="info-card-value">13.6 <span class="info-card-unit">eV</span></div>
                </div>
                <div class="info-card">
                    <div class="info-card-title">Energy Formula</div>
                    <div class="formula-display" style="font-size: 0.85rem;">E = -13.6/n² eV</div>
                </div>
                <div class="info-card">
                    <div class="info-card-title">Rydberg Constant (R)</div>
                    <div class="info-card-value" style="font-size: 0.9rem;">1.097×10⁷ <span class="info-card-unit">m⁻¹</span></div>
                </div>
            </div>
        </section>

        <!-- Formulas Section -->
        <section class="section" id="formulas">
            <div class="formulas-grid">
                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-circle-notch"></i>
                        Angular Momentum Quantization
                    </div>
                    <div class="formula-display">mvr = nh/2π &nbsp;&nbsp;(n = 1, 2, 3, ...)</div>
                    <div class="formula-explanation">
                        Bohr's first postulate: The angular momentum of an electron in any orbit is an integral multiple of h/2π. This restricts electrons to specific allowed orbits.
                    </div>
                </div>

                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-expand-arrows-alt"></i>
                        Orbital Radius
                    </div>
                    <div class="formula-display">r = n²h²ε₀ / πmZe² &nbsp;&nbsp;∴ r ∝ n²</div>
                    <div class="formula-explanation">
                        The radius of the nth orbit is proportional to n². For hydrogen (Z=1), the first orbit radius (Bohr radius) a₀ = 0.529 Å.
                    </div>
                </div>

                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Electron Velocity
                    </div>
                    <div class="formula-display">v = Ze² / 2hε₀n &nbsp;&nbsp;∴ v ∝ 1/n</div>
                    <div class="formula-explanation">
                        The velocity is inversely proportional to the principal quantum number. Electrons in lower orbits move faster.
                    </div>
                </div>

                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-battery-full"></i>
                        Energy of Hydrogen Atom
                    </div>
                    <div class="formula-display">E = -mZ²e⁴ / 8ε₀²h²n² = -13.6Z²/n² eV</div>
                    <div class="formula-explanation">
                        <strong>Kinetic Energy:</strong> K = Ze²/8πε₀r<br>
                        <strong>Potential Energy:</strong> U = -Ze²/4πε₀r<br>
                        <strong>Total Energy:</strong> E = K + U = -Ze²/8πε₀r &nbsp;(negative, indicating bound state)
                    </div>
                </div>

                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-wave-square"></i>
                        Photon Emission
                    </div>
                    <div class="formula-display">hν = E₂ - E₁ &nbsp;&nbsp; 1/λ = R[1/n₁² - 1/n₂²]</div>
                    <div class="formula-explanation">
                        When an electron jumps from a higher orbit (n₂) to a lower orbit (n₁), it emits a photon with energy equal to the energy difference. R = 1.097×10⁷ m⁻¹ is the Rydberg constant.
                    </div>
                </div>

                <div class="formula-card">
                    <div class="formula-title">
                        <i class="fas fa-sun"></i>
                        Spectral Series
                    </div>
                    <div class="formula-display">
                        Lyman (n₁=1): UV | Balmer (n₁=2): Visible<br>
                        Paschen (n₁=3): IR | Brackett (n₁=4): IR
                    </div>
                    <div class="formula-explanation">
                        Different spectral series correspond to transitions ending at different final orbits. The Balmer series (visible) includes the famous Hα (656nm, red), Hβ (486nm, cyan), Hγ (434nm, blue), and Hδ (410nm, violet) lines.
                    </div>
                </div>
            </div>
        </section>

        <!-- Calculator Section -->
        <section class="section" id="calculator">
            <div class="calculator-container">
                <div class="control-label" style="margin-bottom: 20px;">
                    <i class="fas fa-calculator"></i>
                    QUANTUM CALCULATOR
                </div>

                <div class="calc-input-group">
                    <label>Select Calculation Type</label>
                    <select class="calc-select" id="calcType">
                        <option value="transition">Photon from Transition (n₂ → n₁)</option>
                        <option value="radius">Orbital Radius</option>
                        <option value="velocity">Electron Velocity</option>
                        <option value="energy">Energy Level</option>
                        <option value="wavelength">Wavelength to Energy</option>
                    </select>
                </div>

                <div id="calcInputs">
                    <div class="calc-input-group">
                        <label>Initial Orbit (n₂)</label>
                        <input type="number" class="calc-input" id="calcN2" value="3" min="1" max="100">
                    </div>
                    <div class="calc-input-group">
                        <label>Final Orbit (n₁)</label>
                        <input type="number" class="calc-input" id="calcN1" value="2" min="1" max="100">
                    </div>
                    <div class="calc-input-group" style="display: none;">
                        <label>Atomic Number (Z)</label>
                        <input type="number" class="calc-input" id="calcZ" value="1" min="1" max="118">
                    </div>
                    <div class="calc-input-group" style="display: none;">
                        <label>Wavelength (nm)</label>
                        <input type="number" class="calc-input" id="calcWavelength" value="656" min="1">
                    </div>
                </div>

                <button class="transition-btn" id="calculateBtn" style="margin-top: 10px; margin-bottom: 20px;">
                    <i class="fas fa-equals"></i>
                    CALCULATE
                </button>

                <div class="calc-result" id="calcResult">
                    <div class="calc-result-label">Result</div>
                    <div class="calc-result-value" id="calcResultValue">—</div>
                </div>

                <div class="info-grid" style="margin-top: 16px;" id="additionalResults">
                </div>
            </div>
        </section>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Constants
        const RYDBERG = 1.097e7; // m^-1
        const BOHR_RADIUS = 5.29e-11; // m (0.529 Å)
        const GROUND_ENERGY = -13.6; // eV
        const PLANCK = 6.626e-34; // J·s
        const C = 3e8; // m/s
        const EV_TO_JOULE = 1.602e-19;

        // State
        let state = {
            currentN: 1,
            fromN: 2,
            toN: 1,
            animating: false,
            electronAngle: 0,
            activeSeries: 'lyman'
        };

        // DOM elements
        const canvas = document.getElementById('atomCanvas');
        const ctx = canvas.getContext('2d');

        // Initialize
        function init() {
            setupCanvas();
            setupEventListeners();
            createStars();
            createEnergyDiagram();
            updateSpectrum();
            animate();
            updateDisplay();
        }

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        function setupCanvas() {
            const container = canvas.parentElement;
            const size = Math.min(container.clientWidth, container.clientHeight);
            canvas.width = size * 2;
            canvas.height = size * 2;
            canvas.style.width = size + 'px';
            canvas.style.height = size + 'px';
            ctx.scale(2, 2);
        }

        function createStars() {
            const bg = document.getElementById('cosmosBackground');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 2 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.setProperty('--duration', (Math.random() * 3 + 2) + 's');
                star.style.animationDelay = Math.random() * 5 + 's';
                bg.appendChild(star);
            }
        }

        function setupEventListeners() {
            // Navigation tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.section).classList.add('active');
                    if (tab.dataset.section === 'visualizer') {
                        setupCanvas();
                    }
                });
            });

            // Orbit buttons
            document.querySelectorAll('#toOrbitBtns .orbit-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#toOrbitBtns .orbit-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    state.toN = parseInt(btn.dataset.n);
                    updateTransitionInfo();
                });
            });

            document.querySelectorAll('#fromOrbitBtns .orbit-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#fromOrbitBtns .orbit-btn').forEach(b => b.classList.remove('from-selected'));
                    btn.classList.add('from-selected');
                    state.fromN = parseInt(btn.dataset.n);
                    state.currentN = state.fromN;
                    updateTransitionInfo();
                    updateDisplay();
                });
            });

            // Transition button
            document.getElementById('transitionBtn').addEventListener('click', startTransition);

            // Series cards
            document.querySelectorAll('.series-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.series-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                    state.activeSeries = card.dataset.series;
                    updateSpectrum();
                    updateSeriesFormula();
                });
            });

            // Calculator
            document.getElementById('calcType').addEventListener('change', updateCalcInputs);
            document.getElementById('calculateBtn').addEventListener('click', performCalculation);

            // Window resize
            window.addEventListener('resize', () => {
                setupCanvas();
            });
        }

        // Physics calculations
        function calculateRadius(n, Z = 1) {
            return BOHR_RADIUS * n * n / Z * 1e10; // in Å
        }

        function calculateEnergy(n, Z = 1) {
            return GROUND_ENERGY * Z * Z / (n * n);
        }

        function calculateVelocity(n, Z = 1) {
            const v0 = 2.19e6; // m/s for n=1
            return v0 * Z / n;
        }

        function calculateWavelength(n1, n2) {
            const invLambda = RYDBERG * (1/(n1*n1) - 1/(n2*n2));
            return 1 / invLambda * 1e9; // nm
        }

        function calculateFrequency(wavelength) {
            return C / (wavelength * 1e-9);
        }

        function calculatePhotonEnergy(n1, n2) {
            return Math.abs(calculateEnergy(n1) - calculateEnergy(n2));
        }

        function getSpectrumType(wavelength) {
            if (wavelength < 400) return { type: 'Ultraviolet', color: '#8b5cf6' };
            if (wavelength < 450) return { type: 'Violet', color: '#7c3aed' };
            if (wavelength < 495) return { type: 'Blue', color: '#3b82f6' };
            if (wavelength < 570) return { type: 'Green', color: '#10b981' };
            if (wavelength < 590) return { type: 'Yellow', color: '#fbbf24' };
            if (wavelength < 620) return { type: 'Orange', color: '#f97316' };
            if (wavelength < 700) return { type: 'Red', color: '#ef4444' };
            return { type: 'Infrared', color: '#991b1b' };
        }

        function wavelengthToColor(wavelength) {
            let r, g, b;
            if (wavelength < 380) {
                r = 0.5; g = 0; b = 1;
            } else if (wavelength < 440) {
                r = (440 - wavelength) / 60; g = 0; b = 1;
            } else if (wavelength < 490) {
                r = 0; g = (wavelength - 440) / 50; b = 1;
            } else if (wavelength < 510) {
                r = 0; g = 1; b = (510 - wavelength) / 20;
            } else if (wavelength < 580) {
                r = (wavelength - 510) / 70; g = 1; b = 0;
            } else if (wavelength < 645) {
                r = 1; g = (645 - wavelength) / 65; b = 0;
            } else {
                r = 1; g = 0; b = 0;
            }

            // Intensity adjustment for edges
            let factor = 1;
            if (wavelength < 420) factor = 0.3 + 0.7 * (wavelength - 380) / 40;
            else if (wavelength > 700) factor = 0.3 + 0.7 * (780 - wavelength) / 80;

            return `rgb(${Math.round(r * 255 * factor)}, ${Math.round(g * 255 * factor)}, ${Math.round(b * 255 * factor)})`;
        }

        // Animation
        function animate() {
            const size = canvas.width / 2;
            const center = size / 2;

            ctx.clearRect(0, 0, size, size);

            // Draw nucleus glow
            const nucleusGrad = ctx.createRadialGradient(center, center, 0, center, center, 20);
            nucleusGrad.addColorStop(0, 'rgba(255, 0, 170, 1)');
            nucleusGrad.addColorStop(0.5, 'rgba(255, 0, 170, 0.5)');
            nucleusGrad.addColorStop(1, 'rgba(255, 0, 170, 0)');
            ctx.beginPath();
            ctx.arc(center, center, 20, 0, Math.PI * 2);
            ctx.fillStyle = nucleusGrad;
            ctx.fill();

            // Draw nucleus
            ctx.beginPath();
            ctx.arc(center, center, 8, 0, Math.PI * 2);
            ctx.fillStyle = '#ff00aa';
            ctx.fill();

            // Draw orbits
            const maxRadius = (size / 2) - 30;
            for (let n = 1; n <= 6; n++) {
                const orbitRadius = (n / 6) * maxRadius;

                ctx.beginPath();
                ctx.arc(center, center, orbitRadius, 0, Math.PI * 2);
                ctx.strokeStyle = n === state.currentN
                    ? 'rgba(0, 245, 255, 0.6)'
                    : 'rgba(255, 255, 255, 0.15)';
                ctx.lineWidth = n === state.currentN ? 2 : 1;
                ctx.setLineDash(n === state.currentN ? [] : [5, 5]);
                ctx.stroke();
                ctx.setLineDash([]);

                // Draw orbit label
                if (n <= 6) {
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
                    ctx.font = '12px Orbitron';
                    ctx.fillText(`n=${n}`, center + orbitRadius - 20, center - 5);
                }
            }

            // Draw electron
            const electronRadius = (state.currentN / 6) * maxRadius;
            const electronX = center + Math.cos(state.electronAngle) * electronRadius;
            const electronY = center + Math.sin(state.electronAngle) * electronRadius;

            // Electron glow
            const electronGrad = ctx.createRadialGradient(electronX, electronY, 0, electronX, electronY, 20);
            electronGrad.addColorStop(0, 'rgba(0, 245, 255, 1)');
            electronGrad.addColorStop(0.5, 'rgba(0, 245, 255, 0.3)');
            electronGrad.addColorStop(1, 'rgba(0, 245, 255, 0)');
            ctx.beginPath();
            ctx.arc(electronX, electronY, 20, 0, Math.PI * 2);
            ctx.fillStyle = electronGrad;
            ctx.fill();

            // Electron core
            ctx.beginPath();
            ctx.arc(electronX, electronY, 6, 0, Math.PI * 2);
            ctx.fillStyle = '#00f5ff';
            ctx.fill();

            // Update angle
            const angularVelocity = 0.02 / state.currentN;
            state.electronAngle += angularVelocity;

            requestAnimationFrame(animate);
        }

        function startTransition() {
            if (state.animating || state.fromN <= state.toN) return;

            state.animating = true;
            const btn = document.getElementById('transitionBtn');
            btn.disabled = true;

            // Calculate photon properties
            const wavelength = calculateWavelength(state.toN, state.fromN);
            const spectrum = getSpectrumType(wavelength);

            // Animate transition
            const startN = state.fromN;
            const endN = state.toN;
            const duration = 1000;
            const startTime = Date.now();

            function animateTransition() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3);

                state.currentN = startN - (startN - endN) * eased;

                if (progress < 1) {
                    requestAnimationFrame(animateTransition);
                } else {
                    state.currentN = endN;
                    state.animating = false;
                    btn.disabled = false;
                    emitPhoton(wavelength, spectrum.color);
                    updateDisplay();
                }
            }

            animateTransition();
        }

        function emitPhoton(wavelength, color) {
            const canvasContainer = document.querySelector('.canvas-container');
            const rect = canvasContainer.getBoundingClientRect();

            const photon = document.createElement('div');
            photon.className = 'photon';
            photon.style.left = (rect.width / 2 - 6) + 'px';
            photon.style.top = (rect.height / 2 - 6) + 'px';
            photon.style.background = wavelength < 400 ? '#8b5cf6' :
                                       wavelength > 700 ? '#ef4444' :
                                       wavelengthToColor(wavelength);
            photon.style.boxShadow = `0 0 20px ${photon.style.background}, 0 0 40px ${photon.style.background}`;

            canvasContainer.appendChild(photon);

            setTimeout(() => photon.remove(), 1000);
        }

        function updateDisplay() {
            const n = Math.round(state.currentN);
            document.getElementById('currentOrbit').textContent = n;
            document.getElementById('currentRadius').innerHTML = `${(calculateRadius(n)).toFixed(3)} <span class="info-card-unit">Å</span>`;
            document.getElementById('currentEnergy').innerHTML = `${calculateEnergy(n).toFixed(2)} <span class="info-card-unit">eV</span>`;
            document.getElementById('currentVelocity').innerHTML = `${(calculateVelocity(n) / 1e6).toFixed(2)} <span class="info-card-unit">×10⁶ m/s</span>`;
        }

        function updateTransitionInfo() {
            if (state.fromN <= state.toN) {
                document.getElementById('wavelengthValue').innerHTML = '— <span class="info-card-unit">nm</span>';
                document.getElementById('frequencyValue').innerHTML = '— <span class="info-card-unit">Hz</span>';
                document.getElementById('photonEnergy').innerHTML = '— <span class="info-card-unit">eV</span>';
                document.getElementById('spectrumType').textContent = 'Select n₂ > n₁';
                document.getElementById('transitionBtn').disabled = true;
                return;
            }

            document.getElementById('transitionBtn').disabled = false;

            const wavelength = calculateWavelength(state.toN, state.fromN);
            const frequency = calculateFrequency(wavelength);
            const energy = calculatePhotonEnergy(state.toN, state.fromN);
            const spectrum = getSpectrumType(wavelength);

            document.getElementById('wavelengthValue').innerHTML = `${wavelength.toFixed(1)} <span class="info-card-unit">nm</span>`;
            document.getElementById('frequencyValue').innerHTML = `${(frequency / 1e15).toFixed(2)} <span class="info-card-unit">×10¹⁵ Hz</span>`;
            document.getElementById('photonEnergy').innerHTML = `${energy.toFixed(2)} <span class="info-card-unit">eV</span>`;
            document.getElementById('spectrumType').textContent = spectrum.type;
            document.getElementById('spectrumType').style.color = spectrum.color;
        }

        function updateSpectrum() {
            const display = document.getElementById('spectrumDisplay');
            display.innerHTML = '';

            const seriesConfig = {
                lyman: { n1: 1, nMax: 7, label: 'Lyman' },
                balmer: { n1: 2, nMax: 7, label: 'Balmer' },
                paschen: { n1: 3, nMax: 8, label: 'Paschen' },
                brackett: { n1: 4, nMax: 9, label: 'Brackett' },
                pfund: { n1: 5, nMax: 10, label: 'Pfund' }
            };

            const config = seriesConfig[state.activeSeries];

            for (let n2 = config.n1 + 1; n2 <= config.nMax; n2++) {
                const wavelength = calculateWavelength(config.n1, n2);
                const position = wavelengthToPosition(wavelength);

                const line = document.createElement('div');
                line.className = 'spectrum-line';
                line.style.left = position + '%';

                const color = wavelength < 100 ? 'rgba(138, 43, 226, 0.8)' :
                             wavelength < 400 ? 'rgba(138, 43, 226, 0.7)' :
                             wavelength > 2000 ? 'rgba(139, 0, 0, 0.5)' :
                             wavelength > 700 ? 'rgba(200, 50, 50, 0.6)' :
                             wavelengthToColor(wavelength);

                line.style.background = color;
                line.style.boxShadow = `0 0 10px ${color}`;

                display.appendChild(line);
            }
        }

        function wavelengthToPosition(wavelength) {
            // Map 100-2000nm to 0-100%
            const minWave = 100;
            const maxWave = 2000;
            const position = ((wavelength - minWave) / (maxWave - minWave)) * 100;
            return Math.max(0, Math.min(100, position));
        }

        function updateSeriesFormula() {
            const formulas = {
                lyman: '1/λ = R[1/1² - 1/n²]  (n = 2,3,4...)',
                balmer: '1/λ = R[1/2² - 1/n²]  (n = 3,4,5...)',
                paschen: '1/λ = R[1/3² - 1/n²]  (n = 4,5,6...)',
                brackett: '1/λ = R[1/4² - 1/n²]  (n = 5,6,7...)',
                pfund: '1/λ = R[1/5² - 1/n²]  (n = 6,7,8...)'
            };
            document.getElementById('seriesFormula').textContent = formulas[state.activeSeries];
        }

        function createEnergyDiagram() {
            const diagram = document.getElementById('energyDiagram');
            const height = 320;
            const topMargin = 60;

            for (let n = 1; n <= 6; n++) {
                const energy = calculateEnergy(n);
                const normalizedE = (energy + 13.6) / 13.6;
                const yPos = topMargin + (1 - normalizedE) * height;

                const level = document.createElement('div');
                level.className = 'energy-level';
                level.style.top = yPos + 'px';
                level.dataset.n = `n = ${n}`;
                level.dataset.energy = `${energy.toFixed(2)} eV`;

                diagram.appendChild(level);
            }

            // Add ionization level (n = ∞, E = 0)
            const ionLevel = document.createElement('div');
            ionLevel.className = 'energy-level';
            ionLevel.style.top = topMargin + 'px';
            ionLevel.style.background = 'linear-gradient(90deg, rgba(255, 215, 0, 0.5) 0%, transparent 100%)';
            ionLevel.dataset.n = 'n = ∞';
            ionLevel.dataset.energy = '0 eV (ionized)';
            diagram.appendChild(ionLevel);
        }

        function updateCalcInputs() {
            const type = document.getElementById('calcType').value;
            const n1Group = document.querySelector('#calcN1').parentElement;
            const n2Group = document.querySelector('#calcN2').parentElement;
            const zGroup = document.querySelector('#calcZ').parentElement;
            const waveGroup = document.querySelector('#calcWavelength').parentElement;

            n1Group.style.display = 'none';
            n2Group.style.display = 'none';
            zGroup.style.display = 'none';
            waveGroup.style.display = 'none';

            switch(type) {
                case 'transition':
                    n1Group.style.display = 'block';
                    n2Group.style.display = 'block';
                    break;
                case 'radius':
                case 'velocity':
                case 'energy':
                    n2Group.style.display = 'block';
                    n2Group.querySelector('label').textContent = 'Orbit Number (n)';
                    zGroup.style.display = 'block';
                    break;
                case 'wavelength':
                    waveGroup.style.display = 'block';
                    break;
            }
        }

        function performCalculation() {
            const type = document.getElementById('calcType').value;
            const n1 = parseInt(document.getElementById('calcN1').value);
            const n2 = parseInt(document.getElementById('calcN2').value);
            const Z = parseInt(document.getElementById('calcZ').value);
            const wavelength = parseFloat(document.getElementById('calcWavelength').value);

            let result = '';
            let additionalHTML = '';

            switch(type) {
                case 'transition':
                    if (n2 <= n1) {
                        result = 'n₂ must be > n₁';
                        break;
                    }
                    const lambda = calculateWavelength(n1, n2);
                    const freq = calculateFrequency(lambda);
                    const energy = calculatePhotonEnergy(n1, n2);
                    const spec = getSpectrumType(lambda);

                    result = `λ = ${lambda.toFixed(2)} nm`;
                    additionalHTML = `
                        <div class="info-card">
                            <div class="info-card-title">Frequency</div>
                            <div class="info-card-value">${(freq/1e15).toFixed(3)} <span class="info-card-unit">×10¹⁵ Hz</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Photon Energy</div>
                            <div class="info-card-value">${energy.toFixed(3)} <span class="info-card-unit">eV</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Spectrum Type</div>
                            <div class="info-card-value" style="color: ${spec.color}">${spec.type}</div>
                        </div>
                    `;
                    break;

                case 'radius':
                    const r = calculateRadius(n2, Z);
                    result = `r = ${r.toFixed(4)} Å`;
                    additionalHTML = `
                        <div class="info-card">
                            <div class="info-card-title">In meters</div>
                            <div class="info-card-value">${(r * 1e-10).toExponential(3)} <span class="info-card-unit">m</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Formula</div>
                            <div class="info-card-value" style="font-size: 0.75rem">r = n²a₀/Z</div>
                        </div>
                    `;
                    break;

                case 'velocity':
                    const v = calculateVelocity(n2, Z);
                    result = `v = ${(v/1e6).toFixed(3)} × 10⁶ m/s`;
                    additionalHTML = `
                        <div class="info-card">
                            <div class="info-card-title">As % of c</div>
                            <div class="info-card-value">${(v/C * 100).toFixed(3)} <span class="info-card-unit">%</span></div>
                        </div>
                    `;
                    break;

                case 'energy':
                    const E = calculateEnergy(n2, Z);
                    result = `E = ${E.toFixed(4)} eV`;
                    additionalHTML = `
                        <div class="info-card">
                            <div class="info-card-title">In Joules</div>
                            <div class="info-card-value">${(E * EV_TO_JOULE).toExponential(3)} <span class="info-card-unit">J</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Ionization Energy</div>
                            <div class="info-card-value">${Math.abs(E).toFixed(4)} <span class="info-card-unit">eV</span></div>
                        </div>
                    `;
                    break;

                case 'wavelength':
                    const photonE = (PLANCK * C) / (wavelength * 1e-9) / EV_TO_JOULE;
                    const photonFreq = C / (wavelength * 1e-9);
                    const specType = getSpectrumType(wavelength);

                    result = `E = ${photonE.toFixed(4)} eV`;
                    additionalHTML = `
                        <div class="info-card">
                            <div class="info-card-title">Frequency</div>
                            <div class="info-card-value">${(photonFreq/1e14).toFixed(3)} <span class="info-card-unit">×10¹⁴ Hz</span></div>
                        </div>
                        <div class="info-card">
                            <div class="info-card-title">Spectrum Type</div>
                            <div class="info-card-value" style="color: ${specType.color}">${specType.type}</div>
                        </div>
                    `;
                    break;
            }

            document.getElementById('calcResultValue').textContent = result;
            document.getElementById('additionalResults').innerHTML = additionalHTML;
        }

        // Initialize
        init();
        updateTransitionInfo();
        updateCalcInputs();
    </script>
</body>
</html>

