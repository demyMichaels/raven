<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async/Await Masterclass - Interactive Learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" >
    <style>
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes progress {
            from { width: 0%; }
            to { width: 100%; }
        }

        .animate-slide-in {
            animation: slideIn 0.5s ease-out;
        }

        .animate-pulse-custom {
            animation: pulse 2s ease-in-out infinite;
        }

        .code-block {
            border-radius: 8px;
            overflow: hidden;
        }

        .execution-step {
            transition: all 0.3s ease;
        }

        .execution-step.active {
            background-color: #5D5CDE;
            color: white;
            transform: scale(1.05);
        }

        .timeline-bar {
            animation: progress 2s ease-in-out;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'light-bg': '#FFFFFF',
                        'dark-bg': '#181818',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-light-bg dark:bg-dark-bg text-gray-900 dark:text-gray-100 transition-colors min-h-screen">
    <!-- Dark mode setup -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <header class="bg-gradient-to-r from-primary to-purple-600 text-white py-8 px-4">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">‚ö° Async/Await Masterclass</h1>
            <p class="text-xl md:text-2xl opacity-90">Learn asynchronous JavaScript through practical EdTech & FinTech examples</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8 space-y-12">
        <!-- Introduction -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-4 text-primary">üéØ What You'll Learn</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                    <div class="text-3xl mb-2">üîÑ</div>
                    <h3 class="font-bold text-lg mb-2">Callbacks</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">The old way: callback hell and pyramid of doom</p>
                </div>
                <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl mb-2">üéÅ</div>
                    <h3 class="font-bold text-lg mb-2">Promises</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">The bridge: cleaner chaining with .then()</p>
                </div>
                <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                    <div class="text-3xl mb-2">‚ú®</div>
                    <h3 class="font-bold text-lg mb-2">Async/Await</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400">The future: write async code like sync code</p>
                </div>
            </div>
        </section>

        <!-- Visual Comparison -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-6 text-primary">üìä Side-by-Side Comparison</h2>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Choose a scenario:</label>
                <select id="scenarioSelect" class="w-full md:w-auto px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary">
                    <option value="edtech">EdTech: Fetching Course Data</option>
                    <option value="fintech">FinTech: Processing Payment</option>
                </select>
            </div>

            <div class="grid md:grid-cols-3 gap-4">
                <!-- Callbacks -->
                <div class="border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden">
                    <div class="bg-red-100 dark:bg-red-900/30 px-4 py-2 font-bold">üò∞ Callbacks</div>
                    <div class="p-4">
                        <pre class="text-xs code-block"><code id="callbackCode" class="language-javascript"></code></pre>
                    </div>
                </div>

                <!-- Promises -->
                <div class="border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden">
                    <div class="bg-yellow-100 dark:bg-yellow-900/30 px-4 py-2 font-bold">üòä Promises</div>
                    <div class="p-4">
                        <pre class="text-xs code-block"><code id="promiseCode" class="language-javascript"></code></pre>
                    </div>
                </div>

                <!-- Async/Await -->
                <div class="border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden">
                    <div class="bg-green-100 dark:bg-green-900/30 px-4 py-2 font-bold">üéâ Async/Await</div>
                    <div class="p-4">
                        <pre class="text-xs code-block"><code id="asyncCode" class="language-javascript"></code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Demo: EdTech -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-6 text-primary">üéì EdTech Example: Student Dashboard</h2>
            <p class="mb-6 text-gray-600 dark:text-gray-400">Watch how async/await handles multiple API calls sequentially and in parallel</p>

            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold text-lg mb-3">Sequential Loading (Slow)</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Each request waits for the previous one to complete</p>
                    <button id="edtechSequential" class="w-full bg-primary hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        Load Student Data (Sequential)
                    </button>
                    <div id="edtechSequentialResult" class="mt-4 min-h-[200px]"></div>
                </div>

                <div>
                    <h3 class="font-bold text-lg mb-3">Parallel Loading (Fast) ‚ö°</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">All requests start simultaneously with Promise.all()</p>
                    <button id="edtechParallel" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        Load Student Data (Parallel)
                    </button>
                    <div id="edtechParallelResult" class="mt-4 min-h-[200px]"></div>
                </div>
            </div>

            <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                <h4 class="font-bold mb-2">üí° Key Takeaway:</h4>
                <p class="text-sm">Use <code class="bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded">await</code> for sequential operations. Use <code class="bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded">Promise.all()</code> when operations don't depend on each other!</p>
            </div>
        </section>

        <!-- Interactive Demo: FinTech -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-6 text-primary">üí≥ FinTech Example: Payment Processing</h2>
            <p class="mb-6 text-gray-600 dark:text-gray-400">See how async/await handles complex payment workflows with error handling</p>

            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium mb-2">Payment Amount ($)</label>
                    <input type="number" id="paymentAmount" value="100" min="1" class="w-full px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Simulate Error?</label>
                    <select id="simulateError" class="w-full px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary">
                        <option value="false">No - Success</option>
                        <option value="true">Yes - Insufficient Funds</option>
                    </select>
                </div>
            </div>

            <button id="processPayment" class="w-full bg-primary hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-colors mb-4">
                Process Payment with Async/Await
            </button>

            <div id="paymentTimeline" class="space-y-2 mb-4"></div>
            <div id="paymentResult" class="min-h-[100px]"></div>

            <div class="mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg">
                <h4 class="font-bold mb-2">üí° Error Handling:</h4>
                <p class="text-sm">Always use <code class="bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded">try/catch</code> blocks with async/await to handle errors gracefully!</p>
            </div>
        </section>

        <!-- Interactive Playground -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-6 text-primary">üéÆ Interactive Playground</h2>
            <p class="mb-6 text-gray-600 dark:text-gray-400">Write your own async/await code and see it run in real-time!</p>

            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Your Code:</label>
                <textarea id="playgroundCode" class="w-full h-64 px-4 py-2 text-base font-mono border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary" spellcheck="false">// Example: Fetch user profile and courses
async function loadUserDashboard(userId) {
  try {
    console.log('Loading dashboard...');

    // Simulate API calls
    const user = await fetchUser(userId);
    console.log('User loaded:', user.name);

    const courses = await fetchCourses(userId);
    console.log('Courses loaded:', courses.length);

    return { user, courses };
  } catch (error) {
    console.error('Error:', error.message);
  }
}

// Helper functions
function fetchUser(id) {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve({ id, name: 'Alice Student', email: 'alice@edu.com' });
    }, 1000);
  });
}

function fetchCourses(id) {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve([
        { id: 1, name: 'JavaScript Fundamentals' },
        { id: 2, name: 'React Masterclass' }
      ]);
    }, 1000);
  });
}

// Run the function
loadUserDashboard(123);</textarea>
            </div>

            <button id="runPlayground" class="w-full bg-primary hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-colors mb-4">
                ‚ñ∂Ô∏è Run Code
            </button>

            <div class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm min-h-[150px] overflow-auto">
                <div class="font-bold mb-2">Console Output:</div>
                <div id="playgroundOutput"></div>
            </div>
        </section>

        <!-- Cheat Sheet -->
        <section class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 md:p-8">
            <h2 class="text-3xl font-bold mb-6 text-primary">üìö Quick Reference Cheat Sheet</h2>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-green-600 dark:text-green-400">‚úÖ Do This</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <code class="text-sm">async function getName() { ... }</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">Always mark function as async</p>
                            </div>
                            <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <code class="text-sm">try { await api() } catch(e) { ... }</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">Use try/catch for errors</p>
                            </div>
                            <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <code class="text-sm">await Promise.all([a(), b()])</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">Parallel execution</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-red-600 dark:text-red-400">‚ùå Avoid This</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                <code class="text-sm">function getName() { await ... }</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">Await needs async function</p>
                            </div>
                            <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                <code class="text-sm">await api() // no error handling</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">Missing error handling</p>
                            </div>
                            <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                <code class="text-sm">await a(); await b(); // sequential</code>
                                <p class="text-xs mt-1 text-gray-600 dark:text-gray-400">When they could run in parallel</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-100 dark:bg-gray-900 py-8 px-4 mt-12">
        <div class="max-w-6xl mx-auto text-center text-gray-600 dark:text-gray-400">
            <p>Built with ‚ù§Ô∏è to make async JavaScript easy to understand</p>
        </div>
    </footer>

    <script>
        // Code examples for comparison
        const codeExamples = {
            edtech: {
                callback: `// Callback Hell üò∞
fetchStudent(studentId, (student) => {
  fetchCourses(student.id, (courses) => {
    fetchGrades(courses, (grades) => {
      fetchAssignments(grades, (assignments) => {
        displayDashboard(
          student,
          courses,
          grades,
          assignments
        );
      }, handleError);
    }, handleError);
  }, handleError);
}, handleError);`,
                promise: `// Promise Chain üòä
fetchStudent(studentId)
  .then(student => fetchCourses(student.id))
  .then(courses => fetchGrades(courses))
  .then(grades => fetchAssignments(grades))
  .then(assignments => {
    displayDashboard(assignments);
  })
  .catch(handleError);`,
                async: `// Async/Await üéâ
async function loadDashboard() {
  try {
    const student = await fetchStudent(studentId);
    const courses = await fetchCourses(student.id);
    const grades = await fetchGrades(courses);
    const assignments = await fetchAssignments(grades);

    displayDashboard(student, courses, grades, assignments);
  } catch (error) {
    handleError(error);
  }
}`
            },
            fintech: {
                callback: `// Callback Hell üò∞
validateAccount(accountId, (account) => {
  checkBalance(account, (balance) => {
    if (balance >= amount) {
      deductFunds(account, amount, (result) => {
        processPayment(result, (payment) => {
          sendReceipt(payment, (receipt) => {
            displaySuccess(receipt);
          }, handleError);
        }, handleError);
      }, handleError);
    }
  }, handleError);
}, handleError);`,
                promise: `// Promise Chain üòä
validateAccount(accountId)
  .then(account => checkBalance(account))
  .then(balance => {
    if (balance < amount) throw new Error('Insufficient funds');
    return deductFunds(account, amount);
  })
  .then(result => processPayment(result))
  .then(payment => sendReceipt(payment))
  .then(receipt => displaySuccess(receipt))
  .catch(handleError);`,
                async: `// Async/Await üéâ
async function processTransaction() {
  try {
    const account = await validateAccount(accountId);
    const balance = await checkBalance(account);

    if (balance < amount) {
      throw new Error('Insufficient funds');
    }

    const result = await deductFunds(account, amount);
    const payment = await processPayment(result);
    const receipt = await sendReceipt(payment);

    displaySuccess(receipt);
  } catch (error) {
    handleError(error);
  }
}`
            }
        };

        // Update code comparison
        function updateCodeComparison() {
            const scenario = document.getElementById('scenarioSelect').value;
            const examples = codeExamples[scenario];

            document.getElementById('callbackCode').textContent = examples.callback;
            document.getElementById('promiseCode').textContent = examples.promise;
            document.getElementById('asyncCode').textContent = examples.async;

            Prism.highlightAll();
        }

        document.getElementById('scenarioSelect').addEventListener('change', updateCodeComparison);
        updateCodeComparison();

        // EdTech Demo - Sequential
        document.getElementById('edtechSequential').addEventListener('click', async function() {
            const resultDiv = document.getElementById('edtechSequentialResult');
            resultDiv.innerHTML = '<div class="animate-pulse-custom text-primary font-bold">Loading...</div>';

            const startTime = Date.now();

            try {
                resultDiv.innerHTML = '<div class="space-y-2"></div>';
                const container = resultDiv.firstChild;

                // Sequential: one after another
                addStep(container, '‚è≥ Fetching student profile...', 'pending');
                const student = await mockAPI('student', 800);
                updateStep(container, 0, `‚úÖ Student: ${student.name}`, 'success');

                addStep(container, '‚è≥ Fetching enrolled courses...', 'pending');
                const courses = await mockAPI('courses', 1000);
                updateStep(container, 1, `‚úÖ Courses: ${courses.length} enrolled`, 'success');

                addStep(container, '‚è≥ Fetching grades...', 'pending');
                const grades = await mockAPI('grades', 700);
                updateStep(container, 2, `‚úÖ Grades: ${grades.average}% average`, 'success');

                const endTime = Date.now();
                const totalTime = ((endTime - startTime) / 1000).toFixed(2);

                addStep(container, `‚è±Ô∏è Total time: ${totalTime}s`, 'info');
            } catch (error) {
                resultDiv.innerHTML = `<div class="text-red-500">Error: ${error.message}</div>`;
            }
        });

        // EdTech Demo - Parallel
        document.getElementById('edtechParallel').addEventListener('click', async function() {
            const resultDiv = document.getElementById('edtechParallelResult');
            resultDiv.innerHTML = '<div class="animate-pulse-custom text-green-600 font-bold">Loading all data simultaneously...</div>';

            const startTime = Date.now();

            try {
                resultDiv.innerHTML = '<div class="space-y-2"></div>';
                const container = resultDiv.firstChild;

                addStep(container, '‚è≥ Fetching all data in parallel...', 'pending');

                // Parallel: all at once with Promise.all()
                const [student, courses, grades] = await Promise.all([
                    mockAPI('student', 800),
                    mockAPI('courses', 1000),
                    mockAPI('grades', 700)
                ]);

                updateStep(container, 0, '‚úÖ All data loaded!', 'success');
                addStep(container, `‚úÖ Student: ${student.name}`, 'success');
                addStep(container, `‚úÖ Courses: ${courses.length} enrolled`, 'success');
                addStep(container, `‚úÖ Grades: ${grades.average}% average`, 'success');

                const endTime = Date.now();
                const totalTime = ((endTime - startTime) / 1000).toFixed(2);

                addStep(container, `‚ö° Total time: ${totalTime}s (Much faster!)`, 'info');
            } catch (error) {
                resultDiv.innerHTML = `<div class="text-red-500">Error: ${error.message}</div>`;
            }
        });

        // FinTech Demo
        document.getElementById('processPayment').addEventListener('click', async function() {
            const amount = parseFloat(document.getElementById('paymentAmount').value);
            const shouldError = document.getElementById('simulateError').value === 'true';

            const timelineDiv = document.getElementById('paymentTimeline');
            const resultDiv = document.getElementById('paymentResult');

            timelineDiv.innerHTML = '';
            resultDiv.innerHTML = '';

            try {
                // Step 1: Validate account
                addTimelineStep(timelineDiv, 'Validating account...', 'pending');
                const account = await mockPaymentAPI('validate', 500, shouldError);
                updateTimelineStep(timelineDiv, 0, 'Account validated ‚úì', 'success');

                // Step 2: Check balance
                addTimelineStep(timelineDiv, 'Checking balance...', 'pending');
                const balance = await mockPaymentAPI('balance', 600, shouldError);
                if (balance < amount && shouldError) {
                    throw new Error('Insufficient funds');
                }
                updateTimelineStep(timelineDiv, 1, `Balance: $${balance} ‚úì`, 'success');

                // Step 3: Process payment
                addTimelineStep(timelineDiv, 'Processing payment...', 'pending');
                const payment = await mockPaymentAPI('payment', 1000, false);
                updateTimelineStep(timelineDiv, 2, `Payment processed ‚úì`, 'success');

                // Step 4: Send receipt
                addTimelineStep(timelineDiv, 'Sending receipt...', 'pending');
                const receipt = await mockPaymentAPI('receipt', 400, false);
                updateTimelineStep(timelineDiv, 3, 'Receipt sent ‚úì', 'success');

                resultDiv.innerHTML = `
                    <div class="bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-lg p-4">
                        <div class="text-2xl mb-2">‚úÖ Payment Successful!</div>
                        <div class="text-sm space-y-1">
                            <div>Amount: <strong>$${amount}</strong></div>
                            <div>Transaction ID: <strong>${receipt.transactionId}</strong></div>
                            <div>New Balance: <strong>$${balance - amount}</strong></div>
                        </div>
                    </div>
                `;
            } catch (error) {
                updateTimelineStep(timelineDiv, timelineDiv.children.length - 1, `Error: ${error.message} ‚úó`, 'error');
                resultDiv.innerHTML = `
                    <div class="bg-red-50 dark:bg-red-900/20 border-2 border-red-500 rounded-lg p-4">
                        <div class="text-2xl mb-2">‚ùå Payment Failed</div>
                        <div class="text-sm">Error: ${error.message}</div>
                    </div>
                `;
            }
        });

        // Playground
        document.getElementById('runPlayground').addEventListener('click', async function() {
            const code = document.getElementById('playgroundCode').value;
            const outputDiv = document.getElementById('playgroundOutput');
            outputDiv.innerHTML = '';

            // Capture console.log
            const originalLog = console.log;
            const originalError = console.error;

            console.log = (...args) => {
                outputDiv.innerHTML += `<div class="text-green-400">&gt; ${args.join(' ')}</div>`;
                originalLog.apply(console, args);
            };

            console.error = (...args) => {
                outputDiv.innerHTML += `<div class="text-red-400">‚úó ${args.join(' ')}</div>`;
                originalError.apply(console, args);
            };

            try {
                // Create async function wrapper
                const asyncFunction = new Function(`
                    return (async () => {
                        ${code}
                    })();
                `);

                await asyncFunction();
            } catch (error) {
                console.error(error.message);
            } finally {
                console.log = originalLog;
                console.error = originalError;
            }
        });

        // Helper functions
        function mockAPI(type, delay) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const data = {
                        student: { name: 'Alice Johnson', id: 'ST12345', email: 'alice@edu.com' },
                        courses: [
                            { id: 1, name: 'JavaScript Fundamentals', progress: 85 },
                            { id: 2, name: 'React Masterclass', progress: 60 },
                            { id: 3, name: 'Node.js Backend', progress: 45 }
                        ],
                        grades: { average: 87, total: 3, passed: 3 }
                    };
                    resolve(data[type]);
                }, delay);
            });
        }

        function mockPaymentAPI(type, delay, shouldError) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (shouldError && type === 'balance') {
                        resolve(50); // Low balance
                    } else {
                        const data = {
                            validate: { valid: true, accountId: 'ACC789' },
                            balance: 500,
                            payment: { success: true, paymentId: 'PAY' + Date.now() },
                            receipt: { transactionId: 'TXN' + Date.now(), timestamp: new Date().toISOString() }
                        };
                        resolve(data[type]);
                    }
                }, delay);
            });
        }

        function addStep(container, text, status) {
            const step = document.createElement('div');
            step.className = `p-2 rounded text-sm execution-step ${status === 'pending' ? 'bg-yellow-100 dark:bg-yellow-900/20' : status === 'success' ? 'bg-green-100 dark:bg-green-900/20' : 'bg-blue-100 dark:bg-blue-900/20'}`;
            step.textContent = text;
            container.appendChild(step);
        }

        function updateStep(container, index, text, status) {
            const step = container.children[index];
            step.textContent = text;
            step.className = `p-2 rounded text-sm execution-step ${status === 'success' ? 'bg-green-100 dark:bg-green-900/20' : status === 'error' ? 'bg-red-100 dark:bg-red-900/20' : 'bg-blue-100 dark:bg-blue-900/20'}`;
        }

        function addTimelineStep(container, text, status) {
            const step = document.createElement('div');
            step.className = `p-3 rounded-lg border-l-4 ${
                status === 'pending' ? 'bg-yellow-50 dark:bg-yellow-900/20 border-yellow-500' :
                status === 'success' ? 'bg-green-50 dark:bg-green-900/20 border-green-500' :
                'bg-red-50 dark:bg-red-900/20 border-red-500'
            } animate-slide-in`;
            step.textContent = text;
            container.appendChild(step);
        }

        function updateTimelineStep(container, index, text, status) {
            const step = container.children[index];
            step.textContent = text;
            step.className = `p-3 rounded-lg border-l-4 ${
                status === 'success' ? 'bg-green-50 dark:bg-green-900/20 border-green-500' :
                status === 'error' ? 'bg-red-50 dark:bg-red-900/20 border-red-500' :
                'bg-yellow-50 dark:bg-yellow-900/20 border-yellow-500'
            }`;
        }
    </script>
</body>
</html>