<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Performance Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE'
                    }
                }
            }
        }
    </script>
    <style>
        .chart-bar {
            transition: all 0.3s ease;
        }
        .chart-bar:hover {
            opacity: 0.8;
        }
        .dot {
            transition: all 0.3s ease;
        }
        .dot:hover {
            transform: scale(1.2);
        }
        .line-point {
            transition: all 0.2s ease;
        }
        .line-point:hover {
            transform: scale(1.3);
        }
    </style>
</head>
<body class="bg-white dark:bg-[#181818] text-gray-900 dark:text-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold mb-2 text-primary">Student Performance Tracker</h1>
            <p class="text-gray-600 dark:text-gray-400">Track student performance across topics, subjects, and time with interactive visualizations</p>
        </header>

        <!-- Input Section -->
        <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-6 mb-8 shadow-lg">
            <h2 class="text-2xl font-semibold mb-4">Add Performance Data</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Student Name</label>
                    <input type="text" id="studentName" placeholder="e.g., John Doe"
                           class="w-full px-4 py-2 text-base rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Subject/Topic</label>
                    <input type="text" id="subjectTopic" placeholder="e.g., Algebra"
                           class="w-full px-4 py-2 text-base rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Score (0-100)</label>
                    <input type="number" id="score" placeholder="e.g., 85" min="0" max="100"
                           class="w-full px-4 py-2 text-base rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Date</label>
                    <input type="date" id="entryDate"
                           class="w-full px-4 py-2 text-base rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Benchmark</label>
                    <input type="number" id="benchmark" placeholder="e.g., 70" min="0" max="100" value="70"
                           class="w-full px-4 py-2 text-base rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary focus:border-transparent">
                </div>
            </div>
            <button onclick="addEntry()"
                    class="w-full md:w-auto px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-all font-medium">
                Add Entry
            </button>
        </div>

        <!-- View Mode Toggle -->
        <div class="mb-6 flex flex-wrap gap-4 items-center">
            <div class="flex gap-2">
                <button onclick="setViewMode('categorical')" id="btn-mode-categorical"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white">
                    Categorical View
                </button>
                <button onclick="setViewMode('timeline')" id="btn-mode-timeline"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Timeline View
                </button>
            </div>
        </div>

        <!-- Categorical View Controls -->
        <div id="categoricalControls" class="mb-6 flex flex-wrap gap-4 items-center justify-between">
            <div class="flex flex-wrap gap-2">
                <button onclick="setView('bar')" id="btn-bar"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white">
                    Bar Chart
                </button>
                <button onclick="setView('dot')" id="btn-dot"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Dot Plot
                </button>
                <button onclick="setView('benchmark')" id="btn-benchmark"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Benchmark Bar
                </button>
            </div>
            <div class="flex gap-2">
                <button onclick="groupBy('student')" id="btn-group-student"
                        class="px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Group by Student
                </button>
                <button onclick="groupBy('subject')" id="btn-group-subject"
                        class="px-4 py-2 text-sm rounded-lg font-medium transition-all bg-primary text-white">
                    Group by Subject
                </button>
            </div>
        </div>

        <!-- Timeline View Controls -->
        <div id="timelineControls" class="mb-6 hidden flex-wrap gap-4 items-center justify-between">
            <div class="flex flex-wrap gap-2">
                <button onclick="setView('column')" id="btn-column"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white">
                    Column Chart
                </button>
                <button onclick="setView('line')" id="btn-line"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Line Chart
                </button>
                <button onclick="setView('area')" id="btn-area"
                        class="px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Area Chart
                </button>
            </div>
            <div class="flex gap-2">
                <button onclick="groupBy('student')" id="btn-timeline-group-student"
                        class="px-4 py-2 text-sm rounded-lg font-medium transition-all bg-primary text-white">
                    Group by Student
                </button>
                <button onclick="groupBy('subject')" id="btn-timeline-group-subject"
                        class="px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                    Group by Subject
                </button>
            </div>
        </div>

        <!-- Visualization Area -->
        <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-6 mb-8 shadow-lg min-h-96">
            <h2 class="text-2xl font-semibold mb-6" id="chartTitle">Performance by Subject/Topic</h2>
            <div id="chartContainer" class="space-y-4">
                <p class="text-gray-500 dark:text-gray-400 text-center py-12">No data yet. Add some entries to see visualizations!</p>
            </div>
        </div>

        <!-- Data Table -->
        <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-6 shadow-lg">
            <h2 class="text-2xl font-semibold mb-4">Current Data</h2>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-300 dark:border-gray-700">
                            <th class="text-left py-3 px-4">Student</th>
                            <th class="text-left py-3 px-4">Subject/Topic</th>
                            <th class="text-left py-3 px-4">Score</th>
                            <th class="text-left py-3 px-4">Date</th>
                            <th class="text-left py-3 px-4">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable">
                        <tr>
                            <td colspan="5" class="text-center py-8 text-gray-500 dark:text-gray-400">No entries yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Initialize dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Data storage
        let performanceData = [];
        let currentView = 'bar';
        let currentViewMode = 'categorical';
        let currentGrouping = 'subject';
        let globalBenchmark = 70;

        // Add entry
        function addEntry() {
            const studentName = document.getElementById('studentName').value.trim();
            const subjectTopic = document.getElementById('subjectTopic').value.trim();
            const score = parseFloat(document.getElementById('score').value);
            const entryDate = document.getElementById('entryDate').value;
            const benchmark = parseFloat(document.getElementById('benchmark').value);

            if (!studentName) {
                showCustomAlert('Please enter a student name');
                return;
            }
            if (!subjectTopic) {
                showCustomAlert('Please enter a subject/topic');
                return;
            }
            if (isNaN(score) || score < 0 || score > 100) {
                showCustomAlert('Please enter a valid score between 0 and 100');
                return;
            }
            if (!entryDate) {
                showCustomAlert('Please select a date');
                return;
            }

            performanceData.push({
                id: Date.now(),
                student: studentName,
                subject: subjectTopic,
                score: score,
                date: entryDate
            });

            if (!isNaN(benchmark)) {
                globalBenchmark = benchmark;
            }

            // Clear inputs
            document.getElementById('studentName').value = '';
            document.getElementById('subjectTopic').value = '';
            document.getElementById('score').value = '';

            updateDisplay();
        }

        // Custom alert function
        function showCustomAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white hover:bg-opacity-90 rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Delete entry
        function deleteEntry(id) {
            performanceData = performanceData.filter(entry => entry.id !== id);
            updateDisplay();
        }

        // Set view mode
        function setViewMode(mode) {
            currentViewMode = mode;

            // Update mode buttons
            document.getElementById('btn-mode-categorical').className = 'px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
            document.getElementById('btn-mode-timeline').className = 'px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
            document.getElementById(`btn-mode-${mode}`).className = 'px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white';

            // Toggle controls
            if (mode === 'categorical') {
                document.getElementById('categoricalControls').classList.remove('hidden');
                document.getElementById('categoricalControls').classList.add('flex');
                document.getElementById('timelineControls').classList.add('hidden');
                document.getElementById('timelineControls').classList.remove('flex');
                currentView = 'bar';
            } else {
                document.getElementById('categoricalControls').classList.add('hidden');
                document.getElementById('categoricalControls').classList.remove('flex');
                document.getElementById('timelineControls').classList.remove('hidden');
                document.getElementById('timelineControls').classList.add('flex');
                currentView = 'column';
                currentGrouping = 'student'; // Timeline view defaults to grouping by student
            }

            updateDisplay();
        }

        // Set view
        function setView(view) {
            currentView = view;

            // Update button styles for categorical views
            if (currentViewMode === 'categorical') {
                document.querySelectorAll('[id^="btn-"]').forEach(btn => {
                    if (btn.id.startsWith('btn-group') || btn.id.startsWith('btn-mode') || btn.id.startsWith('btn-timeline')) return;
                    btn.className = 'px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                });
                document.getElementById(`btn-${view}`).className = 'px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white';
            } else {
                // Update button styles for timeline views
                ['column', 'line', 'area'].forEach(v => {
                    const btn = document.getElementById(`btn-${v}`);
                    if (btn) {
                        btn.className = 'px-6 py-2 rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                    }
                });
                document.getElementById(`btn-${view}`).className = 'px-6 py-2 rounded-lg font-medium transition-all bg-primary text-white';
            }

            updateDisplay();
        }

        // Group by
        function groupBy(type) {
            currentGrouping = type;

            // Update button styles based on current mode
            if (currentViewMode === 'categorical') {
                document.getElementById('btn-group-student').className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                document.getElementById('btn-group-subject').className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                document.getElementById(`btn-group-${type}`).className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-primary text-white';
            } else {
                document.getElementById('btn-timeline-group-student').className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                document.getElementById('btn-timeline-group-subject').className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600';
                document.getElementById(`btn-timeline-group-${type}`).className = 'px-4 py-2 text-sm rounded-lg font-medium transition-all bg-primary text-white';
            }

            updateDisplay();
        }

        // Update display
        function updateDisplay() {
            if (currentViewMode === 'categorical') {
                updateCategoricalChart();
            } else {
                updateTimelineChart();
            }
            updateTable();
        }

        // Update categorical chart
        function updateCategoricalChart() {
            const container = document.getElementById('chartContainer');
            const title = document.getElementById('chartTitle');

            if (performanceData.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center py-12">No data yet. Add some entries to see visualizations!</p>';
                return;
            }

            // Group data
            const grouped = {};
            performanceData.forEach(entry => {
                const key = currentGrouping === 'student' ? entry.student : entry.subject;
                const label = currentGrouping === 'student' ? entry.subject : entry.student;

                if (!grouped[key]) {
                    grouped[key] = [];
                }
                grouped[key].push({...entry, label});
            });

            // Update title
            title.textContent = `Performance by ${currentGrouping === 'student' ? 'Student' : 'Subject/Topic'}`;

            // Render chart
            let html = '';
            Object.keys(grouped).forEach(key => {
                html += `<div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-primary">${key}</h3>
                    <div class="space-y-3">`;

                grouped[key].forEach(entry => {
                    html += renderCategoricalRow(entry);
                });

                html += `</div></div>`;
            });

            container.innerHTML = html;
        }

        // Render categorical chart row
        function renderCategoricalRow(entry) {
            const maxScore = 100;
            const percentage = (entry.score / maxScore) * 100;
            const benchmarkPercentage = (globalBenchmark / maxScore) * 100;

            const color = entry.score >= globalBenchmark ? '#10B981' : '#EF4444';

            if (currentView === 'bar') {
                return `
                    <div class="flex items-center gap-4">
                        <div class="w-32 text-sm font-medium truncate" title="${entry.label}">${entry.label}</div>
                        <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-8 relative">
                            <div class="chart-bar h-full rounded-full flex items-center justify-end pr-3 text-white text-sm font-medium"
                                 style="width: ${percentage}%; background-color: ${color};">
                                ${entry.score}
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentView === 'dot') {
                return `
                    <div class="flex items-center gap-4">
                        <div class="w-32 text-sm font-medium truncate" title="${entry.label}">${entry.label}</div>
                        <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 relative">
                            <div class="dot absolute top-1/2 -translate-y-1/2 w-6 h-6 rounded-full border-4 border-white dark:border-gray-900 shadow-lg"
                                 style="left: ${percentage}%; transform: translate(-50%, -50%); background-color: ${color};"
                                 title="${entry.score}">
                            </div>
                        </div>
                        <div class="w-12 text-sm text-right">${entry.score}</div>
                    </div>
                `;
            } else if (currentView === 'benchmark') {
                return `
                    <div class="flex items-center gap-4">
                        <div class="w-32 text-sm font-medium truncate" title="${entry.label}">${entry.label}</div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-8 relative">
                                <div class="chart-bar h-full rounded-full flex items-center justify-end pr-3 text-white text-sm font-medium"
                                     style="width: ${percentage}%; background-color: ${color};">
                                    ${entry.score}
                                </div>
                            </div>
                            <div class="absolute top-0 bottom-0 border-l-4 border-dashed border-gray-800 dark:border-gray-300"
                                 style="left: ${benchmarkPercentage}%;"
                                 title="Benchmark: ${globalBenchmark}">
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // Update timeline chart
        function updateTimelineChart() {
            const container = document.getElementById('chartContainer');
            const title = document.getElementById('chartTitle');

            if (performanceData.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center py-12">No data yet. Add some entries to see visualizations!</p>';
                return;
            }

            // Sort data by date
            const sortedData = [...performanceData].sort((a, b) => new Date(a.date) - new Date(b.date));

            // Group data by student or subject
            const grouped = {};
            sortedData.forEach(entry => {
                const key = currentGrouping === 'student' ? entry.student : entry.subject;
                if (!grouped[key]) {
                    grouped[key] = [];
                }
                grouped[key].push(entry);
            });

            // Update title
            title.textContent = `Performance Over Time - ${currentGrouping === 'student' ? 'By Student' : 'By Subject'}`;

            // Render charts
            let html = '';
            Object.keys(grouped).forEach(key => {
                html += `<div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-primary">${key}</h3>`;

                if (currentView === 'column') {
                    html += renderColumnChart(grouped[key]);
                } else if (currentView === 'line') {
                    html += renderLineChart(grouped[key]);
                } else if (currentView === 'area') {
                    html += renderAreaChart(grouped[key]);
                }

                html += `</div>`;
            });

            container.innerHTML = html;
        }

        // Render column chart
        function renderColumnChart(data) {
            if (data.length === 0) return '';

            const chartHeight = 250;
            const maxScore = 100;
            const barWidth = Math.min(80, Math.floor(600 / data.length));

            let html = '<div class="flex items-end justify-start gap-2 h-64 px-4">';

            data.forEach(entry => {
                const height = (entry.score / maxScore) * chartHeight;
                const color = entry.score >= globalBenchmark ? '#10B981' : '#EF4444';
                const dateLabel = new Date(entry.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

                html += `
                    <div class="flex flex-col items-center gap-2" style="width: ${barWidth}px;">
                        <div class="relative flex items-end h-full">
                            <div class="chart-bar rounded-t-lg transition-all cursor-pointer relative group"
                                 style="width: ${barWidth}px; height: ${height}px; background-color: ${color};">
                                <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-2 py-1 rounded text-xs whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity">
                                    ${entry.score}
                                </div>
                            </div>
                        </div>
                        <div class="text-xs text-center text-gray-600 dark:text-gray-400 whitespace-nowrap" style="width: ${barWidth}px;">${dateLabel}</div>
                    </div>
                `;
            });

            html += '</div>';

            // Add benchmark line reference
            html += `<div class="mt-4 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400">
                <div class="w-4 h-4 bg-green-500 rounded"></div> Above benchmark (${globalBenchmark})
                <div class="w-4 h-4 bg-red-500 rounded ml-4"></div> Below benchmark
            </div>`;

            return html;
        }

        // Render line chart
        function renderLineChart(data) {
            if (data.length === 0) return '';

            const chartHeight = 250;
            const chartWidth = 600;
            const maxScore = 100;
            const padding = 40;

            const points = data.map((entry, index) => {
                const x = padding + (index / Math.max(data.length - 1, 1)) * (chartWidth - 2 * padding);
                const y = chartHeight - padding - ((entry.score / maxScore) * (chartHeight - 2 * padding));
                return { x, y, ...entry };
            });

            // Create SVG path
            let pathD = '';
            points.forEach((point, index) => {
                pathD += `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y} `;
            });

            // Benchmark line
            const benchmarkY = chartHeight - padding - ((globalBenchmark / maxScore) * (chartHeight - 2 * padding));

            let html = `
                <div class="relative bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
                    <svg width="${chartWidth}" height="${chartHeight}" class="overflow-visible">
                        <!-- Grid lines -->
                        <line x1="${padding}" y1="${padding}" x2="${padding}" y2="${chartHeight - padding}"
                              stroke="currentColor" stroke-width="2" class="text-gray-400 dark:text-gray-600"/>
                        <line x1="${padding}" y1="${chartHeight - padding}" x2="${chartWidth - padding}" y2="${chartHeight - padding}"
                              stroke="currentColor" stroke-width="2" class="text-gray-400 dark:text-gray-600"/>

                        <!-- Benchmark line -->
                        <line x1="${padding}" y1="${benchmarkY}" x2="${chartWidth - padding}" y2="${benchmarkY}"
                              stroke="#9CA3AF" stroke-width="2" stroke-dasharray="5,5" class="text-gray-400"/>
                        <text x="${chartWidth - padding + 5}" y="${benchmarkY + 5}" class="text-xs fill-gray-500 dark:fill-gray-400">${globalBenchmark}</text>

                        <!-- Line path -->
                        <path d="${pathD}" fill="none" stroke="#5D5CDE" stroke-width="3" stroke-linejoin="round"/>

                        <!-- Data points -->
                        ${points.map(point => `
                            <circle cx="${point.x}" cy="${point.y}" r="6" fill="#5D5CDE" class="line-point cursor-pointer" stroke="white" stroke-width="2">
                                <title>${point.score} - ${new Date(point.date).toLocaleDateString()}</title>
                            </circle>
                        `).join('')}

                        <!-- X-axis labels -->
                        ${points.map(point => `
                            <text x="${point.x}" y="${chartHeight - padding + 20}" text-anchor="middle" class="text-xs fill-gray-600 dark:fill-gray-400">
                                ${new Date(point.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                            </text>
                        `).join('')}

                        <!-- Y-axis labels -->
                        ${[0, 25, 50, 75, 100].map(val => {
                            const y = chartHeight - padding - ((val / maxScore) * (chartHeight - 2 * padding));
                            return `<text x="${padding - 10}" y="${y + 5}" text-anchor="end" class="text-xs fill-gray-600 dark:fill-gray-400">${val}</text>`;
                        }).join('')}
                    </svg>
                </div>
            `;

            return html;
        }

        // Render area chart
        function renderAreaChart(data) {
            if (data.length === 0) return '';

            const chartHeight = 250;
            const chartWidth = 600;
            const maxScore = 100;
            const padding = 40;

            const points = data.map((entry, index) => {
                const x = padding + (index / Math.max(data.length - 1, 1)) * (chartWidth - 2 * padding);
                const y = chartHeight - padding - ((entry.score / maxScore) * (chartHeight - 2 * padding));
                return { x, y, ...entry };
            });

            // Create SVG path for area
            let areaD = `M ${padding} ${chartHeight - padding} `;
            points.forEach((point, index) => {
                areaD += `L ${point.x} ${point.y} `;
            });
            areaD += `L ${points[points.length - 1].x} ${chartHeight - padding} Z`;

            // Create line path
            let lineD = '';
            points.forEach((point, index) => {
                lineD += `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y} `;
            });

            // Benchmark line
            const benchmarkY = chartHeight - padding - ((globalBenchmark / maxScore) * (chartHeight - 2 * padding));

            let html = `
                <div class="relative bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
                    <svg width="${chartWidth}" height="${chartHeight}" class="overflow-visible">
                        <!-- Grid lines -->
                        <line x1="${padding}" y1="${padding}" x2="${padding}" y2="${chartHeight - padding}"
                              stroke="currentColor" stroke-width="2" class="text-gray-400 dark:text-gray-600"/>
                        <line x1="${padding}" y1="${chartHeight - padding}" x2="${chartWidth - padding}" y2="${chartHeight - padding}"
                              stroke="currentColor" stroke-width="2" class="text-gray-400 dark:text-gray-600"/>

                        <!-- Benchmark line -->
                        <line x1="${padding}" y1="${benchmarkY}" x2="${chartWidth - padding}" y2="${benchmarkY}"
                              stroke="#9CA3AF" stroke-width="2" stroke-dasharray="5,5"/>
                        <text x="${chartWidth - padding + 5}" y="${benchmarkY + 5}" class="text-xs fill-gray-500 dark:fill-gray-400">${globalBenchmark}</text>

                        <!-- Area fill -->
                        <path d="${areaD}" fill="#5D5CDE" fill-opacity="0.3"/>

                        <!-- Line path -->
                        <path d="${lineD}" fill="none" stroke="#5D5CDE" stroke-width="3" stroke-linejoin="round"/>

                        <!-- Data points -->
                        ${points.map(point => `
                            <circle cx="${point.x}" cy="${point.y}" r="6" fill="#5D5CDE" class="line-point cursor-pointer" stroke="white" stroke-width="2">
                                <title>${point.score} - ${new Date(point.date).toLocaleDateString()}</title>
                            </circle>
                        `).join('')}

                        <!-- X-axis labels -->
                        ${points.map(point => `
                            <text x="${point.x}" y="${chartHeight - padding + 20}" text-anchor="middle" class="text-xs fill-gray-600 dark:fill-gray-400">
                                ${new Date(point.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                            </text>
                        `).join('')}

                        <!-- Y-axis labels -->
                        ${[0, 25, 50, 75, 100].map(val => {
                            const y = chartHeight - padding - ((val / maxScore) * (chartHeight - 2 * padding));
                            return `<text x="${padding - 10}" y="${y + 5}" text-anchor="end" class="text-xs fill-gray-600 dark:fill-gray-400">${val}</text>`;
                        }).join('')}
                    </svg>
                </div>
            `;

            return html;
        }

        // Update table
        function updateTable() {
            const tbody = document.getElementById('dataTable');

            if (performanceData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center py-8 text-gray-500 dark:text-gray-400">No entries yet</td></tr>';
                return;
            }

            // Sort by date descending
            const sortedData = [...performanceData].sort((a, b) => new Date(b.date) - new Date(a.date));

            let html = '';
            sortedData.forEach(entry => {
                const color = entry.score >= globalBenchmark ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400';
                const dateFormatted = new Date(entry.date).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                html += `
                    <tr class="border-b border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-gray-800">
                        <td class="py-3 px-4">${entry.student}</td>
                        <td class="py-3 px-4">${entry.subject}</td>
                        <td class="py-3 px-4 ${color} font-semibold">${entry.score}</td>
                        <td class="py-3 px-4">${dateFormatted}</td>
                        <td class="py-3 px-4">
                            <button onclick="deleteEntry(${entry.id})"
                                    class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 font-medium">
                                Delete
                            </button>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // Sample data for demo
        function loadSampleData() {
            const today = new Date();
            const getDateOffset = (days) => {
                const date = new Date(today);
                date.setDate(date.getDate() - days);
                return date.toISOString().split('T')[0];
            };

            performanceData = [
                // Alice's progress over time
                { id: 1, student: 'Alice Johnson', subject: 'Algebra', score: 65, date: getDateOffset(60) },
                { id: 2, student: 'Alice Johnson', subject: 'Algebra', score: 72, date: getDateOffset(45) },
                { id: 3, student: 'Alice Johnson', subject: 'Algebra', score: 78, date: getDateOffset(30) },
                { id: 4, student: 'Alice Johnson', subject: 'Algebra', score: 85, date: getDateOffset(15) },
                { id: 5, student: 'Alice Johnson', subject: 'Algebra', score: 92, date: getDateOffset(0) },

                // Bob's progress
                { id: 6, student: 'Bob Smith', subject: 'Algebra', score: 58, date: getDateOffset(60) },
                { id: 7, student: 'Bob Smith', subject: 'Algebra', score: 62, date: getDateOffset(45) },
                { id: 8, student: 'Bob Smith', subject: 'Algebra', score: 65, date: getDateOffset(30) },
                { id: 9, student: 'Bob Smith', subject: 'Algebra', score: 68, date: getDateOffset(15) },
                { id: 10, student: 'Bob Smith', subject: 'Algebra', score: 72, date: getDateOffset(0) },

                // Carol's progress
                { id: 11, student: 'Carol Williams', subject: 'Algebra', score: 88, date: getDateOffset(60) },
                { id: 12, student: 'Carol Williams', subject: 'Algebra', score: 90, date: getDateOffset(45) },
                { id: 13, student: 'Carol Williams', subject: 'Algebra', score: 92, date: getDateOffset(30) },
                { id: 14, student: 'Carol Williams', subject: 'Algebra', score: 94, date: getDateOffset(15) },
                { id: 15, student: 'Carol Williams', subject: 'Algebra', score: 95, date: getDateOffset(0) },

                // Cross-subject data
                { id: 16, student: 'Alice Johnson', subject: 'Geometry', score: 78, date: getDateOffset(0) },
                { id: 17, student: 'Alice Johnson', subject: 'Calculus', score: 85, date: getDateOffset(0) },
                { id: 18, student: 'Bob Smith', subject: 'Geometry', score: 88, date: getDateOffset(0) },
                { id: 19, student: 'Bob Smith', subject: 'Calculus', score: 72, date: getDateOffset(0) },
                { id: 20, student: 'Carol Williams', subject: 'Geometry', score: 90, date: getDateOffset(0) },
                { id: 21, student: 'Carol Williams', subject: 'Calculus', score: 88, date: getDateOffset(0) }
            ];

            // Set today's date as default
            document.getElementById('entryDate').valueAsDate = today;

            updateDisplay();
        }

        // Load sample data on page load
        window.addEventListener('load', () => {
            loadSampleData();
        });
    </script>
</body>
</html>