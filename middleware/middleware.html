<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raven - JAMB UTME Prep</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-card: #1a1a24;
      --bg-elevated: #222230;
      --accent-primary: #6c5ce7;
      --accent-secondary: #a29bfe;
      --accent-gold: #f1c40f;
      --accent-success: #00b894;
      --accent-danger: #e74c3c;
      --accent-warning: #fdcb6e;
      --text-primary: #ffffff;
      --text-secondary: #a0a0b0;
      --text-muted: #606070;
      --border-color: #2a2a3a;
      --gradient-primary: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
      --gradient-gold: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
      --gradient-locked: linear-gradient(135deg, #2d2d3d 0%, #1a1a24 100%);
      --shadow-glow: 0 0 40px rgba(108, 92, 231, 0.3);
    }

    .light {
      --bg-primary: #f5f6fa;
      --bg-secondary: #ffffff;
      --bg-card: #ffffff;
      --bg-elevated: #f0f0f5;
      --text-primary: #1a1a2e;
      --text-secondary: #4a4a5a;
      --text-muted: #8a8a9a;
      --border-color: #e0e0e8;
      --gradient-locked: linear-gradient(135deg, #e8e8f0 0%, #d8d8e0 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Space Grotesk', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Background Pattern */
    .bg-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      opacity: 0.4;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(108, 92, 231, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(162, 155, 254, 0.1) 0%, transparent 50%);
    }

    .app-container {
      position: relative;
      z-index: 1;
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    .header {
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-secondary);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 44px;
      height: 44px;
      background: var(--gradient-primary);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      box-shadow: var(--shadow-glow);
    }

    .logo-text {
      font-size: 24px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-actions {
      display: flex;
      gap: 12px;
    }

    .icon-btn {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      background: var(--bg-card);
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .icon-btn:hover {
      background: var(--accent-primary);
      color: white;
      border-color: var(--accent-primary);
    }

    .icon-btn.premium {
      background: var(--gradient-gold);
      border: none;
      color: #1a1a2e;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    /* Screen Views */
    .screen {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Welcome Section */
    .welcome-section {
      text-align: center;
      padding: 30px 0;
    }

    .welcome-emoji {
      font-size: 48px;
      margin-bottom: 16px;
    }

    .welcome-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .welcome-subtitle {
      color: var(--text-secondary);
      font-size: 15px;
      line-height: 1.5;
    }

    /* Stats Row */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 24px 0;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent-primary);
    }

    .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }

    /* Subject Grid */
    .section-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .subject-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .subject-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .subject-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--gradient-primary);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .subject-card:hover {
      transform: translateY(-4px);
      border-color: var(--accent-primary);
      box-shadow: var(--shadow-glow);
    }

    .subject-card:hover::before {
      opacity: 1;
    }

    .subject-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin-bottom: 12px;
    }

    .subject-name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .subject-topics {
      font-size: 12px;
      color: var(--text-muted);
    }

    .subject-progress {
      margin-top: 12px;
      height: 4px;
      background: var(--bg-elevated);
      border-radius: 2px;
      overflow: hidden;
    }

    .subject-progress-bar {
      height: 100%;
      background: var(--gradient-primary);
      border-radius: 2px;
      transition: width 0.5s ease;
    }

    /* Topic List */
    .back-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-secondary);
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 20px;
      padding: 8px 0;
      transition: color 0.3s ease;
    }

    .back-btn:hover {
      color: var(--accent-primary);
    }

    .subject-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    .subject-header-icon {
      width: 56px;
      height: 56px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
    }

    .subject-header-info h2 {
      font-size: 22px;
      font-weight: 700;
    }

    .subject-header-info p {
      color: var(--text-secondary);
      font-size: 13px;
    }

    .free-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: var(--accent-success);
      color: white;
      font-size: 10px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 20px;
      margin-top: 8px;
    }

    .topic-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .topic-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .topic-card:hover:not(.locked) {
      border-color: var(--accent-primary);
      transform: translateX(4px);
    }

    .topic-card.locked {
      background: var(--gradient-locked);
      cursor: not-allowed;
    }

    .topic-card.locked:hover {
      border-color: var(--accent-gold);
    }

    .topic-number {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: var(--bg-elevated);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      flex-shrink: 0;
    }

    .topic-card:not(.locked) .topic-number {
      background: var(--gradient-primary);
      color: white;
    }

    .topic-card.locked .topic-number {
      background: var(--gradient-gold);
      color: #1a1a2e;
    }

    .topic-info {
      flex: 1;
      min-width: 0;
    }

    .topic-name {
      font-weight: 500;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .topic-card.locked .topic-name {
      color: var(--text-muted);
    }

    .topic-meta {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .topic-status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 20px;
      flex-shrink: 0;
    }

    .topic-status.free {
      background: rgba(0, 184, 148, 0.15);
      color: var(--accent-success);
    }

    .topic-status.locked {
      background: rgba(241, 196, 15, 0.15);
      color: var(--accent-gold);
    }

    .topic-status.completed {
      background: rgba(108, 92, 231, 0.15);
      color: var(--accent-secondary);
    }

    /* Quiz Screen */
    .quiz-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
    }

    .quiz-info {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .quiz-topic-name {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .quiz-progress-text {
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      background: var(--bg-card);
      padding: 6px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .quiz-timer {
      display: flex;
      align-items: center;
      gap: 6px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--accent-primary);
    }

    .progress-bar-container {
      height: 6px;
      background: var(--bg-elevated);
      border-radius: 3px;
      margin-bottom: 24px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: var(--gradient-primary);
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .question-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .question-number {
      font-size: 12px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    .question-text {
      font-size: 17px;
      font-weight: 500;
      line-height: 1.6;
    }

    .options-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .option-btn {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      padding: 16px;
      background: var(--bg-card);
      border: 2px solid var(--border-color);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      width: 100%;
      font-family: inherit;
      font-size: 15px;
      color: var(--text-primary);
    }

    .option-btn:hover:not(:disabled) {
      border-color: var(--accent-primary);
      background: rgba(108, 92, 231, 0.1);
    }

    .option-btn.selected {
      border-color: var(--accent-primary);
      background: rgba(108, 92, 231, 0.15);
    }

    .option-btn.correct {
      border-color: var(--accent-success);
      background: rgba(0, 184, 148, 0.15);
    }

    .option-btn.incorrect {
      border-color: var(--accent-danger);
      background: rgba(231, 76, 60, 0.15);
    }

    .option-btn:disabled {
      cursor: not-allowed;
    }

    .option-letter {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--bg-elevated);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      flex-shrink: 0;
    }

    .option-btn.selected .option-letter {
      background: var(--accent-primary);
      color: white;
    }

    .option-btn.correct .option-letter {
      background: var(--accent-success);
      color: white;
    }

    .option-btn.incorrect .option-letter {
      background: var(--accent-danger);
      color: white;
    }

    .option-text {
      flex: 1;
      padding-top: 4px;
      line-height: 1.5;
    }

    .explanation-box {
      margin-top: 20px;
      padding: 16px;
      background: rgba(108, 92, 231, 0.1);
      border: 1px solid var(--accent-primary);
      border-radius: 12px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .explanation-title {
      font-weight: 600;
      font-size: 13px;
      color: var(--accent-primary);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .explanation-text {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .quiz-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
    }

    .btn {
      flex: 1;
      padding: 16px 24px;
      border-radius: 12px;
      font-family: inherit;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      border: none;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-glow);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      border-color: var(--accent-primary);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Results Screen */
    .results-container {
      text-align: center;
      padding: 40px 20px;
    }

    .results-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .results-score {
      font-size: 48px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .results-label {
      font-size: 18px;
      color: var(--text-secondary);
      margin-bottom: 24px;
    }

    .results-stats {
      display: flex;
      justify-content: center;
      gap: 32px;
      margin-bottom: 32px;
    }

    .result-stat {
      text-align: center;
    }

    .result-stat-value {
      font-size: 24px;
      font-weight: 600;
    }

    .result-stat-value.correct {
      color: var(--accent-success);
    }

    .result-stat-value.incorrect {
      color: var(--accent-danger);
    }

    .result-stat-label {
      font-size: 12px;
      color: var(--text-muted);
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
      backdrop-filter: blur(4px);
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--bg-card);
      border-radius: 24px;
      padding: 32px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      animation: modalIn 0.3s ease;
      border: 1px solid var(--border-color);
    }

    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .modal-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--gradient-gold);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      margin: 0 auto 20px;
    }

    .modal-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .modal-text {
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 24px;
    }

    .modal-price {
      font-size: 32px;
      font-weight: 700;
      color: var(--accent-gold);
      margin-bottom: 8px;
    }

    .modal-price-note {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 24px;
    }

    .modal-features {
      text-align: left;
      margin-bottom: 24px;
    }

    .modal-feature {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-color);
      font-size: 14px;
    }

    .modal-feature:last-child {
      border-bottom: none;
    }

    .modal-feature i {
      color: var(--accent-success);
    }

    .modal-actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .btn-gold {
      background: var(--gradient-gold);
      color: #1a1a2e;
    }

    .btn-gold:hover {
      box-shadow: 0 0 30px rgba(241, 196, 15, 0.4);
    }

    .modal-close {
      color: var(--text-muted);
      font-size: 14px;
      cursor: pointer;
      transition: color 0.3s ease;
      background: none;
      border: none;
      padding: 8px;
    }

    .modal-close:hover {
      color: var(--text-primary);
    }

    /* Unlocked state */
    .premium-badge {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--gradient-gold);
      color: #1a1a2e;
      padding: 10px 16px;
      border-radius: 25px;
      font-size: 13px;
      font-weight: 600;
      display: none;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 20px rgba(241, 196, 15, 0.3);
      z-index: 50;
    }

    .premium-badge.active {
      display: flex;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--bg-card);
      border: 1px solid var(--accent-success);
      padding: 14px 24px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 200;
    }

    .toast.active {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .toast i {
      color: var(--accent-success);
    }

    /* Confirm Modal */
    .confirm-modal {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 24px;
      max-width: 340px;
      width: 100%;
      text-align: center;
      animation: modalIn 0.3s ease;
      border: 1px solid var(--border-color);
    }

    .confirm-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .confirm-text {
      color: var(--text-secondary);
      font-size: 14px;
      margin-bottom: 20px;
    }

    .confirm-actions {
      display: flex;
      gap: 12px;
    }

    /* Responsive */
    @media (max-width: 400px) {
      .subject-grid {
        grid-template-columns: 1fr;
      }

      .stats-row {
        grid-template-columns: 1fr;
        gap: 8px;
      }

      .stat-card {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px;
      }

      .stat-value {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="bg-pattern"></div>

  <div class="app-container">
    <header class="header">
      <div class="logo">
        <div class="logo-icon">ü¶Ö</div>
        <span class="logo-text">Raven</span>
      </div>
      <div class="header-actions">
        <button class="icon-btn premium" id="premiumBtn" title="Unlock Premium">
          <i class="fas fa-crown"></i>
        </button>
      </div>
    </header>

    <main class="main-content">
      <!-- Home Screen -->
      <div class="screen active" id="homeScreen">
        <div class="welcome-section">
          <div class="welcome-emoji">üìö</div>
          <h1 class="welcome-title">JAMB UTME Prep</h1>
          <p class="welcome-subtitle">Master your subjects with practice questions and detailed explanations</p>
        </div>

        <div class="stats-row">
          <div class="stat-card">
            <div class="stat-value" id="totalQuestions">0</div>
            <div class="stat-label">Questions</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="completedTopics">0</div>
            <div class="stat-label">Completed</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="avgScore">0%</div>
            <div class="stat-label">Avg Score</div>
          </div>
        </div>

        <h3 class="section-title"><i class="fas fa-book-open"></i> Choose a Subject</h3>
        <div class="subject-grid" id="subjectGrid"></div>
      </div>

      <!-- Topics Screen -->
      <div class="screen" id="topicsScreen">
        <div class="back-btn" id="backToHome">
          <i class="fas fa-arrow-left"></i>
          <span>Back to Subjects</span>
        </div>
        <div class="subject-header" id="subjectHeader"></div>
        <div class="free-badge"><i class="fas fa-gift"></i> First 3 topics are FREE!</div>
        <div class="topic-list" id="topicList"></div>
      </div>

      <!-- Quiz Screen -->
      <div class="screen" id="quizScreen">
        <div class="quiz-header">
          <div class="quiz-info">
            <div class="back-btn" id="backToTopics" style="margin: 0;">
              <i class="fas fa-arrow-left"></i>
            </div>
            <span class="quiz-topic-name" id="quizTopicName"></span>
          </div>
          <div class="quiz-progress-text" id="quizProgress">1/10</div>
        </div>

        <div class="progress-bar-container">
          <div class="progress-bar" id="quizProgressBar"></div>
        </div>

        <div class="question-card">
          <div class="question-number" id="questionNumber">Question 1</div>
          <p class="question-text" id="questionText"></p>
        </div>

        <div class="options-list" id="optionsList"></div>

        <div id="explanationBox" class="explanation-box" style="display: none;">
          <div class="explanation-title"><i class="fas fa-lightbulb"></i> Explanation</div>
          <p class="explanation-text" id="explanationText"></p>
        </div>

        <div class="quiz-actions">
          <button class="btn btn-secondary" id="skipBtn">Skip</button>
          <button class="btn btn-primary" id="nextBtn" disabled>Next <i class="fas fa-arrow-right"></i></button>
        </div>
      </div>

      <!-- Results Screen -->
      <div class="screen" id="resultsScreen">
        <div class="results-container">
          <div class="results-icon" id="resultsIcon">üéâ</div>
          <div class="results-score" id="resultsScore">80%</div>
          <div class="results-label">Your Score</div>

          <div class="results-stats">
            <div class="result-stat">
              <div class="result-stat-value correct" id="correctCount">8</div>
              <div class="result-stat-label">Correct</div>
            </div>
            <div class="result-stat">
              <div class="result-stat-value incorrect" id="incorrectCount">2</div>
              <div class="result-stat-label">Incorrect</div>
            </div>
          </div>

          <div class="quiz-actions">
            <button class="btn btn-secondary" id="retryBtn"><i class="fas fa-redo"></i> Retry</button>
            <button class="btn btn-primary" id="continueBtn">Continue <i class="fas fa-arrow-right"></i></button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Premium Modal -->
  <div class="modal-overlay" id="premiumModal">
    <div class="modal">
      <div class="modal-icon">üëë</div>
      <h2 class="modal-title">Unlock All Topics</h2>
      <p class="modal-text">Get unlimited access to all practice questions across every subject</p>

      <div class="modal-price">‚Ç¶2,000</div>
      <div class="modal-price-note">One-time payment ‚Ä¢ Lifetime access</div>

      <div class="modal-features">
        <div class="modal-feature">
          <i class="fas fa-check-circle"></i>
          <span>Access all topics in all 7 subjects</span>
        </div>
        <div class="modal-feature">
          <i class="fas fa-check-circle"></i>
          <span>1000+ practice questions</span>
        </div>
        <div class="modal-feature">
          <i class="fas fa-check-circle"></i>
          <span>Detailed explanations for every question</span>
        </div>
        <div class="modal-feature">
          <i class="fas fa-check-circle"></i>
          <span>Track your progress across subjects</span>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn btn-gold" id="unlockBtn">
          <i class="fas fa-unlock"></i> Unlock Now
        </button>
        <button class="modal-close" id="closeModal">Maybe Later</button>
      </div>
    </div>
  </div>

  <!-- Confirm Modal Overlay -->
  <div class="modal-overlay" id="confirmModalOverlay">
    <div class="confirm-modal">
      <h3 class="confirm-title" id="confirmTitle">Confirm Action</h3>
      <p class="confirm-text" id="confirmText">Are you sure?</p>
      <div class="confirm-actions">
        <button class="btn btn-secondary" id="confirmCancel">Cancel</button>
        <button class="btn btn-primary" id="confirmOk">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Premium Badge -->
  <div class="premium-badge" id="premiumBadge">
    <i class="fas fa-crown"></i>
    <span>Premium Active</span>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastText">Success!</span>
  </div>

  <script>


    // ============================================
    // ACCESS CONTROL MIDDLEWARE
    // ============================================
    const AccessMiddleware = {
      FREE_TOPIC_COUNT: 3,
      isPremium: false,

      canAccessTopic(topicIndex) {
        return this.isPremium || topicIndex < this.FREE_TOPIC_COUNT;
      },

      unlockPremium() {
        this.isPremium = true;
        document.getElementById('premiumBadge').classList.add('active');
        document.getElementById('premiumBtn').style.display = 'none';
        this.refreshUI();
        showToast('All topics unlocked! üéâ');
      },

      refreshUI() {
        if (currentSubject) {
          renderTopics(currentSubject);
        }
        renderSubjects();
      }
    };




    // ============================================
    // DATA STORE
    // ============================================
    const subjects = {
      mathematics: {
        name: "Mathematics",
        icon: "üìê",
        color: "#e74c3c",
        topics: {
          "number-bases": { name: "Number Bases", questions: generateSampleQuestions("Number Bases", 15) },
          "logarithms": { name: "Logarithms", questions: generateSampleQuestions("Logarithms", 12) },
          "indices": { name: "Indices", questions: generateSampleQuestions("Indices", 10) },
          "quadratic-equations": { name: "Quadratic Equations", questions: generateSampleQuestions("Quadratic Equations", 14) },
          "sets": { name: "Sets", questions: generateSampleQuestions("Sets", 11) },
          "polynomials": { name: "Polynomials", questions: generateSampleQuestions("Polynomials", 13) },
          "matrices": { name: "Matrices", questions: generateSampleQuestions("Matrices", 10) },
          "statistics": { name: "Statistics", questions: generateSampleQuestions("Statistics", 15) }
        }
      },
      english: {
        name: "English",
        icon: "üìù",
        color: "#3498db",
        topics: {
          "comprehension": { name: "Comprehension", questions: generateSampleQuestions("Comprehension", 20) },
          "lexis-structure": { name: "Lexis and Structure", questions: generateSampleQuestions("Lexis and Structure", 18) },
          "oral-english": { name: "Oral English", questions: generateSampleQuestions("Oral English", 15) },
          "antonyms": { name: "Antonyms", questions: generateSampleQuestions("Antonyms", 12) },
          "synonyms": { name: "Synonyms", questions: generateSampleQuestions("Synonyms", 12) },
          "sentence-interpretation": { name: "Sentence Interpretation", questions: generateSampleQuestions("Sentence Interpretation", 14) }
        }
      },
      physics: {
        name: "Physics",
        icon: "‚öõÔ∏è",
        color: "#9b59b6",
        topics: {
          "measurements": { name: "Measurements", questions: generateSampleQuestions("Measurements", 15) },
          "motion": { name: "Motion", questions: generateSampleQuestions("Motion", 18) },
          "gravitational-field": { name: "Gravitational Field", questions: generateSampleQuestions("Gravitational Field", 12) },
          "optical-instruments": {
            name: "Optical Instruments",
            category: "Waves, Optics and Sound",
            questions: [
              { id: "ORG23_001", question: "For the correction of myopic defects in the human eye we require", options: ["a convex lens", "a concave lens", "a combination of concave and convex lenses", "a prism", "a concave mirror"], answer: "b", explanation: "Myopia (short-sightedness) occurs when the eye focuses images in front of the retina. A concave (diverging) lens is used to spread light rays before they enter the eye, allowing proper focus on the retina." },
              { id: "ORG23_002", question: "The diagram below shows the lens arrangement in", options: ["a compound microscope", "an astronomical telescope", "a binocular", "a periscope", "a projection lantern"], answer: "b", explanation: "The arrangement with two convex lenses separated by the sum of their focal lengths (fo + fe), with the objective having longer focal length than the eyepiece, is characteristic of an astronomical telescope in normal adjustment." },
              { id: "ORG23_003", question: "In a compound microscope", options: ["there is only one lens", "the objective lens has a shorter focal length than the eyepiece which is convex", "the objective lens has a longer focal length than the eyepiece which is convex", "the objective lens has a shorter focal length than the eyepiece which is concave", "the objective and the eyepiece are both convex and have the same focal lengths"], answer: "b", explanation: "A compound microscope uses two convex lenses: the objective (with very short focal length) produces a magnified real image, and the eyepiece (with longer focal length) further magnifies that image." },
              { id: "ORG23_004", question: "The lack of power of accommodation which is mainly due to the hardening of the eye lens and is usual with the onset of old age is called", options: ["myopia", "hypermetropia", "presbyopia", "astigmatism", "eye ring"], answer: "c", explanation: "Presbyopia is age-related loss of accommodation due to reduced elasticity of the lens. It makes focusing on near objects difficult and typically requires reading glasses." },
              { id: "ORG23_005", question: "Which of the following statements about defects of vision is/are CORRECT? I. For a long sighted person, close objects appear blurred. II. For a short sighted person, distant objects appear blurred. III. Short sight is corrected by using a pair of converging lenses.", options: ["I only", "II only", "I and II only", "II and III only", "I, II and III"], answer: "c", explanation: "Statements I and II are correct. Statement III is incorrect: short sight (myopia) is corrected with diverging (concave) lenses, not converging ones." },
              { id: "ORG23_010", question: "A far sighted person cannot see objects that are less than 100cm away. If this person wants to read a book at 25cm, what type and focal length of lens does he need?", options: ["Convex, 20cm", "Concave, 20cm", "Convex, 33cm", "Concave, 33cm"], answer: "c", explanation: "For hypermetropia: u = 25 cm (object distance), v = -100 cm (virtual image at near point). Using lens formula: 1/f = 1/25 - 1/100 = 3/100 ‚Üí f = 33.3 cm. Convex lens needed." },
              { id: "ORG23_013", question: "The property of the eye known as its power of accommodation is controlled by the", options: ["Pupil", "Vitreous humour", "Iris", "Ciliary muscles"], answer: "d", explanation: "The ciliary muscles change the shape (and thus focal length) of the eye lens to focus on objects at different distances." },
              { id: "ORG23_019", question: "What optical instrument can best be constructed with converging lenses of focal lengths 50cm and 5cm?", options: ["Compound microscope", "Terrestrial telescope", "Astronomical telescope", "Galileo's telescope"], answer: "c", explanation: "With fo = 50 cm and fe = 5 cm, magnification M = fo/fe = 10. This matches an astronomical telescope where fo > fe for good magnification." },
              { id: "ORG23_028", question: "An observer with normal eyes views an object with a magnifying glass of focal length 5cm. The angular magnification is [least distance of distinct vision D = 25cm]", options: ["-6", "-5", "5", "6"], answer: "c", explanation: "For a simple magnifier with image at infinity: angular magnification M = D/f = 25/5 = 5." },
              { id: "ORG23_036", question: "If the linear magnification of the objective and eyepiece convex lenses of a compound microscope are 4 and 7 respectively, calculate the angular magnification of the microscope.", options: ["2", "3", "11", "28"], answer: "d", explanation: "Total magnification M = Mo √ó Me = 4 √ó 7 = 28." }
            ]
          },
          "dispersion-of-light": {
            name: "Dispersion of Light and Colours",
            category: "Waves, Optics and Sound",
            questions: [
              { id: "ORG24_001", question: "The visible part of light consists of the following colours:", options: ["red, indigo, infra-red, violet, yellow, green and blue", "red, green, blue, violet, indigo, orange and yellow", "blue, ultra-violet, infra-red, red, yellow, indigo, violet, green and orange", "infra-red and ultra-violet", "red, orange, yellow, green, blue, indigo and infra-red"], answer: "b", explanation: "The visible spectrum in order of increasing wavelength (or decreasing frequency) is: violet, indigo, blue, green, yellow, orange, red (VIBGYOR/ROYGBIV). Infrared and ultraviolet are not visible." },
              { id: "ORG24_005", question: "In sunlight, a blue flower looks blue because we see the flower by the light it", options: ["receives from our eye", "disperses", "absorbs", "refracts", "reflects"], answer: "e", explanation: "A blue flower appears blue because it reflects blue light and absorbs other colors. Our eyes see the reflected blue light." },
              { id: "ORG24_008", question: "What is the apparent colour of a RED SHIRT when viewed in PURE green light?", options: ["Red", "Green", "Yellow", "Black", "Blue"], answer: "d", explanation: "A red shirt absorbs green light (and reflects red). Under pure green light, it absorbs all the green light, reflecting none, so it appears black." },
              { id: "ORG24_010", question: "A narrow beam of white light can be split up into different colours by a glass prism. The correct explanation is that", options: ["White light is an electromagnetic wave", "The prism has all the colours of the white light", "White light has undergone total internal reflection in the prism", "Different colours of white light travel with different speeds in glass", "White light consists of yellow, green and red colours"], answer: "d", explanation: "Dispersion occurs because different colors (wavelengths) travel at different speeds in glass (different refractive indices), causing different amounts of refraction." },
              { id: "ORG24_012", question: "When white light is dispersed by a spectrometer, the component having the shortest wavelength is", options: ["Orange", "Green", "Violet", "Red"], answer: "c", explanation: "Violet light has the shortest wavelength (~400 nm) in the visible spectrum, so it is deviated the most by a prism." },
              { id: "ORG24_19", question: "When light is incident on an object which is magenta in colour, which of the following colours will be absorbed?", options: ["Red and blue", "Green only", "Red and green", "Red only"], answer: "b", explanation: "Magenta = red + blue. It reflects red and blue, and absorbs green light." },
              { id: "ORG24_25", question: "The colours seen in thin films of oil on the road and in soap bubbles are due to", options: ["Reflection", "Interference", "Diffraction", "Polarization"], answer: "b", explanation: "Colors in thin films result from interference of light waves reflected from the top and bottom surfaces of the film, causing constructive and destructive interference for different wavelengths." },
              { id: "ORG24_30", question: "Which of the following pairs of light rays shows the widest separation in the spectrum of white light?", options: ["Green and yellow", "Red and blue", "Blue and indigo", "Red and violet"], answer: "d", explanation: "Red and violet are at extreme ends of visible spectrum, so maximum angular separation after dispersion." }
            ]
          },
          "waves": { name: "Waves", questions: generateSampleQuestions("Waves", 16) },
          "electricity": { name: "Current Electricity", questions: generateSampleQuestions("Current Electricity", 20) }
        }
      },
      chemistry: {
        name: "Chemistry",
        icon: "üß™",
        color: "#1abc9c",
        topics: {
          "atomic-structure": { name: "Atomic Structure", questions: generateSampleQuestions("Atomic Structure", 15) },
          "chemical-bonding": { name: "Chemical Bonding", questions: generateSampleQuestions("Chemical Bonding", 14) },
          "stoichiometry": { name: "Stoichiometry", questions: generateSampleQuestions("Stoichiometry", 12) },
          "acids-bases": { name: "Acids, Bases and Salts", questions: generateSampleQuestions("Acids, Bases and Salts", 16) },
          "redox-reactions": { name: "Redox Reactions", questions: generateSampleQuestions("Redox Reactions", 13) },
          "organic-chemistry": { name: "Organic Chemistry", questions: generateSampleQuestions("Organic Chemistry", 18) },
          "periodic-table": { name: "Periodic Table", questions: generateSampleQuestions("Periodic Table", 10) }
        }
      },
      biology: {
        name: "Biology",
        icon: "üß¨",
        color: "#27ae60",
        topics: {
          "cell-biology": { name: "Cell Biology", questions: generateSampleQuestions("Cell Biology", 18) },
          "genetics": { name: "Genetics", questions: generateSampleQuestions("Genetics", 15) },
          "ecology": { name: "Ecology", questions: generateSampleQuestions("Ecology", 14) },
          "evolution": { name: "Evolution", questions: generateSampleQuestions("Evolution", 12) },
          "nutrition": { name: "Nutrition", questions: generateSampleQuestions("Nutrition", 16) },
          "reproduction": { name: "Reproduction", questions: generateSampleQuestions("Reproduction", 13) },
          "excretion": { name: "Excretion", questions: generateSampleQuestions("Excretion", 11) }
        }
      },
      crs: {
        name: "CRS",
        icon: "‚úùÔ∏è",
        color: "#f39c12",
        topics: {
          "creation": { name: "Creation", questions: generateSampleQuestions("Creation", 10) },
          "covenant": { name: "Covenant", questions: generateSampleQuestions("Covenant", 12) },
          "moses": { name: "Moses and the Exodus", questions: generateSampleQuestions("Moses and the Exodus", 14) },
          "prophets": { name: "The Prophets", questions: generateSampleQuestions("The Prophets", 15) },
          "jesus-birth": { name: "Birth of Jesus", questions: generateSampleQuestions("Birth of Jesus", 11) },
          "parables": { name: "Parables of Jesus", questions: generateSampleQuestions("Parables of Jesus", 13) }
        }
      },
      government: {
        name: "Government",
        icon: "üèõÔ∏è",
        color: "#8e44ad",
        topics: {
          "constitution": { name: "Constitution", questions: generateSampleQuestions("Constitution", 15) },
          "democracy": { name: "Democracy", questions: generateSampleQuestions("Democracy", 14) },
          "federalism": { name: "Federalism", questions: generateSampleQuestions("Federalism", 12) },
          "political-parties": { name: "Political Parties", questions: generateSampleQuestions("Political Parties", 13) },
          "arms-of-government": { name: "Arms of Government", questions: generateSampleQuestions("Arms of Government", 16) },
          "local-government": { name: "Local Government", questions: generateSampleQuestions("Local Government", 11) }
        }
      }
    };

    // Sample question generator for topics without real data
    function generateSampleQuestions(topicName, count) {
      const questions = [];
      for (let i = 1; i <= count; i++) {
        questions.push({
          id: `SAMPLE_${i}`,
          question: `Sample question ${i} about ${topicName}. This is a placeholder question that would be replaced with real JAMB questions.`,
          options: ["Option A", "Option B", "Option C", "Option D"],
          answer: ["a", "b", "c", "d"][Math.floor(Math.random() * 4)],
          explanation: `This is the explanation for question ${i} about ${topicName}. In the real app, this would contain a detailed explanation of the correct answer.`
        });
      }
      return questions;
    }

    // Progress tracking
    const progress = {
      completed: {},
      scores: {}
    };

    // ============================================
    // APP STATE
    // ============================================
    let currentSubject = null;
    let currentTopic = null;
    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let confirmCallback = null;

    // ============================================
    // UI FUNCTIONS
    // ============================================
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toastText').textContent = message;
      toast.classList.add('active');
      setTimeout(() => toast.classList.remove('active'), 3000);
    }

    function showConfirm(title, text) {
      return new Promise((resolve) => {
        const overlay = document.getElementById('confirmModalOverlay');
        document.getElementById('confirmTitle').textContent = title;
        document.getElementById('confirmText').textContent = text;
        overlay.classList.add('active');

        confirmCallback = resolve;
      });
    }

    function hideConfirm() {
      document.getElementById('confirmModalOverlay').classList.remove('active');
    }

    function renderSubjects() {
      const grid = document.getElementById('subjectGrid');
      grid.innerHTML = '';

      Object.entries(subjects).forEach(([key, subject]) => {
        const topicKeys = Object.keys(subject.topics);
        const totalTopics = topicKeys.length;
        const completedTopics = topicKeys.filter(t => progress.completed[`${key}-${t}`]).length;
        const progressPercent = (completedTopics / totalTopics) * 100;

        const card = document.createElement('div');
        card.className = 'subject-card';
        card.innerHTML = `
          <div class="subject-icon" style="background: ${subject.color}20; color: ${subject.color}">
            ${subject.icon}
          </div>
          <div class="subject-name">${subject.name}</div>
          <div class="subject-topics">${totalTopics} topics</div>
          <div class="subject-progress">
            <div class="subject-progress-bar" style="width: ${progressPercent}%"></div>
          </div>
        `;
        card.onclick = () => openSubject(key);
        grid.appendChild(card);
      });

      updateStats();
    }

    function openSubject(subjectKey) {
      currentSubject = subjectKey;
      const subject = subjects[subjectKey];

      document.getElementById('subjectHeader').innerHTML = `
        <div class="subject-header-icon" style="background: ${subject.color}20; color: ${subject.color}">
          ${subject.icon}
        </div>
        <div class="subject-header-info">
          <h2>${subject.name}</h2>
          <p>${Object.keys(subject.topics).length} topics available</p>
        </div>
      `;

      renderTopics(subjectKey);
      showScreen('topicsScreen');
    }

    function renderTopics(subjectKey) {
      const subject = subjects[subjectKey];
      const list = document.getElementById('topicList');
      list.innerHTML = '';

      Object.entries(subject.topics).forEach(([key, topic], index) => {
        const isLocked = !AccessMiddleware.canAccessTopic(index);
        const isCompleted = progress.completed[`${subjectKey}-${key}`];
        const score = progress.scores[`${subjectKey}-${key}`];

        const card = document.createElement('div');
        card.className = `topic-card ${isLocked ? 'locked' : ''} ${isCompleted ? 'completed' : ''}`;

        let statusHtml = '';
        if (isLocked) {
          statusHtml = `<div class="topic-status locked"><i class="fas fa-lock"></i> Locked</div>`;
        } else if (isCompleted) {
          statusHtml = `<div class="topic-status completed"><i class="fas fa-check"></i> ${score}%</div>`;
        } else {
          statusHtml = `<div class="topic-status free"><i class="fas fa-play"></i> Start</div>`;
        }

        card.innerHTML = `
          <div class="topic-number">${index + 1}</div>
          <div class="topic-info">
            <div class="topic-name">${topic.name}</div>
            <div class="topic-meta">${topic.questions.length} questions${topic.category ? ` ‚Ä¢ ${topic.category}` : ''}</div>
          </div>
          ${statusHtml}
        `;

        card.onclick = () => {
          if (isLocked) {
            document.getElementById('premiumModal').classList.add('active');
          } else {
            startQuiz(subjectKey, key);
          }
        };

        list.appendChild(card);
      });
    }

    function startQuiz(subjectKey, topicKey) {
      currentSubject = subjectKey;
      currentTopic = topicKey;
      const topic = subjects[subjectKey].topics[topicKey];

      currentQuestions = [...topic.questions].sort(() => Math.random() - 0.5).slice(0, 10);
      currentQuestionIndex = 0;
      userAnswers = [];

      document.getElementById('quizTopicName').textContent = topic.name;

      showScreen('quizScreen');
      renderQuestion();
    }

    function renderQuestion() {
      const question = currentQuestions[currentQuestionIndex];
      const total = currentQuestions.length;

      document.getElementById('quizProgress').textContent = `${currentQuestionIndex + 1}/${total}`;
      document.getElementById('quizProgressBar').style.width = `${((currentQuestionIndex + 1) / total) * 100}%`;
      document.getElementById('questionNumber').textContent = `Question ${currentQuestionIndex + 1}`;
      document.getElementById('questionText').textContent = question.question;

      const optionsList = document.getElementById('optionsList');
      optionsList.innerHTML = '';

      const letters = ['a', 'b', 'c', 'd', 'e'];
      question.options.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerHTML = `
          <div class="option-letter">${letters[index].toUpperCase()}</div>
          <div class="option-text">${option}</div>
        `;
        btn.onclick = () => selectAnswer(letters[index]);
        optionsList.appendChild(btn);
      });

      document.getElementById('explanationBox').style.display = 'none';
      document.getElementById('nextBtn').disabled = true;
      document.getElementById('skipBtn').style.display = 'block';
    }

    function selectAnswer(answer) {
      const question = currentQuestions[currentQuestionIndex];
      const correct = question.answer;
      const isCorrect = answer === correct;

      userAnswers[currentQuestionIndex] = { answer, isCorrect };

      const options = document.querySelectorAll('.option-btn');
      const letters = ['a', 'b', 'c', 'd', 'e'];

      options.forEach((btn, index) => {
        btn.disabled = true;
        if (letters[index] === correct) {
          btn.classList.add('correct');
        } else if (letters[index] === answer && !isCorrect) {
          btn.classList.add('incorrect');
        }
      });

      document.getElementById('explanationText').textContent = question.explanation;
      document.getElementById('explanationBox').style.display = 'block';
      document.getElementById('nextBtn').disabled = false;
      document.getElementById('skipBtn').style.display = 'none';
    }

    function nextQuestion() {
      if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function skipQuestion() {
      userAnswers[currentQuestionIndex] = { answer: null, isCorrect: false };
      nextQuestion();
    }

    function showResults() {
      const correct = userAnswers.filter(a => a && a.isCorrect).length;
      const total = currentQuestions.length;
      const percentage = Math.round((correct / total) * 100);

      // Save progress
      const key = `${currentSubject}-${currentTopic}`;
      progress.completed[key] = true;
      progress.scores[key] = percentage;

      // Update UI
      document.getElementById('resultsScore').textContent = `${percentage}%`;
      document.getElementById('correctCount').textContent = correct;
      document.getElementById('incorrectCount').textContent = total - correct;

      let icon = 'üéâ';
      if (percentage < 50) icon = 'üìö';
      else if (percentage < 70) icon = 'üí™';
      else if (percentage < 90) icon = '‚≠ê';
      else icon = 'üèÜ';

      document.getElementById('resultsIcon').textContent = icon;

      showScreen('resultsScreen');
      updateStats();
    }

    function updateStats() {
      let totalQuestions = 0;
      let completedTopics = 0;
      let totalScore = 0;
      let scoredTopics = 0;

      Object.entries(subjects).forEach(([subjectKey, subject]) => {
        Object.entries(subject.topics).forEach(([topicKey, topic]) => {
          totalQuestions += topic.questions.length;
          const key = `${subjectKey}-${topicKey}`;
          if (progress.completed[key]) {
            completedTopics++;
            if (progress.scores[key]) {
              totalScore += progress.scores[key];
              scoredTopics++;
            }
          }
        });
      });

      document.getElementById('totalQuestions').textContent = totalQuestions;
      document.getElementById('completedTopics').textContent = completedTopics;
      document.getElementById('avgScore').textContent = scoredTopics > 0 ? `${Math.round(totalScore / scoredTopics)}%` : '0%';
    }

    // ============================================
    // EVENT LISTENERS
    // ============================================
    document.getElementById('backToHome').onclick = () => {
      currentSubject = null;
      showScreen('homeScreen');
    };

    document.getElementById('backToTopics').onclick = async () => {
      if (currentQuestionIndex > 0) {
        const confirmed = await showConfirm('Leave Quiz?', 'Your progress will be lost if you leave now.');
        if (!confirmed) return;
      }
      showScreen('topicsScreen');
    };

    document.getElementById('confirmCancel').onclick = () => {
      hideConfirm();
      if (confirmCallback) confirmCallback(false);
    };

    document.getElementById('confirmOk').onclick = () => {
      hideConfirm();
      if (confirmCallback) confirmCallback(true);
    };

    document.getElementById('nextBtn').onclick = nextQuestion;
    document.getElementById('skipBtn').onclick = skipQuestion;

    document.getElementById('retryBtn').onclick = () => {
      startQuiz(currentSubject, currentTopic);
    };

    document.getElementById('continueBtn').onclick = () => {
      showScreen('topicsScreen');
      renderTopics(currentSubject);
    };

    document.getElementById('premiumBtn').onclick = () => {
      document.getElementById('premiumModal').classList.add('active');
    };

    document.getElementById('closeModal').onclick = () => {
      document.getElementById('premiumModal').classList.remove('active');
    };

    document.getElementById('unlockBtn').onclick = () => {
      // In a real app, this would integrate with a payment gateway
      // For demo, we'll just unlock
      AccessMiddleware.unlockPremium();
      document.getElementById('premiumModal').classList.remove('active');
    };

    // Close modal on overlay click
    document.getElementById('premiumModal').onclick = (e) => {
      if (e.target.id === 'premiumModal') {
        document.getElementById('premiumModal').classList.remove('active');
      }
    };

    document.getElementById('confirmModalOverlay').onclick = (e) => {
      if (e.target.id === 'confirmModalOverlay') {
        hideConfirm();
        if (confirmCallback) confirmCallback(false);
      }
    };

    // ============================================
    // THEME DETECTION
    // ============================================
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
      document.documentElement.classList.add('light');
    }
    window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', event => {
      if (event.matches) {
        document.documentElement.classList.add('light');
      } else {
        document.documentElement.classList.remove('light');
      }
    });

    // ============================================
    // INITIALIZE
    // ============================================
    renderSubjects();
  </script>
</body>
</html>

